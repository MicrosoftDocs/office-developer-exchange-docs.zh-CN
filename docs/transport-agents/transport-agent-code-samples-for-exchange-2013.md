---
title: Exchange 2013 的传输代理代码示例
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: 626345ec-918f-4d91-932f-e6ce92553ccb
description: 查找有关可用于 Exchange 2013 的示例传输代理的信息。
ms.openlocfilehash: c14a4e34102b55014cc6507e375929c186f5f6e9
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/03/2020
ms.locfileid: "44461798"
---
# <a name="transport-agent-code-samples-for-exchange-2013"></a><span data-ttu-id="57635-103">Exchange 2013 的传输代理代码示例</span><span class="sxs-lookup"><span data-stu-id="57635-103">Transport agent code samples for Exchange 2013</span></span>

<span data-ttu-id="57635-104">查找有关可用于 Exchange 2013 的示例传输代理的信息。</span><span class="sxs-lookup"><span data-stu-id="57635-104">Find information about the sample transport agents that are available for Exchange 2013.</span></span>
  
<span data-ttu-id="57635-105">**适用于：** Exchange Server 2013</span><span class="sxs-lookup"><span data-stu-id="57635-105">**Applies to:** Exchange Server 2013</span></span>
  
<span data-ttu-id="57635-106">您可以使用 Exchange Server 2013 中包含的 Api 来开发扩展传输功能的代理。</span><span class="sxs-lookup"><span data-stu-id="57635-106">You can use the APIs that are included in Exchange Server 2013 to develop agents that extend transport functionality.</span></span> <span data-ttu-id="57635-107">本文提供了有关可用于帮助您了解如何以编程方式扩展传输行为的示例代理的信息。</span><span class="sxs-lookup"><span data-stu-id="57635-107">This article provides information about the sample agents that are available to help you to learn how to extend transport behavior programmatically.</span></span> <span data-ttu-id="57635-108">示例代理包括每个组件的源代码。</span><span class="sxs-lookup"><span data-stu-id="57635-108">The sample agents include the source code for each component.</span></span> 
  
<span data-ttu-id="57635-109">下表列出了 Exchange 2013 的示例代理。</span><span class="sxs-lookup"><span data-stu-id="57635-109">The following table lists the sample agents for Exchange 2013.</span></span>
  
<span data-ttu-id="57635-110">**表1。传输代理示例**</span><span class="sxs-lookup"><span data-stu-id="57635-110">**Table 1. Transport agent samples**</span></span>

|<span data-ttu-id="57635-111">**示例名称**</span><span class="sxs-lookup"><span data-stu-id="57635-111">**Sample name**</span></span>|<span data-ttu-id="57635-112">**说明**</span><span class="sxs-lookup"><span data-stu-id="57635-112">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="57635-113">Exchange 2013：生成防病毒传输代理</span><span class="sxs-lookup"><span data-stu-id="57635-113">Exchange 2013: Build an antivirus transport agent</span></span>](https://code.msdn.microsoft.com/Exchange/Exchange-2013-Build-an-6e544269) <br/> |<span data-ttu-id="57635-114">此代理响应[OnEndOfData](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.OnEndOfData.aspx)和[OnSubmittedMessage](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.OnSubmittedMessage.aspx)事件，并将传入的邮件发送到进程外服务器，以异步检查邮件并返回修改的版本。</span><span class="sxs-lookup"><span data-stu-id="57635-114">This agent responds to the [OnEndOfData](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.OnEndOfData.aspx) and [OnSubmittedMessage](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.OnSubmittedMessage.aspx) events and sends the incoming message to an out-of-process server that asynchronously examines the message and returns a modified version.</span></span>  <br/> |
|[<span data-ttu-id="57635-115">Exchange 2013：构建带宽日志记录传输代理</span><span class="sxs-lookup"><span data-stu-id="57635-115">Exchange 2013: Build a bandwidth logging transport agent</span></span>](https://code.msdn.microsoft.com/Exchange/Exchange-2013-Build-a-d61a4aaa) <br/> |<span data-ttu-id="57635-116">此代理响应[OnSubmittedMessage](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.OnSubmittedMessage.aspx)和[OnRoutedMessage](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.OnRoutedMessage.aspx)事件，捕获指定收件人的带宽使用情况，并将带宽使用信息记录到文本文件中。</span><span class="sxs-lookup"><span data-stu-id="57635-116">This agent responds to the [OnSubmittedMessage](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.OnSubmittedMessage.aspx) and [OnRoutedMessage](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.OnRoutedMessage.aspx) events, captures bandwidth usage for specified recipients, and logs the bandwidth usage information to a text file.</span></span>  <br/> |
|[<span data-ttu-id="57635-117">Exchange 2013：生成正文转换传输代理</span><span class="sxs-lookup"><span data-stu-id="57635-117">Exchange 2013: Build a body conversion transport agent</span></span>](https://code.msdn.microsoft.com/Exchange/Exchange-2013-Build-a-body-ed36ecb0) <br/> |<span data-ttu-id="57635-118">此代理通过确定传入邮件的格式并确定是否必须进行筛选来筛选出电子邮件的脚本。</span><span class="sxs-lookup"><span data-stu-id="57635-118">This agent filters scripts out of email messages by determining the format of the incoming message and deciding if filtering must occur.</span></span> <span data-ttu-id="57635-119">如果需要筛选，则会将内容转换为 HTML，进行筛选，然后将其转换回源格式。</span><span class="sxs-lookup"><span data-stu-id="57635-119">If filtering is needed, the content is converted to HTML, filtered, and then converted back to the source format.</span></span>  <br/> |
|[<span data-ttu-id="57635-120">Exchange 2013：生成 SMTP 日志记录传输代理</span><span class="sxs-lookup"><span data-stu-id="57635-120">Exchange 2013: Build an SMTP logging transport agent</span></span>](https://code.msdn.microsoft.com/Exchange/Exchange-2013-Build-an-fc23dc33) <br/> |<span data-ttu-id="57635-121">此代理响应[OnEndOfData](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.OnEndOfData.aspx)事件，并将邮件异步记录到本地硬盘上的文件中。</span><span class="sxs-lookup"><span data-stu-id="57635-121">This agent responds to the [OnEndOfData](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.OnEndOfData.aspx) event, and asynchronously logs the message to a file on the local hard disk.</span></span>  <br/> |
|[<span data-ttu-id="57635-122">Exchange 2013：生成一个传输代理，以临时阻止发件人</span><span class="sxs-lookup"><span data-stu-id="57635-122">Exchange 2013: Build a transport agent that blocks senders temporarily</span></span>](https://code.msdn.microsoft.com/Exchange/Exchange-2013-Build-a-52a767d8) <br/> |<span data-ttu-id="57635-123">此代理响应[OnEndOfHeaders](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.OnEndOfHeaders.aspx)和[OnRcptCommand](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.OnRcptCommand.aspx)事件，并确定邮件发件人以前是否向前端传输服务发送了邮件。</span><span class="sxs-lookup"><span data-stu-id="57635-123">This agent responds to the [OnEndOfHeaders](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.OnEndOfHeaders.aspx) and [OnRcptCommand](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.OnRcptCommand.aspx) events and determines whether the message sender has previously sent messages to the Front End Transport service.</span></span> <span data-ttu-id="57635-124">如果发件人之前未向前端传输服务发送邮件，则会将发件人添加到发件人列表中，并将邮件拒绝，告知客户端稍后重试的响应（也称为 graylisting）。</span><span class="sxs-lookup"><span data-stu-id="57635-124">If the sender has not previously sent a message to the Front End Transport service, the sender is added to a list of senders, and the message is rejected with a response that tells the client to try again later (also known as graylisting).</span></span> <span data-ttu-id="57635-125">如果发件人在以前的发件人列表中，则代理不会拒绝该邮件。</span><span class="sxs-lookup"><span data-stu-id="57635-125">If the sender is in the list of previous senders, the agent does not reject the message.</span></span>  <br/> |
|[<span data-ttu-id="57635-126">Exchange 2013：生成邮箱服务器日志记录传输代理</span><span class="sxs-lookup"><span data-stu-id="57635-126">Exchange 2013: Build a Mailbox server logging transport agent</span></span>](https://code.msdn.microsoft.com/Exchange/Exchange-2013-Build-a-fc8632e5) <br/> |<span data-ttu-id="57635-127">此代理响应[OnRoutedMessage](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.OnRoutedMessage.aspx)传输管道事件，并将邮件同步记录到本地硬盘上的文件中。</span><span class="sxs-lookup"><span data-stu-id="57635-127">This agent responds to the [OnRoutedMessage](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.OnRoutedMessage.aspx) transport pipeline event and synchronously logs the message to a file on the local hard disk.</span></span>  <br/> |
|[<span data-ttu-id="57635-128">Exchange 2013：生成 X 标头传输代理</span><span class="sxs-lookup"><span data-stu-id="57635-128">Exchange 2013: Build an X-header transport agent</span></span>](https://code.msdn.microsoft.com/Exchange/Exchange-2013-Build-an-32f62f5a) <br/> |<span data-ttu-id="57635-129">此代理响应[OnEndOfHeaders](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.OnEndOfHeaders.aspx)事件，并读取和修改邮件中的 X 标头。</span><span class="sxs-lookup"><span data-stu-id="57635-129">This agent responds to the [OnEndOfHeaders](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.OnEndOfHeaders.aspx) event and read and modify X-headers in messages.</span></span>  <br/> |
   
## <a name="see-also"></a><span data-ttu-id="57635-130">另请参阅</span><span class="sxs-lookup"><span data-stu-id="57635-130">See also</span></span>

- [<span data-ttu-id="57635-131">Exchange 2013 中的传输代理概念</span><span class="sxs-lookup"><span data-stu-id="57635-131">Transport agent concepts in Exchange 2013</span></span>](transport-agent-concepts-in-exchange-2013.md)    
- [<span data-ttu-id="57635-132">Exchange 2013 的传输代理参考</span><span class="sxs-lookup"><span data-stu-id="57635-132">Transport agent reference for Exchange 2013</span></span>](transport-agent-reference-for-exchange-2013.md)    
- [<span data-ttu-id="57635-133">为 Exchange 2013 创建 RoutingAgent 传输代理</span><span class="sxs-lookup"><span data-stu-id="57635-133">Create a RoutingAgent transport agent for Exchange 2013</span></span>](how-to-create-a-routingagent-transport-agent-for-exchange-2013.md)   
- [<span data-ttu-id="57635-134">为 Exchange 2013 创建 SmtpReceiveAgent 传输代理</span><span class="sxs-lookup"><span data-stu-id="57635-134">Create an SmtpReceiveAgent transport agent for Exchange 2013</span></span>](how-to-create-an-smtpreceiveagent-transport-agent-for-exchange-2013.md)    
- [<span data-ttu-id="57635-135">为 Exchange 2013 创建 DeliveryAgent 传输代理</span><span class="sxs-lookup"><span data-stu-id="57635-135">Create a DeliveryAgent transport agent for Exchange 2013</span></span>](how-to-create-a-deliveryagent-transport-agent-for-exchange-2013.md)
    

