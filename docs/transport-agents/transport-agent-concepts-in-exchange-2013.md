---
title: Exchange 2013 中的传输代理概念
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: 0c700af8-2792-4d3f-8571-8860e0550d8e
description: 查找有关 Exchange 2013 中的传输代理管道和服务器角色体系结构如何影响传输代理开发的信息，以及可用于开发传输代理的类。
ms.openlocfilehash: b9552ea4398ac8135a11b48eb7e7bdf5ec81985e
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/03/2020
ms.locfileid: "44527556"
---
# <a name="transport-agent-concepts-in-exchange-2013"></a><span data-ttu-id="e2fae-103">Exchange 2013 中的传输代理概念</span><span class="sxs-lookup"><span data-stu-id="e2fae-103">Transport agent concepts in Exchange 2013</span></span>

<span data-ttu-id="e2fae-104">查找有关 Exchange 2013 中的传输代理管道和服务器角色体系结构如何影响传输代理开发的信息，以及可用于开发传输代理的类。</span><span class="sxs-lookup"><span data-stu-id="e2fae-104">Find information about how the transport agent pipeline and server role architecture in Exchange 2013 affect transport agent development, and the classes that you can use to develop transport agents.</span></span> 
  
<span data-ttu-id="e2fae-105">**适用于：** Exchange Server 2013</span><span class="sxs-lookup"><span data-stu-id="e2fae-105">**Applies to:** Exchange Server 2013</span></span> 
  
<span data-ttu-id="e2fae-106">您可以使用 Exchange Server 2013 中提供的类库来实现为事件注册的传输代理，并在邮件通过传输管道时对邮件执行操作。</span><span class="sxs-lookup"><span data-stu-id="e2fae-106">You can use the class library provided in Exchange Server 2013 to implement transport agents that register for events and take actions on messages as they pass through the transport pipeline.</span></span> <span data-ttu-id="e2fae-107">您还可以使用传输代理来修改邮件和转换内容。</span><span class="sxs-lookup"><span data-stu-id="e2fae-107">You can also use transport agents to modify messages and convert content.</span></span> 
  
<span data-ttu-id="e2fae-108">本文提供有关传输代理和传输管道体系结构的信息。</span><span class="sxs-lookup"><span data-stu-id="e2fae-108">This article provides information about transport agents and the transport pipeline architecture.</span></span> <span data-ttu-id="e2fae-109">请务必了解传输管道的体系结构，以便您可以修改传输行为以满足组织的需求。</span><span class="sxs-lookup"><span data-stu-id="e2fae-109">It is important to understand the architecture of the transport pipeline so that you can modify transport behavior to meet your organization's needs.</span></span> <span data-ttu-id="e2fae-110">本文还提供了有关 Exchange 2013 体系结构中的更改的信息，这些更改会影响传输代理和可用于开发传输代理的类。</span><span class="sxs-lookup"><span data-stu-id="e2fae-110">This article also provides information about changes in the Exchange 2013 architecture that affect transport agents and the classes that you can use to develop transport agents.</span></span> 
  
## <a name="transport-agents-in-the-transport-pipeline"></a><span data-ttu-id="e2fae-111">传输管道中的传输代理</span><span class="sxs-lookup"><span data-stu-id="e2fae-111">Transport agents in the transport pipeline</span></span>
<span data-ttu-id="e2fae-112"><a name="Pipeline"> </a></span><span class="sxs-lookup"><span data-stu-id="e2fae-112"><a name="Pipeline"> </a></span></span>

<span data-ttu-id="e2fae-113">传输代理是从以下三个类之一派生的：</span><span class="sxs-lookup"><span data-stu-id="e2fae-113">Transport agents are derived from one of the following three classes:</span></span>
  
- [<span data-ttu-id="e2fae-114">SmtpReceiveAgent</span><span class="sxs-lookup"><span data-stu-id="e2fae-114">SmtpReceiveAgent</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.aspx)
- [<span data-ttu-id="e2fae-115">RoutingAgent</span><span class="sxs-lookup"><span data-stu-id="e2fae-115">RoutingAgent</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.aspx)
- [<span data-ttu-id="e2fae-116">DeliveryAgent</span><span class="sxs-lookup"><span data-stu-id="e2fae-116">DeliveryAgent</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Delivery.DeliveryAgent.aspx)
    
<span data-ttu-id="e2fae-117">传输管道指的是 Exchange 2013 组织边界内的邮件数据流。</span><span class="sxs-lookup"><span data-stu-id="e2fae-117">The transport pipeline refers to the flow of message data within the boundaries of an Exchange 2013 organization.</span></span> <span data-ttu-id="e2fae-118">管道包含下表中列出的服务。</span><span class="sxs-lookup"><span data-stu-id="e2fae-118">The pipeline consists of the services listed in the following table.</span></span>
  
<span data-ttu-id="e2fae-119">**表1。传输管道服务**</span><span class="sxs-lookup"><span data-stu-id="e2fae-119">**Table 1. Transport pipeline services**</span></span>

|<span data-ttu-id="e2fae-120">**服务**</span><span class="sxs-lookup"><span data-stu-id="e2fae-120">**Service**</span></span>|<span data-ttu-id="e2fae-121">**说明**</span><span class="sxs-lookup"><span data-stu-id="e2fae-121">**Description**</span></span>|<span data-ttu-id="e2fae-122">**支持的类**</span><span class="sxs-lookup"><span data-stu-id="e2fae-122">**Classes supported**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="e2fae-123">前端传输</span><span class="sxs-lookup"><span data-stu-id="e2fae-123">Front End Transport</span></span>  <br/> |<span data-ttu-id="e2fae-124">在所有[客户端访问服务器](https://technet.microsoft.com/library/dd298114%28v=exchg.150%29.aspx)上运行，并充当 Exchange 2013 组织的所有入站和出站外部 SMTP 流量的无状态代理。</span><span class="sxs-lookup"><span data-stu-id="e2fae-124">Runs on all [Client Access servers](https://technet.microsoft.com/library/dd298114%28v=exchg.150%29.aspx) and acts as a stateless proxy for all inbound and outbound external SMTP traffic for the Exchange 2013 organization.</span></span> <span data-ttu-id="e2fae-125">前端传输服务不检查邮件内容，也不会在本地将任何邮件排成队列。</span><span class="sxs-lookup"><span data-stu-id="e2fae-125">The Front End Transport service doesn't inspect message content or queue any messages locally.</span></span> <span data-ttu-id="e2fae-126">它与[邮箱服务器](https://technet.microsoft.com/library/jj150491%28v=exchg.150%29.aspx)上的传输服务进行通信。</span><span class="sxs-lookup"><span data-stu-id="e2fae-126">It communicates with the Transport service on a [Mailbox server](https://technet.microsoft.com/library/jj150491%28v=exchg.150%29.aspx).</span></span>  <br/> |[<span data-ttu-id="e2fae-127">SmtpReceiveAgent</span><span class="sxs-lookup"><span data-stu-id="e2fae-127">SmtpReceiveAgent</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.aspx) <br/> |
|<span data-ttu-id="e2fae-128">Transport</span><span class="sxs-lookup"><span data-stu-id="e2fae-128">Transport</span></span>  <br/> |<span data-ttu-id="e2fae-129">在所有邮箱服务器上运行，类似于 Exchange Server 2010 中的[集线器传输服务器](https://technet.microsoft.com/library/bb123494%28v=exchg.141%29.aspx)角色。</span><span class="sxs-lookup"><span data-stu-id="e2fae-129">Runs on all Mailbox servers and is similar to the [Hub Transport server](https://technet.microsoft.com/library/bb123494%28v=exchg.141%29.aspx) role in Exchange Server 2010.</span></span> <span data-ttu-id="e2fae-130">传输服务在其自身与邮箱传输服务和前端传输服务之间路由邮件。</span><span class="sxs-lookup"><span data-stu-id="e2fae-130">The Transport service routes messages between itself and the Mailbox Transport and Front End Transport services.</span></span> <span data-ttu-id="e2fae-131">此服务不与邮箱数据库直接通信。</span><span class="sxs-lookup"><span data-stu-id="e2fae-131">This service does not communicate directly with mailbox databases.</span></span>  <br/> |[<span data-ttu-id="e2fae-132">SmtpReceiveAgent</span><span class="sxs-lookup"><span data-stu-id="e2fae-132">SmtpReceiveAgent</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.aspx) <br/> [<span data-ttu-id="e2fae-133">RoutingAgent</span><span class="sxs-lookup"><span data-stu-id="e2fae-133">RoutingAgent</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.aspx) <br/> [<span data-ttu-id="e2fae-134">DeliveryAgent</span><span class="sxs-lookup"><span data-stu-id="e2fae-134">DeliveryAgent</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Delivery.DeliveryAgent.aspx) <br/> |
|<span data-ttu-id="e2fae-135">邮箱传输</span><span class="sxs-lookup"><span data-stu-id="e2fae-135">Mailbox Transport</span></span>  <br/> |<span data-ttu-id="e2fae-136">在所有邮箱服务器上运行，并包含两个单独的服务：邮箱传输提交和邮箱传输传递。</span><span class="sxs-lookup"><span data-stu-id="e2fae-136">Runs on all Mailbox servers and consists of two separate services: Mailbox Transport Submission and Mailbox Transport Delivery.</span></span> <span data-ttu-id="e2fae-137">邮箱传输传递从传输服务接收 SMTP 邮件，并使用 Exchange 远程过程调用（RPC）连接到邮箱数据库以传递邮件。</span><span class="sxs-lookup"><span data-stu-id="e2fae-137">Mailbox Transport Delivery receives SMTP messages from the Transport service, and connects to the mailbox database by using an Exchange remote procedure call (RPC) to deliver the message.</span></span> <span data-ttu-id="e2fae-138">邮箱传输提交使用 RPC 连接到邮箱数据库以检索邮件，并通过 SMTP 将邮件提交到传输服务。</span><span class="sxs-lookup"><span data-stu-id="e2fae-138">Mailbox Transport Submission connects to the mailbox database using RPC to retrieve messages, and submits the messages via SMTP to the Transport service.</span></span>  <br/> |<span data-ttu-id="e2fae-139">无。</span><span class="sxs-lookup"><span data-stu-id="e2fae-139">None.</span></span>  <br/> |
   
### <a name="transport-events"></a><span data-ttu-id="e2fae-140">传输事件</span><span class="sxs-lookup"><span data-stu-id="e2fae-140">Transport events</span></span>
<span data-ttu-id="e2fae-141"><a name="Events"> </a></span><span class="sxs-lookup"><span data-stu-id="e2fae-141"><a name="Events"> </a></span></span>

<span data-ttu-id="e2fae-142">您可以通过先注册事件来实现传输代理，然后在触发该事件时采取措施。</span><span class="sxs-lookup"><span data-stu-id="e2fae-142">You implement transport agents by first registering for an event, and then taking an action when that event fires.</span></span> <span data-ttu-id="e2fae-143">这三种代理类型中的每一种都可以注册一组不同的事件。</span><span class="sxs-lookup"><span data-stu-id="e2fae-143">Each of the three agent types can register for a different set of events.</span></span>
  
<span data-ttu-id="e2fae-144">下图显示了传输管道传输代理可以在何处注册事件。</span><span class="sxs-lookup"><span data-stu-id="e2fae-144">The following figure shows where in the transport pipeline transport agents can register for events.</span></span>
  
<span data-ttu-id="e2fae-145">**图1。传输事件**</span><span class="sxs-lookup"><span data-stu-id="e2fae-145">**Figure 1. Transport events**</span></span>

![此图显示通过传输管道的邮件流，以及每个代理可以为其注册的事件，首先是 SmtpReceivedAgent 的 Smtp 事件，然后是 RoutingAgent 的 Categorizor 事件，最后是为 DeliveryAgent 提供的事件。](media/TAConceptsFig1.png)
  
<span data-ttu-id="e2fae-147">当邮件进入传输管道时，从[SmtpReceiveAgent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.aspx)类派生的传输代理可以在注册了代理的任何 SMTP 事件过程中对邮件执行操作。</span><span class="sxs-lookup"><span data-stu-id="e2fae-147">When a message enters the transport pipeline, a transport agent derived from the [SmtpReceiveAgent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.aspx) class can act on the message during any of the SMTP events that the agent registered for.</span></span> <span data-ttu-id="e2fae-148">从[RoutingAgent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.aspx)类派生的代理可以操作它已注册的四个分类程序事件中的任何事件。</span><span class="sxs-lookup"><span data-stu-id="e2fae-148">An agent derived from the [RoutingAgent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.aspx) class can act on any of the four categorizer events that it has registered for.</span></span> <span data-ttu-id="e2fae-149">从[DeliveryAgent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Delivery.DeliveryAgent.aspx)类派生的代理可在其注册的任何传递事件过程中对邮件执行操作。</span><span class="sxs-lookup"><span data-stu-id="e2fae-149">An agent derived from the [DeliveryAgent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Delivery.DeliveryAgent.aspx) class can act on a message during any of the delivery events that it has registered for.</span></span> 
  
## <a name="transport-agents-and-server-roles"></a><span data-ttu-id="e2fae-150">传输代理和服务器角色</span><span class="sxs-lookup"><span data-stu-id="e2fae-150">Transport agents and server roles</span></span>
<span data-ttu-id="e2fae-151"><a name="ServerRoles"> </a></span><span class="sxs-lookup"><span data-stu-id="e2fae-151"><a name="ServerRoles"> </a></span></span>

<span data-ttu-id="e2fae-152">对 Exchange 2013 中的服务器角色体系结构所做的更改会影响传输代理以及传输代理可以执行的操作。</span><span class="sxs-lookup"><span data-stu-id="e2fae-152">Changes to the server role architecture in Exchange 2013 affect transport agents and what your transport agents can do.</span></span> <span data-ttu-id="e2fae-153">Exchange 2013 包括以下服务器角色：</span><span class="sxs-lookup"><span data-stu-id="e2fae-153">Exchange 2013 includes the following server roles:</span></span>
  
- <span data-ttu-id="e2fae-154">邮箱服务器—包括客户端访问协议、传输服务、邮箱数据库和统一消息组件。</span><span class="sxs-lookup"><span data-stu-id="e2fae-154">Mailbox server — Includes Client Access protocols, the Transport service, mailbox databases, and Unified Messaging components.</span></span> <span data-ttu-id="e2fae-155">邮箱服务器直接与 Active Directory 域服务（AD DS）、客户端访问服务器和邮件客户端（如 Outlook）进行通信。</span><span class="sxs-lookup"><span data-stu-id="e2fae-155">The Mailbox server communicates directly with Active Directory Domain Services (AD DS), Client Access servers, and mail clients such as Outlook.</span></span>
    
- <span data-ttu-id="e2fae-156">客户端访问服务器—提供身份验证、有限重定向、代理服务和客户端访问协议，如 HTTP、POP、IMAP 和 SMTP。</span><span class="sxs-lookup"><span data-stu-id="e2fae-156">Client Access server — Provides authentication, limited redirection, proxy services, and client access protocols such as HTTP, POP, IMAP, and SMTP.</span></span>
    
- <span data-ttu-id="e2fae-157">边缘传输服务器—将电子邮件路由到组织并将其传出。</span><span class="sxs-lookup"><span data-stu-id="e2fae-157">Edge Transport server — Routes email into and out of an organization.</span></span> <span data-ttu-id="e2fae-158">边缘传输服务器通常位于 Exchange 拓扑的外围。</span><span class="sxs-lookup"><span data-stu-id="e2fae-158">Edge Transport servers typically sit at the perimeter of an Exchange topology.</span></span>
    
<span data-ttu-id="e2fae-159">此合并结构减少了需要在 Exchange 2013 环境中部署的服务器的数量。</span><span class="sxs-lookup"><span data-stu-id="e2fae-159">This consolidated structure reduces the number of servers that need to be deployed in an Exchange 2013 environment.</span></span> <span data-ttu-id="e2fae-160">管理员不再需要在每个包含邮箱服务器的 Active Directory 站点中部署集线器传输服务器和客户端访问服务器，并且不再需要更新所有服务器角色，以便利用新功能。</span><span class="sxs-lookup"><span data-stu-id="e2fae-160">Administrators no longer have to deploy Hub Transport and Client Access servers in every Active Directory site that includes a Mailbox server, and they no longer need to update all server roles in order to take advantage of new functionality.</span></span>
  
<span data-ttu-id="e2fae-161">这些对服务器角色体系结构的更改可能会影响代理可以在管道中响应事件的位置。</span><span class="sxs-lookup"><span data-stu-id="e2fae-161">These changes to the server role architecture can potentially affect where in the pipeline your agent can respond to events.</span></span> <span data-ttu-id="e2fae-162">如果已创建早于 Exchange 2013 的 Exchange 版本的传输代理，请务必查看体系结构更改，以确定是否需要对代理进行任何更改。</span><span class="sxs-lookup"><span data-stu-id="e2fae-162">If you have created transport agents for versions of Exchange earlier than Exchange 2013, be sure to review the architectural changes to determine whether you need to make any changes to your agents.</span></span>
  
<span data-ttu-id="e2fae-163">下图显示了 Exchange 2013 中的体系结构更改如何导致简化的合并传输管道。</span><span class="sxs-lookup"><span data-stu-id="e2fae-163">The following figure shows how the architectural changes in Exchange 2013 result in a streamlined, consolidated transport pipeline.</span></span> <span data-ttu-id="e2fae-164">在此图中，客户端访问服务器被标记为 CAS。</span><span class="sxs-lookup"><span data-stu-id="e2fae-164">In this figure, Client Access servers are labeled CAS.</span></span> <span data-ttu-id="e2fae-165">和邮箱服务器标记为 MBX。</span><span class="sxs-lookup"><span data-stu-id="e2fae-165">And Mailbox servers are labeled MBX.</span></span>
  
<span data-ttu-id="e2fae-166">**图2。Exchange 2013 服务器角色体系结构**</span><span class="sxs-lookup"><span data-stu-id="e2fae-166">**Figure 2. Exchange 2013 server role architecture**</span></span>

![此图显示通过左侧外部防火墙和边缘传输的客户端流量，它将流量从第 4 层负载平衡传递到右侧数据库可访问性组中的整合 CAS 数组和一组邮箱服务器。](media/Transport_Agent_Concepts_Fig_3.png)
  
<span data-ttu-id="e2fae-168">下图显示了 Exchange 2013 服务器角色之间的交互。</span><span class="sxs-lookup"><span data-stu-id="e2fae-168">The following figure shows the interactions between the Exchange 2013 server roles.</span></span>
  
<span data-ttu-id="e2fae-169">**图3。邮箱和客户端访问服务器交互**</span><span class="sxs-lookup"><span data-stu-id="e2fae-169">**Figure 3. Mailbox and Client Access server interactions**</span></span>

![此图显示的互动箭头起始端为客户端流量，这些流量通过的第 4 层负载平衡在 CAS 中包含 4 个目标：IIS/HTTP 代理、POP/IMAP、SMTP 和 UM。箭头跳转到其在邮箱存储中的免费目标。](media/Transport_Agent_Concepts_Fig_4.png)
  
<span data-ttu-id="e2fae-172">有关 Exchange 2013 服务器角色体系结构中的更改的详细信息，请参阅 exchange 2013 中[的新增功能在 exchange 2013 中的](https://technet.microsoft.com/library/jj150540%28v=exchg.150%29.aspx)[体系结构](https://technet.microsoft.com/library/jj150540%28v=exchg.150%29.aspx#BKMK_Arch)。</span><span class="sxs-lookup"><span data-stu-id="e2fae-172">For more information about changes in the Exchange 2013 server role architecture, see [Exchange 2013 architecture](https://technet.microsoft.com/library/jj150540%28v=exchg.150%29.aspx#BKMK_Arch) in [What's New in Exchange 2013](https://technet.microsoft.com/library/jj150540%28v=exchg.150%29.aspx).</span></span> 
  
## <a name="transport-agent-classes"></a><span data-ttu-id="e2fae-173">传输代理类</span><span class="sxs-lookup"><span data-stu-id="e2fae-173">Transport agent classes</span></span>
<span data-ttu-id="e2fae-174"><a name="Create"> </a></span><span class="sxs-lookup"><span data-stu-id="e2fae-174"><a name="Create"> </a></span></span>

<span data-ttu-id="e2fae-175">你的传输代理派生的类决定了代理可为其注册的事件。</span><span class="sxs-lookup"><span data-stu-id="e2fae-175">The class your transport agent derives from determines the events for which your agent can register.</span></span> <span data-ttu-id="e2fae-176">您的代理通常包含代理类、代理工厂、一个或多个事件处理程序以及执行您希望代理执行的操作的代码。</span><span class="sxs-lookup"><span data-stu-id="e2fae-176">Your agent will typically contain an agent class, an agent factory, one or more event handlers, and the code that performs the actions that you want your agent to take.</span></span>
  
<span data-ttu-id="e2fae-177">下表列出了要为每个代理类型派生的类。</span><span class="sxs-lookup"><span data-stu-id="e2fae-177">The following table lists the classes from which to derive for each agent type.</span></span>
  
<span data-ttu-id="e2fae-178">**表2。代理类**</span><span class="sxs-lookup"><span data-stu-id="e2fae-178">**Table 2. Agent classes**</span></span>

||||
|:-----|:-----|:-----|
|<span data-ttu-id="e2fae-179">代理类型</span><span class="sxs-lookup"><span data-stu-id="e2fae-179">Agent type</span></span>  <br/> |<span data-ttu-id="e2fae-180">工厂基类</span><span class="sxs-lookup"><span data-stu-id="e2fae-180">Factory base class</span></span>  <br/> |<span data-ttu-id="e2fae-181">代理基类</span><span class="sxs-lookup"><span data-stu-id="e2fae-181">Agent base class</span></span>  <br/> |
|<span data-ttu-id="e2fae-182">SMTP 接收</span><span class="sxs-lookup"><span data-stu-id="e2fae-182">SMTP receive</span></span>  <br/> |[<span data-ttu-id="e2fae-183">SmtpReceiveAgentFactory</span><span class="sxs-lookup"><span data-stu-id="e2fae-183">SmtpReceiveAgentFactory</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgentFactory.aspx) <br/> |[<span data-ttu-id="e2fae-184">SmtpReceiveAgent</span><span class="sxs-lookup"><span data-stu-id="e2fae-184">SmtpReceiveAgent</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.aspx) <br/> |
|<span data-ttu-id="e2fae-185">路径</span><span class="sxs-lookup"><span data-stu-id="e2fae-185">Routing</span></span>  <br/> |[<span data-ttu-id="e2fae-186">RoutingAgentFactory</span><span class="sxs-lookup"><span data-stu-id="e2fae-186">RoutingAgentFactory</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgentFactory.aspx) <br/> |[<span data-ttu-id="e2fae-187">RoutingAgent</span><span class="sxs-lookup"><span data-stu-id="e2fae-187">RoutingAgent</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.aspx) <br/> |
|<span data-ttu-id="e2fae-188">Delivery</span><span class="sxs-lookup"><span data-stu-id="e2fae-188">Delivery</span></span>  <br/> |<span data-ttu-id="e2fae-189">[DeliveryAgentFactory\<Manager\>](https://msdn.microsoft.com/library/dd877550(v=exchg.150).aspx)</span><span class="sxs-lookup"><span data-stu-id="e2fae-189">[DeliveryAgentFactory\<Manager\>](https://msdn.microsoft.com/library/dd877550(v=exchg.150).aspx)</span></span> <br/> |<span data-ttu-id="e2fae-190">[DeliveryAgent](https://msdn.microsoft.com/library/microsoft.exchange.data.transport.delivery.deliveryagent(v=exchg.150).aspx)</span><span class="sxs-lookup"><span data-stu-id="e2fae-190">[DeliveryAgent](https://msdn.microsoft.com/library/microsoft.exchange.data.transport.delivery.deliveryagent(v=exchg.150).aspx)</span></span> <br/> |
   
<span data-ttu-id="e2fae-191">这些工厂和代理基类提供了可用于访问传输事件和邮件的属性和方法。</span><span class="sxs-lookup"><span data-stu-id="e2fae-191">These factory and agent base classes provide properties and methods that you can use to access transport events and messages.</span></span> <span data-ttu-id="e2fae-192">在代理中实现从这些类继承的类。</span><span class="sxs-lookup"><span data-stu-id="e2fae-192">Implement classes in your agent that inherit from these classes.</span></span> <span data-ttu-id="e2fae-193">在代理工厂派生类中，重写**CreateAgent**方法，以使其返回代理类的新实例。</span><span class="sxs-lookup"><span data-stu-id="e2fae-193">In the agent factory derived class, override the **CreateAgent** method so that it returns a new instance of your agent class.</span></span> 
  
<span data-ttu-id="e2fae-194">传递给事件的参数可以包含[EmailMessage](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Email.EmailMessage.aspx)类的实例，可以使用它来更改基础邮件的属性和内容。</span><span class="sxs-lookup"><span data-stu-id="e2fae-194">Arguments passed to the events can contain an instance of the [EmailMessage](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Email.EmailMessage.aspx) class, which you can use to change the properties and contents of the underlying message.</span></span> <span data-ttu-id="e2fae-195">并非所有邮件信息在每个事件中都可用。</span><span class="sxs-lookup"><span data-stu-id="e2fae-195">Not all message information is available in each event.</span></span> <span data-ttu-id="e2fae-196">您必须确定哪个代理以及哪种事件最适合要完成的任务。</span><span class="sxs-lookup"><span data-stu-id="e2fae-196">You must determine which agent and which event is best for the task you want to accomplish.</span></span> 
  
<span data-ttu-id="e2fae-197">以下命名空间包含可用于读取、写入和修改传输管道中的邮件的类型：</span><span class="sxs-lookup"><span data-stu-id="e2fae-197">The following namespaces contain types that you can use to read, write, and modify messages in the transport pipeline:</span></span>
  
- [<span data-ttu-id="e2fae-198">（即，模拟编码器）</span><span class="sxs-lookup"><span data-stu-id="e2fae-198">Microsoft.Exchange.Data.Mime.Encoders</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.aspx)
    
- [<span data-ttu-id="e2fae-199">ContentTypes 的数据。</span><span class="sxs-lookup"><span data-stu-id="e2fae-199">Microsoft.Exchange.Data.ContentTypes.iCalendar</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.aspx)
    
- [<span data-ttu-id="e2fae-200">Microsoft. 数据 Mime</span><span class="sxs-lookup"><span data-stu-id="e2fae-200">Microsoft.Exchange.Data.Mime</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.aspx)
    
- [<span data-ttu-id="e2fae-201">"ContentTypes"。</span><span class="sxs-lookup"><span data-stu-id="e2fae-201">Microsoft.Exchange.Data.ContentTypes.Tnef</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.aspx)
    
- [<span data-ttu-id="e2fae-202">ContentTypes 的电子名片</span><span class="sxs-lookup"><span data-stu-id="e2fae-202">Microsoft.Exchange.Data.ContentTypes.vCard</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.vCard.aspx)
    
<span data-ttu-id="e2fae-203">在编写传输代理后，通过使用 Exchange 命令行管理[程序来安装和管理代理](https://technet.microsoft.com/library/bb125175%28v=exchg.150%29.aspx)。</span><span class="sxs-lookup"><span data-stu-id="e2fae-203">After you write your transport agent, you [install and manage your agent](https://technet.microsoft.com/library/bb125175%28v=exchg.150%29.aspx) by using the Exchange Management Shell.</span></span> <span data-ttu-id="e2fae-204">有关详细信息，请参阅为[Exchange 2013 创建传输代理](creating-transport-agents-for-exchange-2013.md)。</span><span class="sxs-lookup"><span data-stu-id="e2fae-204">For more information, see [Creating transport agents for Exchange 2013](creating-transport-agents-for-exchange-2013.md).</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="e2fae-205">另请参阅</span><span class="sxs-lookup"><span data-stu-id="e2fae-205">See also</span></span>

- [<span data-ttu-id="e2fae-206">Exchange 中的传输代理</span><span class="sxs-lookup"><span data-stu-id="e2fae-206">Transport agents in Exchange</span></span>](transport-agents-in-exchange-2013.md)    
- [<span data-ttu-id="e2fae-207">Exchange 2013 的传输代理参考</span><span class="sxs-lookup"><span data-stu-id="e2fae-207">Transport agent reference for Exchange 2013</span></span>](transport-agent-reference-for-exchange-2013.md)   
- [<span data-ttu-id="e2fae-208">读取和修改 Exchange 2013 传输管道中的邮件</span><span class="sxs-lookup"><span data-stu-id="e2fae-208">Reading and modifying messages in the Exchange 2013 transport pipeline</span></span>](reading-and-modifying-messages-in-the-exchange-2013-transport-pipeline.md)    
- [<span data-ttu-id="e2fae-209">Exchange 2013 中的新增功能</span><span class="sxs-lookup"><span data-stu-id="e2fae-209">What's New in Exchange 2013</span></span>](https://technet.microsoft.com/library/jj150540%28v=exchg.150%29.aspx)   
- [<span data-ttu-id="e2fae-210">Exchange 2013 服务器角色体系结构</span><span class="sxs-lookup"><span data-stu-id="e2fae-210">Exchange 2013 Server Role Architecture</span></span>](https://blogs.technet.com/b/exchange/archive/2013/01/23/exchange-2013-server-role-architecture.aspx)    
- [<span data-ttu-id="e2fae-211">邮箱服务器和客户端访问服务器</span><span class="sxs-lookup"><span data-stu-id="e2fae-211">Mailbox and Client Access Servers</span></span>](https://technet.microsoft.com/library/jj150519%28v=exchg.150%29.aspx)   
- [<span data-ttu-id="e2fae-212">Exchange Server 2013 邮件流</span><span class="sxs-lookup"><span data-stu-id="e2fae-212">Exchange Server 2013 Mail Flow</span></span>](https://technet.microsoft.com/library/aa996349.aspx)
- [<span data-ttu-id="e2fae-213">Exchange Server 2013 邮件路由</span><span class="sxs-lookup"><span data-stu-id="e2fae-213">Exchange Server 2013 Mail Routing</span></span>](https://technet.microsoft.com/library/aa998825%28v=exchg.150%29.aspx)   
- [<span data-ttu-id="e2fae-214">Exchange Server PowerShell （Exchange 命令行管理程序）</span><span class="sxs-lookup"><span data-stu-id="e2fae-214">Exchange Server PowerShell (Exchange Management Shell)</span></span>](https://docs.microsoft.com/powershell/exchange/exchange-server/exchange-management-shell?view=exchange-ps)
    

