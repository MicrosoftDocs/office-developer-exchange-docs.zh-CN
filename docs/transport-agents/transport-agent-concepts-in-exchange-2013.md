---
title: 传输代理 Exchange 2013 中的概念
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: 0c700af8-2792-4d3f-8571-8860e0550d8e
description: 查找有关如何传输代理管道和服务器角色体系结构在 Exchange 2013 影响传输代理开发，以及可用于开发传输代理的类的信息。
ms.openlocfilehash: 9ddee0d68c9104357f84322b2cce7c5f2576d871
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/25/2018
ms.locfileid: "19753089"
---
# <a name="transport-agent-concepts-in-exchange-2013"></a><span data-ttu-id="83711-103">传输代理 Exchange 2013 中的概念</span><span class="sxs-lookup"><span data-stu-id="83711-103">Transport agent concepts in Exchange 2013</span></span>

<span data-ttu-id="83711-104">查找有关如何传输代理管道和服务器角色体系结构在 Exchange 2013 影响传输代理开发，以及可用于开发传输代理的类的信息。</span><span class="sxs-lookup"><span data-stu-id="83711-104">Find information about how the transport agent pipeline and server role architecture in Exchange 2013 affect transport agent development, and the classes that you can use to develop transport agents.</span></span> 
  
<span data-ttu-id="83711-105">**适用于：** Exchange Server 2013</span><span class="sxs-lookup"><span data-stu-id="83711-105">**Applies to:** Exchange Server 2013</span></span> 
  
<span data-ttu-id="83711-106">提供在 Exchange Server 2013 类库可用于实现的注册事件和执行对邮件的操作，当通过传输管道传输代理。</span><span class="sxs-lookup"><span data-stu-id="83711-106">You can use the class library provided in Exchange Server 2013 to implement transport agents that register for events and take actions on messages as they pass through the transport pipeline.</span></span> <span data-ttu-id="83711-107">您还可以使用传输代理修改邮件并将内容转换。</span><span class="sxs-lookup"><span data-stu-id="83711-107">You can also use transport agents to modify messages and convert content.</span></span> 
  
<span data-ttu-id="83711-108">本文提供了有关传输代理的信息和传输管道体系结构。</span><span class="sxs-lookup"><span data-stu-id="83711-108">This article provides information about transport agents and the transport pipeline architecture.</span></span> <span data-ttu-id="83711-109">务必要了解传输管道的体系结构，以便您可以修改传输行为以满足您组织的需求。</span><span class="sxs-lookup"><span data-stu-id="83711-109">It is important to understand the architecture of the transport pipeline so that you can modify transport behavior to meet your organization's needs.</span></span> <span data-ttu-id="83711-110">本文还提供了有关影响传输代理的 Exchange 2013 体系结构和可用于开发传输代理的类中的更改的信息。</span><span class="sxs-lookup"><span data-stu-id="83711-110">This article also provides information about changes in the Exchange 2013 architecture that affect transport agents and the classes that you can use to develop transport agents.</span></span> 
  
## <a name="transport-agents-in-the-transport-pipeline"></a><span data-ttu-id="83711-111">传输管道中的传输代理</span><span class="sxs-lookup"><span data-stu-id="83711-111">Transport agents in the transport pipeline</span></span>
<span data-ttu-id="83711-112"><a name="Pipeline"> </a></span><span class="sxs-lookup"><span data-stu-id="83711-112"></span></span>

<span data-ttu-id="83711-113">从以下三类之一派生传输代理：</span><span class="sxs-lookup"><span data-stu-id="83711-113">Transport agents are derived from one of the following three classes:</span></span>
  
- [<span data-ttu-id="83711-114">SmtpReceiveAgent</span><span class="sxs-lookup"><span data-stu-id="83711-114">SmtpReceiveAgent</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.aspx)
- [<span data-ttu-id="83711-115">RoutingAgent</span><span class="sxs-lookup"><span data-stu-id="83711-115">RoutingAgent</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.aspx)
- [<span data-ttu-id="83711-116">DeliveryAgent</span><span class="sxs-lookup"><span data-stu-id="83711-116">DeliveryAgent</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Delivery.DeliveryAgent.aspx)
    
<span data-ttu-id="83711-117">传输管道是指数据流 Exchange 2013 组织的边界内的邮件。</span><span class="sxs-lookup"><span data-stu-id="83711-117">The transport pipeline refers to the flow of message data within the boundaries of an Exchange 2013 organization.</span></span> <span data-ttu-id="83711-118">管道包含下表中列出的服务。</span><span class="sxs-lookup"><span data-stu-id="83711-118">The pipeline consists of the services listed in the following table.</span></span>
  
<span data-ttu-id="83711-119">**表 1。传输管道服务**</span><span class="sxs-lookup"><span data-stu-id="83711-119">**Table 1. Transport pipeline services**</span></span>

|<span data-ttu-id="83711-120">**服务**</span><span class="sxs-lookup"><span data-stu-id="83711-120">**Service**</span></span>|<span data-ttu-id="83711-121">**说明**</span><span class="sxs-lookup"><span data-stu-id="83711-121">**Description**</span></span>|<span data-ttu-id="83711-122">**支持的类**</span><span class="sxs-lookup"><span data-stu-id="83711-122">**Classes supported**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="83711-123">前端传输</span><span class="sxs-lookup"><span data-stu-id="83711-123">Front End Transport</span></span>  <br/> |<span data-ttu-id="83711-124">所有[客户端访问服务器](http://technet.microsoft.com/en-us/library/dd298114%28v=exchg.150%29.aspx)上运行并充当所有入站和出站外部 SMTP 流量 Exchange 2013 组织无状态代理。</span><span class="sxs-lookup"><span data-stu-id="83711-124">Runs on all [Client Access servers](http://technet.microsoft.com/en-us/library/dd298114%28v=exchg.150%29.aspx) and acts as a stateless proxy for all inbound and outbound external SMTP traffic for the Exchange 2013 organization.</span></span> <span data-ttu-id="83711-125">前端传输服务不检查消息内容或队列本地任何消息。</span><span class="sxs-lookup"><span data-stu-id="83711-125">The Front End Transport service doesn't inspect message content or queue any messages locally.</span></span> <span data-ttu-id="83711-126">在[邮箱服务器](http://technet.microsoft.com/en-us/library/jj150491%28v=exchg.150%29.aspx)上的传输服务通信。</span><span class="sxs-lookup"><span data-stu-id="83711-126">It communicates with the Transport service on a [Mailbox server](http://technet.microsoft.com/en-us/library/jj150491%28v=exchg.150%29.aspx).</span></span>  <br/> |[<span data-ttu-id="83711-127">SmtpReceiveAgent</span><span class="sxs-lookup"><span data-stu-id="83711-127">SmtpReceiveAgent</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.aspx) <br/> |
|<span data-ttu-id="83711-128">传输</span><span class="sxs-lookup"><span data-stu-id="83711-128">Transport</span></span>  <br/> |<span data-ttu-id="83711-129">在所有邮箱服务器上运行并且是类似于 Exchange Server 2010 中的[集线器传输服务器](http://technet.microsoft.com/en-us/library/bb123494%28v=exchg.141%29.aspx)角色。</span><span class="sxs-lookup"><span data-stu-id="83711-129">Runs on all Mailbox servers and is similar to the [Hub Transport server](http://technet.microsoft.com/en-us/library/bb123494%28v=exchg.141%29.aspx) role in Exchange Server 2010.</span></span> <span data-ttu-id="83711-130">传输服务路由本身和的邮箱传输和前端传输服务之间的邮件。</span><span class="sxs-lookup"><span data-stu-id="83711-130">The Transport service routes messages between itself and the Mailbox Transport and Front End Transport services.</span></span> <span data-ttu-id="83711-131">此服务不直接与邮箱数据库通信。</span><span class="sxs-lookup"><span data-stu-id="83711-131">This service does not communicate directly with mailbox databases.</span></span>  <br/> |[<span data-ttu-id="83711-132">SmtpReceiveAgent</span><span class="sxs-lookup"><span data-stu-id="83711-132">SmtpReceiveAgent</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.aspx) <br/> [<span data-ttu-id="83711-133">RoutingAgent</span><span class="sxs-lookup"><span data-stu-id="83711-133">RoutingAgent</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.aspx) <br/> [<span data-ttu-id="83711-134">DeliveryAgent</span><span class="sxs-lookup"><span data-stu-id="83711-134">DeliveryAgent</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Delivery.DeliveryAgent.aspx) <br/> |
|<span data-ttu-id="83711-135">邮箱传输</span><span class="sxs-lookup"><span data-stu-id="83711-135">Mailbox Transport</span></span>  <br/> |<span data-ttu-id="83711-136">将所有邮箱服务器上运行并包含两个单独的服务： 邮箱传输提交和邮箱传输传递。</span><span class="sxs-lookup"><span data-stu-id="83711-136">Runs on all Mailbox servers and consists of two separate services: Mailbox Transport Submission and Mailbox Transport Delivery.</span></span> <span data-ttu-id="83711-137">邮箱传输传递 SMTP 邮件接收的传输服务，并通过使用 Exchange 远程过程调用 (RPC) 将邮件传递到邮箱数据库连接。</span><span class="sxs-lookup"><span data-stu-id="83711-137">Mailbox Transport Delivery receives SMTP messages from the Transport service, and connects to the mailbox database by using an Exchange remote procedure call (RPC) to deliver the message.</span></span> <span data-ttu-id="83711-138">邮箱传输提交连接到邮箱数据库 RPC 用于检索邮件，并提交通过 SMTP 邮件的传输服务。</span><span class="sxs-lookup"><span data-stu-id="83711-138">Mailbox Transport Submission connects to the mailbox database using RPC to retrieve messages, and submits the messages via SMTP to the Transport service.</span></span>  <br/> |<span data-ttu-id="83711-139">无。</span><span class="sxs-lookup"><span data-stu-id="83711-139">None.</span></span>  <br/> |
   
### <a name="transport-events"></a><span data-ttu-id="83711-140">传输事件</span><span class="sxs-lookup"><span data-stu-id="83711-140">Transport events</span></span>
<span data-ttu-id="83711-141"><a name="Events"> </a></span><span class="sxs-lookup"><span data-stu-id="83711-141"></span></span>

<span data-ttu-id="83711-142">通过先注册事件，并随后执行一个操作时，会触发该事件实现传输代理。</span><span class="sxs-lookup"><span data-stu-id="83711-142">You implement transport agents by first registering for an event, and then taking an action when that event fires.</span></span> <span data-ttu-id="83711-143">每个三个代理类型可以注册的一组不同的事件。</span><span class="sxs-lookup"><span data-stu-id="83711-143">Each of the three agent types can register for a different set of events.</span></span>
  
<span data-ttu-id="83711-144">下图显示了在传输管道传输代理可以注册事件中的位置。</span><span class="sxs-lookup"><span data-stu-id="83711-144">The following figure shows where in the transport pipeline transport agents can register for events.</span></span>
  
<span data-ttu-id="83711-145">**图 1。传输事件**</span><span class="sxs-lookup"><span data-stu-id="83711-145">**Figure 1. Transport events**</span></span>

![此图显示通过传输管道的邮件流，以及每个代理可以为其注册的事件，首先是 SmtpReceivedAgent 的 Smtp 事件，然后是 RoutingAgent 的 Categorizor 事件，最后是为 DeliveryAgent 提供的事件。](media/TAConceptsFig1.png)
  
<span data-ttu-id="83711-147">当邮件进入传输管道时，从[SmtpReceiveAgent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.aspx)类派生的传输代理可以期间注册的代理的 SMTP 事件，作用于邮件。</span><span class="sxs-lookup"><span data-stu-id="83711-147">When a message enters the transport pipeline, a transport agent derived from the [SmtpReceiveAgent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.aspx) class can act on the message during any of the SMTP events that the agent registered for.</span></span> <span data-ttu-id="83711-148">在任何已注册的四个分类程序事件可充当[RoutingAgent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.aspx)类派生的代理。</span><span class="sxs-lookup"><span data-stu-id="83711-148">An agent derived from the [RoutingAgent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.aspx) class can act on any of the four categorizer events that it has registered for.</span></span> <span data-ttu-id="83711-149">从[DeliveryAgent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Delivery.DeliveryAgent.aspx)类派生代理可以在任何已注册的传递事件期间对邮件进行操作。</span><span class="sxs-lookup"><span data-stu-id="83711-149">An agent derived from the [DeliveryAgent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Delivery.DeliveryAgent.aspx) class can act on a message during any of the delivery events that it has registered for.</span></span> 
  
## <a name="transport-agents-and-server-roles"></a><span data-ttu-id="83711-150">传输代理和服务器角色</span><span class="sxs-lookup"><span data-stu-id="83711-150">Transport agents and server roles</span></span>
<span data-ttu-id="83711-151"><a name="ServerRoles"> </a></span><span class="sxs-lookup"><span data-stu-id="83711-151"></span></span>

<span data-ttu-id="83711-152">对服务器角色体系结构更改在 Exchange 2013 影响传输代理以及传输代理可以执行哪些操作。</span><span class="sxs-lookup"><span data-stu-id="83711-152">Changes to the server role architecture in Exchange 2013 affect transport agents and what your transport agents can do.</span></span> <span data-ttu-id="83711-153">Exchange 2013 包括下列服务器角色：</span><span class="sxs-lookup"><span data-stu-id="83711-153">Exchange 2013 includes the following server roles:</span></span>
  
- <span data-ttu-id="83711-154">邮箱服务器，包括客户端访问协议、 传输服务、 邮箱数据库和统一消息组件。</span><span class="sxs-lookup"><span data-stu-id="83711-154">Mailbox server — Includes Client Access protocols, the Transport service, mailbox databases, and Unified Messaging components.</span></span> <span data-ttu-id="83711-155">邮箱服务器直接与 Active Directory 域服务 (AD DS) 和客户端访问服务器，如 Outlook 的邮件客户端通信。</span><span class="sxs-lookup"><span data-stu-id="83711-155">The Mailbox server communicates directly with Active Directory Domain Services (AD DS), Client Access servers, and mail clients such as Outlook.</span></span>
    
- <span data-ttu-id="83711-156">客户端访问服务器 — 提供身份验证、 有限的重定向、 代理服务和客户端访问协议，如 HTTP、 POP、 IMAP 和 SMTP。</span><span class="sxs-lookup"><span data-stu-id="83711-156">Client Access server — Provides authentication, limited redirection, proxy services, and client access protocols such as HTTP, POP, IMAP, and SMTP.</span></span>
    
- <span data-ttu-id="83711-157">边缘传输服务器 — 和注销组织的电子邮件路由。</span><span class="sxs-lookup"><span data-stu-id="83711-157">Edge Transport server — Routes email into and out of an organization.</span></span> <span data-ttu-id="83711-158">在 Exchange 拓扑的外围通常 sit 边缘传输服务器。</span><span class="sxs-lookup"><span data-stu-id="83711-158">Edge Transport servers typically sit at the perimeter of an Exchange topology.</span></span>
    
<span data-ttu-id="83711-159">此合并的结构减少了需要在 Exchange 2013 环境中部署的服务器的数量。</span><span class="sxs-lookup"><span data-stu-id="83711-159">This consolidated structure reduces the number of servers that need to be deployed in an Exchange 2013 environment.</span></span> <span data-ttu-id="83711-160">管理员不再需要部署包括一个邮箱服务器，每个 Active Directory 站点中的集线器传输和客户端访问服务器，它们不再需要更新所有服务器角色，以便充分利用新功能。</span><span class="sxs-lookup"><span data-stu-id="83711-160">Administrators no longer have to deploy Hub Transport and Client Access servers in every Active Directory site that includes a Mailbox server, and they no longer need to update all server roles in order to take advantage of new functionality.</span></span>
  
<span data-ttu-id="83711-161">对服务器角色体系结构的这些更改可能会影响其中管道中您的代理可以响应事件。</span><span class="sxs-lookup"><span data-stu-id="83711-161">These changes to the server role architecture can potentially affect where in the pipeline your agent can respond to events.</span></span> <span data-ttu-id="83711-162">如果您已创建的早于 Exchange 2013 版本的 Exchange 传输代理，请务必查看体系结构的更改，以确定是否需要对您的代理进行任何更改。</span><span class="sxs-lookup"><span data-stu-id="83711-162">If you have created transport agents for versions of Exchange earlier than Exchange 2013, be sure to review the architectural changes to determine whether you need to make any changes to your agents.</span></span>
  
<span data-ttu-id="83711-163">下图显示了如何在 Exchange 2013 中的体系结构更改导致简化、 合并传输管道。</span><span class="sxs-lookup"><span data-stu-id="83711-163">The following figure shows how the architectural changes in Exchange 2013 result in a streamlined, consolidated transport pipeline.</span></span> <span data-ttu-id="83711-164">在此图中，客户端访问服务器标记 CAS。</span><span class="sxs-lookup"><span data-stu-id="83711-164">In this figure, Client Access servers are labeled CAS.</span></span> <span data-ttu-id="83711-165">和邮箱服务器标记 MBX。</span><span class="sxs-lookup"><span data-stu-id="83711-165">And Mailbox servers are labeled MBX.</span></span>
  
<span data-ttu-id="83711-166">**图 2。Exchange 2013 服务器角色体系结构**</span><span class="sxs-lookup"><span data-stu-id="83711-166">**Figure 2. Exchange 2013 server role architecture**</span></span>

![此图显示通过左侧外部防火墙和边缘传输的客户端流量，它将流量从第 4 层负载平衡传递到右侧数据库可访问性组中的整合 CAS 数组和一组邮箱服务器。](media/Transport_Agent_Concepts_Fig_3.png)
  
<span data-ttu-id="83711-168">下图显示了 Exchange 2013 服务器角色之间的交互。</span><span class="sxs-lookup"><span data-stu-id="83711-168">The following figure shows the interactions between the Exchange 2013 server roles.</span></span>
  
<span data-ttu-id="83711-169">**图 3。邮箱和客户端访问服务器交互**</span><span class="sxs-lookup"><span data-stu-id="83711-169">**Figure 3. Mailbox and Client Access server interactions**</span></span>

![此图显示的互动箭头起始端为客户端流量，这些流量通过的第 4 层负载平衡在 CAS 中包含 4 个目标：IIS/HTTP 代理、POP/IMAP、SMTP 和 UM。箭头跳转到其在邮箱存储中的免费目标。](media/Transport_Agent_Concepts_Fig_4.png)
  
<span data-ttu-id="83711-172">有关 Exchange 2013 服务器角色体系结构中的更改的详细信息，请参阅[What's New in Exchange 2013](http://technet.microsoft.com/en-us/library/jj150540%28v=exchg.150%29.aspx)中的[Exchange 2013 体系结构](http://technet.microsoft.com/en-us/library/jj150540%28v=exchg.150%29.aspx#BKMK_Arch)。</span><span class="sxs-lookup"><span data-stu-id="83711-172">For more information about changes in the Exchange 2013 server role architecture, see [Exchange 2013 architecture](http://technet.microsoft.com/en-us/library/jj150540%28v=exchg.150%29.aspx#BKMK_Arch) in [What's New in Exchange 2013](http://technet.microsoft.com/en-us/library/jj150540%28v=exchg.150%29.aspx).</span></span> 
  
## <a name="transport-agent-classes"></a><span data-ttu-id="83711-173">传输代理类</span><span class="sxs-lookup"><span data-stu-id="83711-173">Transport agent classes</span></span>
<span data-ttu-id="83711-174"><a name="Create"> </a></span><span class="sxs-lookup"><span data-stu-id="83711-174"></span></span>

<span data-ttu-id="83711-175">传输代理派生的类确定您的代理可为其注册的事件。</span><span class="sxs-lookup"><span data-stu-id="83711-175">The class your transport agent derives from determines the events for which your agent can register.</span></span> <span data-ttu-id="83711-176">您的代理通常将包含一个代理类、 代理工厂、 一个或多个事件处理程序和执行希望您的代理程序执行的操作的代码。</span><span class="sxs-lookup"><span data-stu-id="83711-176">Your agent will typically contain an agent class, an agent factory, one or more event handlers, and the code that performs the actions that you want your agent to take.</span></span>
  
<span data-ttu-id="83711-177">下表列出了要从中派生每个代理类型的类。</span><span class="sxs-lookup"><span data-stu-id="83711-177">The following table lists the classes from which to derive for each agent type.</span></span>
  
<span data-ttu-id="83711-178">**表 2。代理类**</span><span class="sxs-lookup"><span data-stu-id="83711-178">**Table 2. Agent classes**</span></span>

||||
|:-----|:-----|:-----|
|<span data-ttu-id="83711-179">代理类型</span><span class="sxs-lookup"><span data-stu-id="83711-179">Agent type</span></span>  <br/> |<span data-ttu-id="83711-180">中心基类</span><span class="sxs-lookup"><span data-stu-id="83711-180">Factory base class</span></span>  <br/> |<span data-ttu-id="83711-181">代理基类</span><span class="sxs-lookup"><span data-stu-id="83711-181">Agent base class</span></span>  <br/> |
|<span data-ttu-id="83711-182">SMTP 接收</span><span class="sxs-lookup"><span data-stu-id="83711-182">SMTP receive</span></span>  <br/> |[<span data-ttu-id="83711-183">SmtpReceiveAgentFactory</span><span class="sxs-lookup"><span data-stu-id="83711-183">SmtpReceiveAgentFactory</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgentFactory.aspx) <br/> |[<span data-ttu-id="83711-184">SmtpReceiveAgent</span><span class="sxs-lookup"><span data-stu-id="83711-184">SmtpReceiveAgent</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Smtp.SmtpReceiveAgent.aspx) <br/> |
|<span data-ttu-id="83711-185">路由</span><span class="sxs-lookup"><span data-stu-id="83711-185">Routing</span></span>  <br/> |[<span data-ttu-id="83711-186">RoutingAgentFactory</span><span class="sxs-lookup"><span data-stu-id="83711-186">RoutingAgentFactory</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgentFactory.aspx) <br/> |[<span data-ttu-id="83711-187">RoutingAgent</span><span class="sxs-lookup"><span data-stu-id="83711-187">RoutingAgent</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Routing.RoutingAgent.aspx) <br/> |
|<span data-ttu-id="83711-188">传递</span><span class="sxs-lookup"><span data-stu-id="83711-188">Delivery</span></span>  <br/> |[<span data-ttu-id="83711-189">DeliveryAgentFactory\<管理器\></span><span class="sxs-lookup"><span data-stu-id="83711-189">DeliveryAgentFactory\<Manager\></span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Delivery.DeliveryAgentFactory`1.aspx) <br/> |[<span data-ttu-id="83711-190">DeliveryAgent</span><span class="sxs-lookup"><span data-stu-id="83711-190">DeliveryAgent</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Delivery.DeliveryAgent.aspx) <br/> |
   
<span data-ttu-id="83711-191">属性和方法可用于访问传输事件和消息，提供了这些中心和代理的基类。</span><span class="sxs-lookup"><span data-stu-id="83711-191">These factory and agent base classes provide properties and methods that you can use to access transport events and messages.</span></span> <span data-ttu-id="83711-192">在您从这些类继承的代理中实现类。</span><span class="sxs-lookup"><span data-stu-id="83711-192">Implement classes in your agent that inherit from these classes.</span></span> <span data-ttu-id="83711-193">在代理工厂派生类中，重写**CreateAgent**方法，以便它返回代理类的新实例。</span><span class="sxs-lookup"><span data-stu-id="83711-193">In the agent factory derived class, override the **CreateAgent** method so that it returns a new instance of your agent class.</span></span> 
  
<span data-ttu-id="83711-194">传递给事件参数可以包含实例[EmailMessage](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Email.EmailMessage.aspx)类中，您可以使用更改的属性和基础邮件的内容。</span><span class="sxs-lookup"><span data-stu-id="83711-194">Arguments passed to the events can contain an instance of the [EmailMessage](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Transport.Email.EmailMessage.aspx) class, which you can use to change the properties and contents of the underlying message.</span></span> <span data-ttu-id="83711-195">并非所有邮件的信息可以在每个事件。</span><span class="sxs-lookup"><span data-stu-id="83711-195">Not all message information is available in each event.</span></span> <span data-ttu-id="83711-196">您必须确定哪个代理，最适合您想要完成的任务的事件。</span><span class="sxs-lookup"><span data-stu-id="83711-196">You must determine which agent and which event is best for the task you want to accomplish.</span></span> 
  
<span data-ttu-id="83711-197">以下命名空间包含可用于读取、 写入和修改传输管道中的邮件的类型：</span><span class="sxs-lookup"><span data-stu-id="83711-197">The following namespaces contain types that you can use to read, write, and modify messages in the transport pipeline:</span></span>
  
- [<span data-ttu-id="83711-198">Microsoft.Exchange.Data.Mime.Encoders</span><span class="sxs-lookup"><span data-stu-id="83711-198">Microsoft.Exchange.Data.Mime.Encoders</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.aspx)
    
- [<span data-ttu-id="83711-199">Microsoft.Exchange.Data.ContentTypes.iCalendar</span><span class="sxs-lookup"><span data-stu-id="83711-199">Microsoft.Exchange.Data.ContentTypes.iCalendar</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.aspx)
    
- [<span data-ttu-id="83711-200">Microsoft.Exchange.Data.Mime</span><span class="sxs-lookup"><span data-stu-id="83711-200">Microsoft.Exchange.Data.Mime</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.aspx)
    
- [<span data-ttu-id="83711-201">Microsoft.Exchange.Data.ContentTypes.Tnef</span><span class="sxs-lookup"><span data-stu-id="83711-201">Microsoft.Exchange.Data.ContentTypes.Tnef</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.aspx)
    
- [<span data-ttu-id="83711-202">Microsoft.Exchange.Data.ContentTypes.vCard</span><span class="sxs-lookup"><span data-stu-id="83711-202">Microsoft.Exchange.Data.ContentTypes.vCard</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.vCard.aspx)
    
<span data-ttu-id="83711-203">之后，您编写传输代理，您[安装和管理您的代理](http://technet.microsoft.com/en-us/library/bb125175%28v=exchg.150%29.aspx)使用 Exchange 命令行管理程序。</span><span class="sxs-lookup"><span data-stu-id="83711-203">After you write your transport agent, you [install and manage your agent](http://technet.microsoft.com/en-us/library/bb125175%28v=exchg.150%29.aspx) by using the Exchange Management Shell.</span></span> <span data-ttu-id="83711-204">有关详细信息，请参阅[Exchange 2013 创建传输代理](creating-transport-agents-for-exchange-2013.md)。</span><span class="sxs-lookup"><span data-stu-id="83711-204">For more information, see [Creating transport agents for Exchange 2013](creating-transport-agents-for-exchange-2013.md).</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="83711-205">另请参阅</span><span class="sxs-lookup"><span data-stu-id="83711-205">See also</span></span>

- [<span data-ttu-id="83711-206">在 Exchange 传输代理</span><span class="sxs-lookup"><span data-stu-id="83711-206">Transport agents in Exchange</span></span>](transport-agents-in-exchange-2013.md)    
- [<span data-ttu-id="83711-207">Exchange 2013 的传输代理引用</span><span class="sxs-lookup"><span data-stu-id="83711-207">Transport agent reference for Exchange 2013</span></span>](transport-agent-reference-for-exchange-2013.md)   
- [<span data-ttu-id="83711-208">读取和修改 Exchange 2013 传输管道中的邮件</span><span class="sxs-lookup"><span data-stu-id="83711-208">Reading and modifying messages in the Exchange 2013 transport pipeline</span></span>](reading-and-modifying-messages-in-the-exchange-2013-transport-pipeline.md)    
- [<span data-ttu-id="83711-209">What's New in Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="83711-209">What's New in Exchange 2013</span></span>](http://technet.microsoft.com/en-us/library/jj150540%28v=exchg.150%29.aspx)   
- [<span data-ttu-id="83711-210">Exchange 2013 服务器角色体系结构</span><span class="sxs-lookup"><span data-stu-id="83711-210">Exchange 2013 Server Role Architecture</span></span>](http://blogs.technet.com/b/exchange/archive/2013/01/23/exchange-2013-server-role-architecture.aspx)    
- [<span data-ttu-id="83711-211">邮箱和客户端访问服务器</span><span class="sxs-lookup"><span data-stu-id="83711-211">Mailbox and Client Access Servers</span></span>](http://technet.microsoft.com/en-us/library/jj150519%28v=exchg.150%29.aspx)   
- [<span data-ttu-id="83711-212">Exchange Server 2013 的邮件流</span><span class="sxs-lookup"><span data-stu-id="83711-212">Exchange Server 2013 Mail Flow</span></span>](http://technet.microsoft.com/en-us/library/aa996349.aspx)
- [<span data-ttu-id="83711-213">Exchange Server 2013 邮件路由</span><span class="sxs-lookup"><span data-stu-id="83711-213">Exchange Server 2013 Mail Routing</span></span>](http://technet.microsoft.com/en-us/library/aa998825%28v=exchg.150%29.aspx)   
- [<span data-ttu-id="83711-214">Exchange Server PowerShell （Exchange 命令行管理程序）</span><span class="sxs-lookup"><span data-stu-id="83711-214">Exchange Server PowerShell (Exchange Management Shell)</span></span>](https://docs.microsoft.com/en-us/powershell/exchange/exchange-server/exchange-management-shell?view=exchange-ps)
    

