---
title: 读取和修改 Exchange 2013 传输管道中的邮件
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: b53ed47a-3d01-4c4e-ad32-fb0532872aad
description: 了解可以在 Exchange 2013 传输代理中用于读取、写入和修改邮件的 .NET Framework 类。
ms.openlocfilehash: 42d9dc7f05dce495b7695a2862af244313caffcb
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/03/2020
ms.locfileid: "44527577"
---
# <a name="reading-and-modifying-messages-in-the-exchange-2013-transport-pipeline"></a><span data-ttu-id="06748-103">读取和修改 Exchange 2013 传输管道中的邮件</span><span class="sxs-lookup"><span data-stu-id="06748-103">Reading and modifying messages in the Exchange 2013 transport pipeline</span></span>

<span data-ttu-id="06748-104">了解可以在 Exchange 2013 传输代理中用于读取、写入和修改邮件的 .NET Framework 类。</span><span class="sxs-lookup"><span data-stu-id="06748-104">Learn about the .NET Framework classes you can use in your Exchange 2013 transport agents to read, write, and modify messages.</span></span>
  
<span data-ttu-id="06748-105">**适用于：** Exchange Server 2013</span><span class="sxs-lookup"><span data-stu-id="06748-105">**Applies to:** Exchange Server 2013</span></span>
  
- <span data-ttu-id="06748-106">用于读取、写入或修改邮件的类</span><span class="sxs-lookup"><span data-stu-id="06748-106">Classes used to read, write, or modify messages</span></span>
- <span data-ttu-id="06748-107">编码器命名空间</span><span class="sxs-lookup"><span data-stu-id="06748-107">Encoders namespace</span></span>
- <span data-ttu-id="06748-108">iCalendar 命名空间</span><span class="sxs-lookup"><span data-stu-id="06748-108">iCalendar namespace</span></span>
- <span data-ttu-id="06748-109">MIME 命名空间</span><span class="sxs-lookup"><span data-stu-id="06748-109">MIME namespace</span></span>
- <span data-ttu-id="06748-110">TextConverters 命名空间</span><span class="sxs-lookup"><span data-stu-id="06748-110">TextConverters namespace</span></span>
- <span data-ttu-id="06748-111">Tnef 命名空间</span><span class="sxs-lookup"><span data-stu-id="06748-111">Tnef namespace</span></span>
- <span data-ttu-id="06748-112">vCard 命名空间</span><span class="sxs-lookup"><span data-stu-id="06748-112">vCard namespace</span></span>
  
<span data-ttu-id="06748-113">当邮件通过传输管道传递时，传输代理可以在不同数据格式之间读取、写入和转换邮件内容。</span><span class="sxs-lookup"><span data-stu-id="06748-113">As messages pass through the transport pipeline, your transport agent can read, write, and convert message content between different data formats.</span></span> <span data-ttu-id="06748-114">例如，您可以读取和写入 MIME 数据，识别以 Uuencoded 或可标记为可打印（qp）格式的传入邮件，然后将其转换为组织使用的标准，或者读取并保存与传入邮件关联的日历或联系人信息。</span><span class="sxs-lookup"><span data-stu-id="06748-114">For example, you can read and write MIME data, identify incoming messages that are in Uuencoded or Quoted-printable (qp) format, and then convert them to a standard used by your organization, or read and then save calendar or contact information associated with incoming messages.</span></span> 
  
<span data-ttu-id="06748-115">您还可以确定会带来安全威胁的内容，并移动或删除内容或包含这些内容的邮件;例如，通过删除 HTML 邮件中的链接。</span><span class="sxs-lookup"><span data-stu-id="06748-115">You can also identify content that poses a security threat and move or delete the content or the messages that contain them; for example, by removing links in an HTML message.</span></span>
  
<span data-ttu-id="06748-116">本文提供了有关可用于读取、写入和修改邮件的 .NET Framework 类的信息。</span><span class="sxs-lookup"><span data-stu-id="06748-116">This article provides information about the .NET Framework classes that you can use to read, write, and modify messages.</span></span>
  
> [!CAUTION]
> <span data-ttu-id="06748-117">内容转换 Api 中的许多属性和参数都允许足够大的值来导致性能问题，包括拒绝服务。</span><span class="sxs-lookup"><span data-stu-id="06748-117">Many of the properties and parameters in the content conversion APIs allow values large enough to cause performance problems, including denial of service.</span></span> <span data-ttu-id="06748-118">在传输代理中使用内容转换 Api 时，应对在读取或写入时支持的属性和参数值大小实施限制，以便限制代理的资源消耗。</span><span class="sxs-lookup"><span data-stu-id="06748-118">When you use the content conversion APIs in a transport agent, you should implement limits on the property and parameter value sizes you support when reading or writing in order to limit resource consumption by your agent.</span></span> 

<span data-ttu-id="06748-119"><a name="Namespaces"> </a></span><span class="sxs-lookup"><span data-stu-id="06748-119"><a name="Namespaces"> </a></span></span>

## <a name="classes-used-to-read-write-or-modify-messages"></a><span data-ttu-id="06748-120">用于读取、写入或修改邮件的类</span><span class="sxs-lookup"><span data-stu-id="06748-120">Classes used to read, write, or modify messages</span></span>

<span data-ttu-id="06748-121">下表列出了可用于读取、写入和修改电子邮件的 .NET Framework 类。</span><span class="sxs-lookup"><span data-stu-id="06748-121">The following table lists the .NET Framework classes that you can use to read, write, and modify email messages.</span></span>
  
<span data-ttu-id="06748-122">**.NET Framework 邮件处理命名空间**</span><span class="sxs-lookup"><span data-stu-id="06748-122">**.NET Framework message processing namespaces**</span></span>

|<span data-ttu-id="06748-123">**.NET Framework 命名空间**</span><span class="sxs-lookup"><span data-stu-id="06748-123">**.NET Framework namespace**</span></span>|<span data-ttu-id="06748-124">**课程**</span><span class="sxs-lookup"><span data-stu-id="06748-124">**Classes**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="06748-125">（即，模拟编码器）</span><span class="sxs-lookup"><span data-stu-id="06748-125">Microsoft.Exchange.Data.Mime.Encoders</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.aspx) <br/> |<span data-ttu-id="06748-126">包含内存中的编码和解码的类、接受关联枚举中包含的一个编码器或解码器类的编码器流类，以及编码器和解码器的[ByteEncoder](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoder.aspx)基类和[ByteEncoderException](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoderException.aspx)异常类。</span><span class="sxs-lookup"><span data-stu-id="06748-126">Contains classes for in-memory encoding and decoding, an encoder stream class that accepts one of the encoder or decoder classes contained in an associated enumeration, and the [ByteEncoder](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoder.aspx) base class and [ByteEncoderException](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoderException.aspx) exception class for the encoders and decoders.</span></span>  <br/> |
|[<span data-ttu-id="06748-127">ContentTypes 的数据。</span><span class="sxs-lookup"><span data-stu-id="06748-127">Microsoft.Exchange.Data.ContentTypes.iCalendar</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.aspx) <br/> |<span data-ttu-id="06748-128">包含使您能够读取和写入包含日历信息的数据流的类型。</span><span class="sxs-lookup"><span data-stu-id="06748-128">Contains types that enable you to read and write data streams that contain calendar information.</span></span> <span data-ttu-id="06748-129">包括一个日历读取器和编写器、一个异常对象、一个重复的对象，以及可帮助您返回有关日历项目的属性信息的结构和枚举。</span><span class="sxs-lookup"><span data-stu-id="06748-129">Includes a calendar reader and writer, an exception object, a recurrence object, and structures and enumerations that help you return property information about calendar items.</span></span>  <br/> |
|[<span data-ttu-id="06748-130">Microsoft. 数据 Mime</span><span class="sxs-lookup"><span data-stu-id="06748-130">Microsoft.Exchange.Data.Mime</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.aspx) <br/> |<span data-ttu-id="06748-131">包含可用于创建、读取、写入、遍历、编码和解码 MIME 数据的类、结构、枚举和委托。</span><span class="sxs-lookup"><span data-stu-id="06748-131">Contains classes, structures, enumerations, and delegates that you can use to create, read, write, traverse, encode, and decode MIME data.</span></span> <span data-ttu-id="06748-132">包含一个基于流的读取器和编写器，可提供对 MIME 数据流的仅向前读写访问权限，以及可以在 MIME 文档中使用的基于 DOM 的方法和类。</span><span class="sxs-lookup"><span data-stu-id="06748-132">Includes a stream-based reader and writer that gives you forward-only read and write access to MIME data streams, as well as DOM-based methods and classes you can use on MIME documents.</span></span>  <br/> |
|[<span data-ttu-id="06748-133">Microsoft TextConverters</span><span class="sxs-lookup"><span data-stu-id="06748-133">Microsoft.Exchange.Data.TextConverters</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.aspx) <br/> |<span data-ttu-id="06748-134">包含允许您读取和写入数据流并在特定数据类型之间执行转换的类、结构、枚举和委托;例如，HTML 到 Rtf 格式。</span><span class="sxs-lookup"><span data-stu-id="06748-134">Contains classes, structures, enumerations, and delegates that allow you to read and write a data stream and perform conversions between specific data types; for example, HTML to Rich Text Format (RTF).</span></span> <span data-ttu-id="06748-135">文本转换器使您能够将文档流的格式从一个表单更改为另一个表单，还可以有选择地删除可能带来安全风险的文档的元素。</span><span class="sxs-lookup"><span data-stu-id="06748-135">Text converters enable you to change the format of a document stream from one form to another as well as selectively remove elements of a document that might pose a security risk.</span></span>  <br/> |
|[<span data-ttu-id="06748-136">"ContentTypes"。</span><span class="sxs-lookup"><span data-stu-id="06748-136">Microsoft.Exchange.Data.ContentTypes.Tnef</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.aspx) <br/> |<span data-ttu-id="06748-137">包含仅向前流读取器和编写器、异常类以及有助于读取和写入传输中性封装格式（TNEF）数据的结构和枚举。</span><span class="sxs-lookup"><span data-stu-id="06748-137">Contains a forward-only stream reader and writer, an exception class, and structures and enumerations that facilitate reading and writing Transport Neutral Encapsulation Format (TNEF) data.</span></span>  <br/> |
|[<span data-ttu-id="06748-138">ContentTypes 的电子名片</span><span class="sxs-lookup"><span data-stu-id="06748-138">Microsoft.Exchange.Data.ContentTypes.vCard</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.vCard.aspx) <br/> |<span data-ttu-id="06748-139">包含仅向前流读取器和编写器、异常类以及便于读取和写入电子名片格式的联系人数据的结构和枚举。</span><span class="sxs-lookup"><span data-stu-id="06748-139">Contains a forward-only stream reader and writer, an exception class, and structures and enumerations that facilitate reading and writing vCard-formatted contact data.</span></span>  <br/> |
   
## <a name="encoders-namespace"></a><span data-ttu-id="06748-140">编码器命名空间</span><span class="sxs-lookup"><span data-stu-id="06748-140">Encoders namespace</span></span>
<span data-ttu-id="06748-141"><a name="Encoders"> </a></span><span class="sxs-lookup"><span data-stu-id="06748-141"><a name="Encoders"> </a></span></span>

<span data-ttu-id="06748-142">编码器命名空间包含内存中的编码和解码的类。</span><span class="sxs-lookup"><span data-stu-id="06748-142">The Encoders namespace contains classes for in-memory encoding and decoding.</span></span> <span data-ttu-id="06748-143">这些类型继承自[ByteEncoder](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoder.aspx)基类。</span><span class="sxs-lookup"><span data-stu-id="06748-143">These inherit from the [ByteEncoder](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoder.aspx) base class.</span></span> <span data-ttu-id="06748-144">对 Base64、BinHex、带引号的可打印（qp）和 Unix 到 Unix （Uu）的类进行编码和解码。</span><span class="sxs-lookup"><span data-stu-id="06748-144">Classes encode and decode for Base64, BinHex, Quoted-printable (qp), and Unix-to-Unix (Uu).</span></span> <span data-ttu-id="06748-145">以下类用于内存中的编码和解码：</span><span class="sxs-lookup"><span data-stu-id="06748-145">The following classes are used for in-memory encoding and decoding:</span></span> 
  
- [<span data-ttu-id="06748-146">Base64Encoder</span><span class="sxs-lookup"><span data-stu-id="06748-146">Base64Encoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.Base64Encoder.aspx)
    
- [<span data-ttu-id="06748-147">Base64Decoder</span><span class="sxs-lookup"><span data-stu-id="06748-147">Base64Decoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.Base64Decoder.aspx)
    
- [<span data-ttu-id="06748-148">BinHexEncoder</span><span class="sxs-lookup"><span data-stu-id="06748-148">BinHexEncoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.BinHexEncoder.aspx)
    
- [<span data-ttu-id="06748-149">BinHexDecoder</span><span class="sxs-lookup"><span data-stu-id="06748-149">BinHexDecoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.BinHexDecoder.aspx)
    
- [<span data-ttu-id="06748-150">QPEncoder</span><span class="sxs-lookup"><span data-stu-id="06748-150">QPEncoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.QPEncoder.aspx)
    
- [<span data-ttu-id="06748-151">QPDecoder</span><span class="sxs-lookup"><span data-stu-id="06748-151">QPDecoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.QPDecoder.aspx)
    
- [<span data-ttu-id="06748-152">UUEncoder</span><span class="sxs-lookup"><span data-stu-id="06748-152">UUEncoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.UUEncoder.aspx)
    
- [<span data-ttu-id="06748-153">UUDecoder</span><span class="sxs-lookup"><span data-stu-id="06748-153">UUDecoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.UUDecoder.aspx)
    
<span data-ttu-id="06748-154">编码器和解码器继承自[ByteEncoder](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoder.aspx)基类，并使用[ByteEncoderException](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoderException.aspx)异常类进行错误处理。</span><span class="sxs-lookup"><span data-stu-id="06748-154">The encoders and decoders inherit from the [ByteEncoder](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoder.aspx) base class and use the [ByteEncoderException](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoderException.aspx) exception class for error handling.</span></span> 
  
<span data-ttu-id="06748-155">此外，命名空间还包含[MacBinaryHeader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.MacBinaryHeader.aspx)类，它标识 MacBinary 编码文件并读取其关联的文件头。</span><span class="sxs-lookup"><span data-stu-id="06748-155">Additionally, the namespace contains the [MacBinaryHeader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.MacBinaryHeader.aspx) class, which identifies MacBinary encoded files and reads their associated file header.</span></span> 
  
<span data-ttu-id="06748-156">最后， [EncoderStream](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.EncoderStream.aspx)类对数据流（而不是内存中的对象）执行转换。</span><span class="sxs-lookup"><span data-stu-id="06748-156">Finally, the [EncoderStream](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.EncoderStream.aspx) class performs a conversion on a data stream instead of an in-memory object.</span></span> <span data-ttu-id="06748-157">此类接受一个编码器或解码器类，并根据关联的[EncoderStreamAccess](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.EncoderStreamAccess.aspx)枚举进行读取或写入。</span><span class="sxs-lookup"><span data-stu-id="06748-157">This class accepts one of the encoder or decoder classes and either reads or writes according to the associated [EncoderStreamAccess](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.EncoderStreamAccess.aspx) enumeration.</span></span> 
  
## <a name="icalendar-namespace"></a><span data-ttu-id="06748-158">iCalendar 命名空间</span><span class="sxs-lookup"><span data-stu-id="06748-158">iCalendar namespace</span></span>
<span data-ttu-id="06748-159"><a name="iCalendar"> </a></span><span class="sxs-lookup"><span data-stu-id="06748-159"><a name="iCalendar"> </a></span></span>

<span data-ttu-id="06748-160">ICalendar 命名空间提供仅向前读取器和写入程序的 iCalendar 数据，以及用于创建、访问和修改 iCalendar 流的支持结构和类。</span><span class="sxs-lookup"><span data-stu-id="06748-160">The iCalendar namespace provides a forward-only reader and writer for iCalendar data, in addition to supporting structures and classes for creating, accessing, and modifying iCalendar streams.</span></span>
  
<span data-ttu-id="06748-161">[CalendarReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.aspx)和[CalendarWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarWriter.aspx)类用于读取和写入 iCalendar 流数据。</span><span class="sxs-lookup"><span data-stu-id="06748-161">The [CalendarReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.aspx) and [CalendarWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarWriter.aspx) classes are used to read and write iCalendar stream data.</span></span> 
  
<span data-ttu-id="06748-162">CalendarReader 采用可读[流](https://msdn.microsoft.com/library/System.IO.Stream.aspx)作为其构造函数的参数。</span><span class="sxs-lookup"><span data-stu-id="06748-162">The CalendarReader takes a readable [Stream](https://msdn.microsoft.com/library/System.IO.Stream.aspx) as an argument to its constructors.</span></span> <span data-ttu-id="06748-163">然后，可以使用[ReadFirstChildComponent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ReadFirstChildComponent.aspx)、 [ReadNextSiblingComponent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ReadNextSiblingComponent.aspx)和[ReadNextComponent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ReadNextComponent.aspx)方法按顺序访问数据流中的 iCalendar 组件。</span><span class="sxs-lookup"><span data-stu-id="06748-163">You can then use the [ReadFirstChildComponent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ReadFirstChildComponent.aspx), [ReadNextSiblingComponent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ReadNextSiblingComponent.aspx), and [ReadNextComponent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ReadNextComponent.aspx) methods to sequentially access the iCalendar components in the data stream.</span></span> <span data-ttu-id="06748-164">根据您为[ComplianceMode](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ComplianceMode.aspx)属性设置的值，iCalendar 流中的错误将导致引发异常，或者将导致[ComplianceStatus](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ComplianceStatus.aspx)属性设置为非[兼容](https://msdn.microsoft.com/library/microsoft.exchange.data.contenttypes.icalendar.calendarcompliancestatus.aspx)的值。</span><span class="sxs-lookup"><span data-stu-id="06748-164">Based on the value that you have set for the [ComplianceMode](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ComplianceMode.aspx) property, errors in the iCalendar stream will cause an exception to be thrown or will cause the [ComplianceStatus](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ComplianceStatus.aspx) property to be set to a value other than [Compliant](https://msdn.microsoft.com/library/microsoft.exchange.data.contenttypes.icalendar.calendarcompliancestatus.aspx).</span></span> <span data-ttu-id="06748-165">您可以检查此属性以发现传入 iCalendar 数据存在的任何问题。</span><span class="sxs-lookup"><span data-stu-id="06748-165">You can check this property to discover any issues with incoming iCalendar data.</span></span> 
  
<span data-ttu-id="06748-166">[CalendarWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarWriter.aspx)类采用可写[流](https://msdn.microsoft.com/library/System.IO.Stream.aspx)作为其构造函数的参数。</span><span class="sxs-lookup"><span data-stu-id="06748-166">The [CalendarWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarWriter.aspx) class takes a writable [Stream](https://msdn.microsoft.com/library/System.IO.Stream.aspx) as an argument to its constructors.</span></span> 
  
## <a name="mime-namespace"></a><span data-ttu-id="06748-167">MIME 命名空间</span><span class="sxs-lookup"><span data-stu-id="06748-167">MIME namespace</span></span>
<span data-ttu-id="06748-168"><a name="MIME"> </a></span><span class="sxs-lookup"><span data-stu-id="06748-168"><a name="MIME"> </a></span></span>

<span data-ttu-id="06748-169">MIME 命名空间提供了使您能够创建、访问和修改 MIME 文档的类。</span><span class="sxs-lookup"><span data-stu-id="06748-169">The MIME namespace provides classes that enable you to create, access, and modify MIME documents.</span></span> <span data-ttu-id="06748-170">您可以通过使用基于流的方法或基于 DOM 的方法来处理 MIME 文档。</span><span class="sxs-lookup"><span data-stu-id="06748-170">You can work with MIME documents by using either a stream-based or DOM-based method.</span></span>
  
### <a name="mimedocument-class-and-the-mime-dom"></a><span data-ttu-id="06748-171">MimeDocument 类和 MIME DOM</span><span class="sxs-lookup"><span data-stu-id="06748-171">MimeDocument class and the MIME DOM</span></span>

<span data-ttu-id="06748-172">[MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx)类启用对 MIME 文档的 DOM 访问。</span><span class="sxs-lookup"><span data-stu-id="06748-172">The [MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx) class enables DOM access to a MIME document.</span></span> <span data-ttu-id="06748-173">当您具有加载整个 DOM 的可用内存，并且您必须对邮件的头和内容具有随机访问权限时，请使用此类型的对象。</span><span class="sxs-lookup"><span data-stu-id="06748-173">Use objects of this type when you have the available memory to load a whole DOM and you must have random access to the headers and content of the message.</span></span> 
  
<span data-ttu-id="06748-174">您可以使用[GetLoadStream](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.GetLoadStream.aspx)或[load](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.Load.aspx)方法将数据加载到[MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx)对象中。</span><span class="sxs-lookup"><span data-stu-id="06748-174">You load data into a [MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx) object by using the [GetLoadStream](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.GetLoadStream.aspx) or [Load](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.Load.aspx) methods.</span></span> <span data-ttu-id="06748-175">然后，您可以浏览 DOM 层次结构，并创建、修改或删除 MIME 数据。</span><span class="sxs-lookup"><span data-stu-id="06748-175">You can then walk the DOM hierarchy and create, modify, or remove MIME data.</span></span> <span data-ttu-id="06748-176">修改 MIME 数据之后，可以使用[WriteTo](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeNode.WriteTo.aspx)方法之一将其写入 stream。</span><span class="sxs-lookup"><span data-stu-id="06748-176">After you have modified the MIME data, you can write it to a stream by using one of the [WriteTo](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeNode.WriteTo.aspx) methods.</span></span> 
  
<span data-ttu-id="06748-177">下图显示了[MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx)对象中的数据的结构。</span><span class="sxs-lookup"><span data-stu-id="06748-177">The following figure shows the structure of data within a [MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx) object.</span></span> 
  
<span data-ttu-id="06748-178">**图1。MimeDocument 对象的结构**</span><span class="sxs-lookup"><span data-stu-id="06748-178">**Figure 1. Structure of MimeDocument objects**</span></span>

![MIME DOM 体系结构](media/MimeDomArchitecture.gif)
  
### <a name="mimereader-and-mimewriter-classes-and-stream-based-mime-parsing"></a><span data-ttu-id="06748-180">MimeReader 和 MimeWriter 类以及基于流的 MIME 分析</span><span class="sxs-lookup"><span data-stu-id="06748-180">MimeReader and MimeWriter classes and stream-based MIME parsing</span></span>

<span data-ttu-id="06748-181">[MimeReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.aspx)和[MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx)类启用对 MIME 流的仅向前访问。</span><span class="sxs-lookup"><span data-stu-id="06748-181">The [MimeReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.aspx) and [MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx) classes enable forward-only access to MIME streams.</span></span> <span data-ttu-id="06748-182">当您无需更改需要已读或写数据的 MIME 数据时，请使用这些类。</span><span class="sxs-lookup"><span data-stu-id="06748-182">Use these classes when you do not have to change the MIME data that requires data that has already been read or written.</span></span> <span data-ttu-id="06748-183">例如，如果要打印适合预定义格式的邮件，则[MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx)类可能是理想的。</span><span class="sxs-lookup"><span data-stu-id="06748-183">For example, if you want to print messages that fit a predefined format, the [MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx) class might be ideal.</span></span> 
  
<span data-ttu-id="06748-184">[MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx)类封装 DOM。</span><span class="sxs-lookup"><span data-stu-id="06748-184">The [MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx) class encapsulates a DOM.</span></span> <span data-ttu-id="06748-185">[MimeReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.aspx)和[MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx)类表示状态计算机。</span><span class="sxs-lookup"><span data-stu-id="06748-185">The [MimeReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.aspx) and [MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx) classes represent state computers.</span></span> <span data-ttu-id="06748-186">它们的状态根据接收的输入和调用的方法而变化。</span><span class="sxs-lookup"><span data-stu-id="06748-186">Their states change based on the input received and the methods called.</span></span> <span data-ttu-id="06748-187">图2至步骤5是简化的状态转换图表，为[MimeReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.aspx)对象显示了有效的方法，可以从每个状态中调用，以及将产生的状态。</span><span class="sxs-lookup"><span data-stu-id="06748-187">Figures 2 through 5 are simplified state transition diagrams that show, for the [MimeReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.aspx) object, which methods are valid to call from each state and the state that will result.</span></span> 
  
<span data-ttu-id="06748-188">若要使用这些关系图，请从一个状态到下一个状态的箭头，注意方法调用或返回导致状态更改的值。</span><span class="sxs-lookup"><span data-stu-id="06748-188">To use these diagrams, follow the arrows from one state to the next, noting the method calls or return values that cause the state to change.</span></span> <span data-ttu-id="06748-189">例如，在第一个图表中，假定您位于属于您创建的 MimeReader 的流的开头。</span><span class="sxs-lookup"><span data-stu-id="06748-189">For example, in the first diagram, assume that you are at the start of the stream that belongs to the MimeReader that you have created.</span></span> <span data-ttu-id="06748-190">若要获取部件标头状态，请按该顺序调用[ReadNextPart](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.ReadNextPart.aspx)或[ReadFirstChildPart](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.ReadFirstChildPart.aspx)之一。</span><span class="sxs-lookup"><span data-stu-id="06748-190">To get to the Part Headers state, call one of [ReadNextPart](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.ReadNextPart.aspx) or [ReadFirstChildPart](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.ReadFirstChildPart.aspx), in that order.</span></span> <span data-ttu-id="06748-191">如果有标头（即 MIME 的格式是否正确），您将进入部件标头状态。</span><span class="sxs-lookup"><span data-stu-id="06748-191">If there are headers (that is, if the MIME is well-formed), you will enter into the Part Headers state.</span></span> <span data-ttu-id="06748-192">否则，将引发异常。</span><span class="sxs-lookup"><span data-stu-id="06748-192">Otherwise, an exception will be thrown.</span></span> 
  
<span data-ttu-id="06748-193">**图2。MimeReader 对象的简化状态转换关系图**</span><span class="sxs-lookup"><span data-stu-id="06748-193">**Figure 2. Simplified state transition diagram for MimeReader objects**</span></span>

![MimeReader 状态图表](media/MimeReader_StateDiagram_01.gif)
  
> [!NOTE]
> <span data-ttu-id="06748-195">图3、4和5扩展了上述每个图表中显示的状态。</span><span class="sxs-lookup"><span data-stu-id="06748-195">Figures 3, 4, and 5 expand on states shown in each of the previous diagrams.</span></span> 
  
<span data-ttu-id="06748-196">**图3。从图2扩展部件标头状态**</span><span class="sxs-lookup"><span data-stu-id="06748-196">**Figure 3. Expansion of Part Headers state from Figure 2**</span></span>

![“部件标题”状态扩展](media/MimeReader_StateDiagram_02.gif)
  
<span data-ttu-id="06748-198">**图4。在标头中遇到参数时从图3扩展了标头状态**</span><span class="sxs-lookup"><span data-stu-id="06748-198">**Figure 4. Expansion of Header state from Figure 3 when a parameter has been encountered in a header**</span></span>

![“部件标题”状态扩展](media/MimeReader_StateDiagram_03.gif)
  
> [!NOTE]
> <span data-ttu-id="06748-200">图5表示的状态是递归的，如果遇到地址组，则可以使用[GroupRecipientReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeAddressReader.GroupRecipientReader.aspx)属性读取组中的地址。</span><span class="sxs-lookup"><span data-stu-id="06748-200">The state represented by Figure 5 is recursive in that, if an address group is encountered, you can use the [GroupRecipientReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeAddressReader.GroupRecipientReader.aspx) property to read the addresses in the group.</span></span> 
  
<span data-ttu-id="06748-201">**图5。遇到地址或地址组时，从图3扩展标头状态**</span><span class="sxs-lookup"><span data-stu-id="06748-201">**Figure 5. Expansion of Header state from Figure 3 when an address or address group is encountered**</span></span>

![用于地址或组的“标题”状态扩展](media/MimeReader_StateDiagram_04.gif)
  
<span data-ttu-id="06748-203">图6和7显示了[MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx)对象的简化状态转换图表。</span><span class="sxs-lookup"><span data-stu-id="06748-203">Figures 6 and 7 show simplified state transition diagrams for the [MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx) object.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="06748-204">图7针对图6中所示的部件标题状态展开。</span><span class="sxs-lookup"><span data-stu-id="06748-204">Figure 7 expands on the Part Headers state shown in Figure 6.</span></span> 
  
<span data-ttu-id="06748-205">**图6。MimeWriter 对象的简化状态转换关系图**</span><span class="sxs-lookup"><span data-stu-id="06748-205">**Figure 6. Simplified state transition diagram for MimeWriter objects**</span></span>

![用于 MimeWriter 的状态切换图表](media/MimeWriter_TopLevel.gif)
  
<span data-ttu-id="06748-207">**图7。从图6扩展部件标头状态**</span><span class="sxs-lookup"><span data-stu-id="06748-207">**Figure 7. Expansion of Part Headers state from Figure 6**</span></span>

![用于 MimeWriter 的状态切换图表扩展](media/MimeWriter_Diagram_Expansion.gif)
  
## <a name="textconverters-namespace"></a><span data-ttu-id="06748-209">TextConverters 命名空间</span><span class="sxs-lookup"><span data-stu-id="06748-209">TextConverters namespace</span></span>
<span data-ttu-id="06748-210"><a name="TextConverters"> </a></span><span class="sxs-lookup"><span data-stu-id="06748-210"><a name="TextConverters"> </a></span></span>

<span data-ttu-id="06748-211">TextConverters 命名空间包含支持电子邮件内容转换的类型。</span><span class="sxs-lookup"><span data-stu-id="06748-211">The TextConverters namespace contains types that support the conversion of the contents of email messages.</span></span> <span data-ttu-id="06748-212">这些类型可以执行代码页转换，删除不安全的 HTML，并对电子邮件正文执行其他转换。</span><span class="sxs-lookup"><span data-stu-id="06748-212">These types can perform code page conversion, remove HTML that is not secure, and perform other transformations on email message bodies.</span></span> <span data-ttu-id="06748-213">[TextConverters](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.aspx)命名空间包括从[TextConverter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.TextConverter.aspx)抽象类派生的以下类：</span><span class="sxs-lookup"><span data-stu-id="06748-213">The [Microsoft.Exchange.Data.TextConverters](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.aspx) namespace includes the following classes that derive from the [TextConverter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.TextConverter.aspx) abstract class:</span></span> 
  
- [<span data-ttu-id="06748-214">EnrichedToHtml</span><span class="sxs-lookup"><span data-stu-id="06748-214">EnrichedToHtml</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.EnrichedToHtml.aspx)
    
- [<span data-ttu-id="06748-215">EnrichedToText</span><span class="sxs-lookup"><span data-stu-id="06748-215">EnrichedToText</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.EnrichedToText.aspx)
    
- [<span data-ttu-id="06748-216">HtmlToEnriched</span><span class="sxs-lookup"><span data-stu-id="06748-216">HtmlToEnriched</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.HtmlToEnriched.aspx)
    
- [<span data-ttu-id="06748-217">HtmlToHtml</span><span class="sxs-lookup"><span data-stu-id="06748-217">HtmlToHtml</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.HtmlToHtml.aspx)
    
- [<span data-ttu-id="06748-218">HtmlToRtf</span><span class="sxs-lookup"><span data-stu-id="06748-218">HtmlToRtf</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.HtmlToRtf.aspx)
    
- [<span data-ttu-id="06748-219">HtmlToText</span><span class="sxs-lookup"><span data-stu-id="06748-219">HtmlToText</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.HtmlToText.aspx)
    
- [<span data-ttu-id="06748-220">RtfCompressedToRtf</span><span class="sxs-lookup"><span data-stu-id="06748-220">RtfCompressedToRtf</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.RtfCompressedToRtf.aspx)
    
- [<span data-ttu-id="06748-221">RtfToHtml</span><span class="sxs-lookup"><span data-stu-id="06748-221">RtfToHtml</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.RtfToHtml.aspx)
    
- [<span data-ttu-id="06748-222">RtfToRtf</span><span class="sxs-lookup"><span data-stu-id="06748-222">RtfToRtf</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.RtfToRtf.aspx)
    
- [<span data-ttu-id="06748-223">RtfToRtfCompressed</span><span class="sxs-lookup"><span data-stu-id="06748-223">RtfToRtfCompressed</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.RtfToRtfCompressed.aspx)
    
- [<span data-ttu-id="06748-224">RtfToText</span><span class="sxs-lookup"><span data-stu-id="06748-224">RtfToText</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.RtfToText.aspx)
    
- [<span data-ttu-id="06748-225">TextToHtml</span><span class="sxs-lookup"><span data-stu-id="06748-225">TextToHtml</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.TextToHtml.aspx)
    
- [<span data-ttu-id="06748-226">TextToRtf</span><span class="sxs-lookup"><span data-stu-id="06748-226">TextToRtf</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.TextToRtf.aspx)
    
- [<span data-ttu-id="06748-227">TextToText</span><span class="sxs-lookup"><span data-stu-id="06748-227">TextToText</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.TextToText.aspx)
    
<span data-ttu-id="06748-228">利用这些文本转换器，可以更改文档流的格式，或从 HTML 文档中删除不安全的元素。</span><span class="sxs-lookup"><span data-stu-id="06748-228">These text converters enable you to change the format of a document stream or to remove elements that are not secure from an HTML document.</span></span> <span data-ttu-id="06748-229">这些类本身可用于执行转换，方法是对[TextConverter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.TextConverter.aspx)基类中的任一转换方法执行一次调用，也可以将其传递给转换器的构造函数，以使用它执行转换的读取或写入。</span><span class="sxs-lookup"><span data-stu-id="06748-229">These classes can be used by themselves to perform a conversion by using a single call to one of the Convert methods in the [TextConverter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.TextConverter.aspx) base class, or they can be passed to a constructor of the converter, which uses it to perform converted reads or writes.</span></span> 
  
<span data-ttu-id="06748-230">当您有足够的空间来存储原始文档及其转换输出时，或者当您要存储转换结果时，从基类继承的功能非常有用。</span><span class="sxs-lookup"><span data-stu-id="06748-230">The functionality inherited from the base class is useful for performing conversions when you have sufficient space to store the original document and its converted output, or when you want to store the results of the conversion.</span></span> <span data-ttu-id="06748-231">**Convert**方法采用输入和输出流、文本读取器或文本编写器，并将输入内容转换为相关联的输出。</span><span class="sxs-lookup"><span data-stu-id="06748-231">The **Convert** method takes input and output streams, text readers, or text writers, and converts the content of the input to the associated output.</span></span> 
  
<span data-ttu-id="06748-232">命名空间中还包含以下文本读取器、编写器和 stream 类：</span><span class="sxs-lookup"><span data-stu-id="06748-232">Also included in the namespace are the following text reader, writer, and stream classes:</span></span>
  
- <span data-ttu-id="06748-233">[ConverterReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.ConverterReader.aspx) —派生自**TextReader**。</span><span class="sxs-lookup"><span data-stu-id="06748-233">[ConverterReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.ConverterReader.aspx) — Derived from **System.IO.TextReader**.</span></span> 
    
- <span data-ttu-id="06748-234">[ConverterWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.ConverterWriter.aspx) —派生自**system.object**。</span><span class="sxs-lookup"><span data-stu-id="06748-234">[ConverterWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.ConverterWriter.aspx) — Derived from **System.IO.TextWriter**.</span></span> 
    
- <span data-ttu-id="06748-235">[ConverterStream](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.ConverterStream.aspx) —从**system.object**派生。</span><span class="sxs-lookup"><span data-stu-id="06748-235">[ConverterStream](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.ConverterStream.aspx) — Derived from **System.IO.Stream**.</span></span> 
    
<span data-ttu-id="06748-236">当您在从流中接收输入信息或将输出发送到流时，或者当您希望输出仅用于索引或搜索时，或者不希望存储转换结果时，可以使用这些文件执行转换（如果没有空间存储原始或转换的输出）。</span><span class="sxs-lookup"><span data-stu-id="06748-236">These are used to perform conversions when you do not have room to store the original or its converted output, when you receive the input from or send the output to a stream, or when you want the output only for indexing or search purposes and therefore do not want to store the result of a conversion.</span></span>
  
## <a name="tnef-namespace"></a><span data-ttu-id="06748-237">Tnef 命名空间</span><span class="sxs-lookup"><span data-stu-id="06748-237">Tnef namespace</span></span>
<span data-ttu-id="06748-238"><a name="TNEF"> </a></span><span class="sxs-lookup"><span data-stu-id="06748-238"><a name="TNEF"> </a></span></span>

<span data-ttu-id="06748-239">Tnef 命名空间包含的类和类型可启用仅向前流的 TNEF 数据的读取和写入。</span><span class="sxs-lookup"><span data-stu-id="06748-239">The Tnef namespace contains classes and types that enable forward-only stream-based reading and writing of TNEF data.</span></span> <span data-ttu-id="06748-240">TNEF 是一种数据格式，用于封装无法解释 MAPI 的客户端的 MAPI 属性。</span><span class="sxs-lookup"><span data-stu-id="06748-240">TNEF is a data format that is used to encapsulate MAPI properties for clients that cannot interpret MAPI.</span></span>
  
<span data-ttu-id="06748-241">[TnefReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.aspx)和[TnefWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefWriter.aspx)类提供[ContentTypes](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.aspx)命名空间中的核心功能。</span><span class="sxs-lookup"><span data-stu-id="06748-241">The [TnefReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.aspx) and [TnefWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefWriter.aspx) classes provide the core functionality in the [Microsoft.Exchange.Data.ContentTypes.Tnef](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.aspx) namespace.</span></span> 
  
<span data-ttu-id="06748-242">[TnefReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.aspx)类采用可读流作为其构造函数的参数。</span><span class="sxs-lookup"><span data-stu-id="06748-242">The [TnefReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.aspx) class takes a readable stream as an argument to its constructors.</span></span> <span data-ttu-id="06748-243">然后，使用[ReadNextAttribute](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.ReadNextAttribute.aspx)方法按顺序读取 TNEF 流中的属性。</span><span class="sxs-lookup"><span data-stu-id="06748-243">You then use the [ReadNextAttribute](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.ReadNextAttribute.aspx) method to sequentially read the attributes in the TNEF stream.</span></span> <span data-ttu-id="06748-244">读取属性后，除了获取[TnefPropertyReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefPropertyReader.aspx)以读取当前属性之外，还可以使用[TnefReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.aspx)对象上的任意只读属性访问有关该属性的信息。</span><span class="sxs-lookup"><span data-stu-id="06748-244">After you have read an attribute, you can access information about the attribute by using any of the read-only properties on the [TnefReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.aspx) object, in addition to getting a [TnefPropertyReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefPropertyReader.aspx) to read the current property.</span></span> <span data-ttu-id="06748-245">您还可以使用[ReadAttributeRawValue](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.ReadAttributeRawValue.aspx)方法直接访问当前属性。</span><span class="sxs-lookup"><span data-stu-id="06748-245">You can also directly access the current attribute by using the [ReadAttributeRawValue](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.ReadAttributeRawValue.aspx) method.</span></span> 
  
<span data-ttu-id="06748-246">[TnefWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefWriter.aspx)类采用可写[流](https://msdn.microsoft.com/library/System.IO.Stream.aspx)作为其构造函数的参数。</span><span class="sxs-lookup"><span data-stu-id="06748-246">The [TnefWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefWriter.aspx) class takes a writable [Stream](https://msdn.microsoft.com/library/System.IO.Stream.aspx) as an argument to its constructors.</span></span> <span data-ttu-id="06748-247">[TnefWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefWriter.aspx)类提供了多种向此流中写入数据的方法。</span><span class="sxs-lookup"><span data-stu-id="06748-247">The [TnefWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefWriter.aspx) class provides multiple ways in which to write data to this stream.</span></span> 
  
## <a name="vcard-namespace"></a><span data-ttu-id="06748-248">vCard 命名空间</span><span class="sxs-lookup"><span data-stu-id="06748-248">vCard namespace</span></span>
<span data-ttu-id="06748-249"><a name="vCard"> </a></span><span class="sxs-lookup"><span data-stu-id="06748-249"><a name="vCard"> </a></span></span>

<span data-ttu-id="06748-250">VCard 命名空间包含用于读取和写入电子邮件中包含在 vCard 数据格式中的联系人信息的类、结构和枚举。</span><span class="sxs-lookup"><span data-stu-id="06748-250">The vCard namespace contains classes, structures, and enumerations used to read and write contact information contained in an email message that is in the vCard data format.</span></span> <span data-ttu-id="06748-251">命名空间包含联系人读取器和编写器、异常类、属性读取器、参数读取器以及支持的枚举，使您能够读取与电子邮件关联的 vCard 数据。</span><span class="sxs-lookup"><span data-stu-id="06748-251">The namespace contains a contact reader and writer, an exception class, a property reader, a parameter reader, and supporting enumerations that allow you to read vCard data associated with an email message.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="06748-252">另请参阅</span><span class="sxs-lookup"><span data-stu-id="06748-252">See also</span></span>

- [<span data-ttu-id="06748-253">Exchange 中的传输代理</span><span class="sxs-lookup"><span data-stu-id="06748-253">Transport agents in Exchange</span></span>](transport-agents-in-exchange-2013.md)  
- [<span data-ttu-id="06748-254">Exchange 2013 中的传输代理概念</span><span class="sxs-lookup"><span data-stu-id="06748-254">Transport agent concepts in Exchange 2013</span></span>](transport-agent-concepts-in-exchange-2013.md) 
- [<span data-ttu-id="06748-255">Exchange 2013 的传输代理参考</span><span class="sxs-lookup"><span data-stu-id="06748-255">Transport agent reference for Exchange 2013</span></span>](transport-agent-reference-for-exchange-2013.md)
- [<span data-ttu-id="06748-256">MIME 媒体类型</span><span class="sxs-lookup"><span data-stu-id="06748-256">MIME Media Types</span></span>](http://www.iana.org/assignments/media-types)
    

