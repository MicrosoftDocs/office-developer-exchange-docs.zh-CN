---
title: 读取和修改 Exchange 2013 传输管道中的邮件
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: b53ed47a-3d01-4c4e-ad32-fb0532872aad
description: 了解可用于在 Exchange 2013 传输代理读取、 写入和修改邮件的.NET Framework 类。
ms.openlocfilehash: a39d6ecaeb837ce2760d762107e78aa8d4f09f7c
ms.sourcegitcommit: 9061fcf40c218ebe88911783f357b7df278846db
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/28/2018
ms.locfileid: "21354006"
---
# <a name="reading-and-modifying-messages-in-the-exchange-2013-transport-pipeline"></a><span data-ttu-id="3e0f1-103">读取和修改 Exchange 2013 传输管道中的邮件</span><span class="sxs-lookup"><span data-stu-id="3e0f1-103">Reading and modifying messages in the Exchange 2013 transport pipeline</span></span>

<span data-ttu-id="3e0f1-104">了解可用于在 Exchange 2013 传输代理读取、 写入和修改邮件的.NET Framework 类。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-104">Learn about the .NET Framework classes you can use in your Exchange 2013 transport agents to read, write, and modify messages.</span></span>
  
<span data-ttu-id="3e0f1-105">**适用于：** Exchange Server 2013</span><span class="sxs-lookup"><span data-stu-id="3e0f1-105">**Applies to:** Exchange Server 2013</span></span>
  
- <span data-ttu-id="3e0f1-106">类用于读取、 写入或修改邮件</span><span class="sxs-lookup"><span data-stu-id="3e0f1-106">Classes used to read, write, or modify messages</span></span>
- <span data-ttu-id="3e0f1-107">编码器命名空间</span><span class="sxs-lookup"><span data-stu-id="3e0f1-107">Encoders namespace</span></span>
- <span data-ttu-id="3e0f1-108">iCalendar 命名空间</span><span class="sxs-lookup"><span data-stu-id="3e0f1-108">iCalendar namespace</span></span>
- <span data-ttu-id="3e0f1-109">MIME 命名空间</span><span class="sxs-lookup"><span data-stu-id="3e0f1-109">MIME namespace</span></span>
- <span data-ttu-id="3e0f1-110">TextConverters 命名空间</span><span class="sxs-lookup"><span data-stu-id="3e0f1-110">TextConverters namespace</span></span>
- <span data-ttu-id="3e0f1-111">Tnef 命名空间</span><span class="sxs-lookup"><span data-stu-id="3e0f1-111">Tnef namespace</span></span>
- <span data-ttu-id="3e0f1-112">vCard 命名空间</span><span class="sxs-lookup"><span data-stu-id="3e0f1-112">vCard namespace</span></span>
  
<span data-ttu-id="3e0f1-113">当邮件通过传输管道，传输代理可以读取、 写入和转换不同的数据格式之间的消息内容。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-113">As messages pass through the transport pipeline, your transport agent can read, write, and convert message content between different data formats.</span></span> <span data-ttu-id="3e0f1-114">例如，可以读取和写入 MIME 数据识别 Uuencoded 中的传入消息或正文 (qp) 格式，然后转换到标准它们使用您的组织，或读取，然后保存日历或联系人信息相关联传入消息。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-114">For example, you can read and write MIME data, identify incoming messages that are in Uuencoded or Quoted-printable (qp) format, and then convert them to a standard used by your organization, or read and then save calendar or contact information associated with incoming messages.</span></span> 
  
<span data-ttu-id="3e0f1-115">也可以确定内容的安全威胁和移动或删除内容或包含这些; 的消息例如，通过在 HTML 邮件中删除链接。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-115">You can also identify content that poses a security threat and move or delete the content or the messages that contain them; for example, by removing links in an HTML message.</span></span>
  
<span data-ttu-id="3e0f1-116">本文提供有关可用于读取、 写入和修改邮件的.NET Framework 类的信息。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-116">This article provides information about the .NET Framework classes that you can use to read, write, and modify messages.</span></span>
  
> [!CAUTION]
> <span data-ttu-id="3e0f1-117">许多属性和内容转换 Api 中的参数的允许值足以导致性能问题，包括拒绝服务。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-117">Many of the properties and parameters in the content conversion APIs allow values large enough to cause performance problems, including denial of service.</span></span> <span data-ttu-id="3e0f1-118">当您使用的传输代理中的内容转换 Api 时，您应支持时读取或写入以限制资源消耗您代理的属性和参数值大小来实现限制。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-118">When you use the content conversion APIs in a transport agent, you should implement limits on the property and parameter value sizes you support when reading or writing in order to limit resource consumption by your agent.</span></span> 

<span data-ttu-id="3e0f1-119"><a name="Namespaces"> </a></span><span class="sxs-lookup"><span data-stu-id="3e0f1-119"></span></span>

## <a name="classes-used-to-read-write-or-modify-messages"></a><span data-ttu-id="3e0f1-120">类用于读取、 写入或修改邮件</span><span class="sxs-lookup"><span data-stu-id="3e0f1-120">Classes used to read, write, or modify messages</span></span>

<span data-ttu-id="3e0f1-121">下表列出了可用于读取、 写入和修改电子邮件的.NET Framework 类。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-121">The following table lists the .NET Framework classes that you can use to read, write, and modify email messages.</span></span>
  
<span data-ttu-id="3e0f1-122">**.NET framework 消息处理命名空间**</span><span class="sxs-lookup"><span data-stu-id="3e0f1-122">**.NET Framework message processing namespaces**</span></span>

|<span data-ttu-id="3e0f1-123">**.NET framework 命名空间**</span><span class="sxs-lookup"><span data-stu-id="3e0f1-123">**.NET Framework namespace**</span></span>|<span data-ttu-id="3e0f1-124">**课程**</span><span class="sxs-lookup"><span data-stu-id="3e0f1-124">**Classes**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="3e0f1-125">Microsoft.Exchange.Data.Mime.Encoders</span><span class="sxs-lookup"><span data-stu-id="3e0f1-125">Microsoft.Exchange.Data.Mime.Encoders</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.aspx) <br/> |<span data-ttu-id="3e0f1-126">包含为内存中编码和解码的类、 接受关联的枚举中, 包含的编码器或解码器类之一编码器流类和[ByteEncoder](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoder.aspx)基类和[ByteEncoderException](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoderException.aspx)异常类编码器和解码器。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-126">Contains classes for in-memory encoding and decoding, an encoder stream class that accepts one of the encoder or decoder classes contained in an associated enumeration, and the [ByteEncoder](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoder.aspx) base class and [ByteEncoderException](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoderException.aspx) exception class for the encoders and decoders.</span></span>  <br/> |
|[<span data-ttu-id="3e0f1-127">Microsoft.Exchange.Data.ContentTypes.iCalendar</span><span class="sxs-lookup"><span data-stu-id="3e0f1-127">Microsoft.Exchange.Data.ContentTypes.iCalendar</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.aspx) <br/> |<span data-ttu-id="3e0f1-128">包含使您能够读取和写入包含日历信息的数据流的类型。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-128">Contains types that enable you to read and write data streams that contain calendar information.</span></span> <span data-ttu-id="3e0f1-129">包含日历读者和编写器、 exception 对象、 定期对象和结构和枚举可帮助您返回有关日历项目的属性信息。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-129">Includes a calendar reader and writer, an exception object, a recurrence object, and structures and enumerations that help you return property information about calendar items.</span></span>  <br/> |
|[<span data-ttu-id="3e0f1-130">Microsoft.Exchange.Data.Mime</span><span class="sxs-lookup"><span data-stu-id="3e0f1-130">Microsoft.Exchange.Data.Mime</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.aspx) <br/> |<span data-ttu-id="3e0f1-131">包含类、 结构、 枚举和可用于创建、 读取、 写入、 遍历、 编码，和解码 MIME 数据的代理人。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-131">Contains classes, structures, enumerations, and delegates that you can use to create, read, write, traverse, encode, and decode MIME data.</span></span> <span data-ttu-id="3e0f1-132">包括基于数据流的读者和作者可以使您仅向前型读取和写入访问 MIME 数据流，以及基于 DOM 方法可以将 MIME 文档的类。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-132">Includes a stream-based reader and writer that gives you forward-only read and write access to MIME data streams, as well as DOM-based methods and classes you can use on MIME documents.</span></span>  <br/> |
|[<span data-ttu-id="3e0f1-133">Microsoft.Exchange.Data.TextConverters</span><span class="sxs-lookup"><span data-stu-id="3e0f1-133">Microsoft.Exchange.Data.TextConverters</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.aspx) <br/> |<span data-ttu-id="3e0f1-134">包含类、 结构、 枚举和允许您读取和写入数据流和执行特定的数据类型; 之间的转换的代理人例如，为 HTML 到富文本格式 (RTF)。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-134">Contains classes, structures, enumerations, and delegates that allow you to read and write a data stream and perform conversions between specific data types; for example, HTML to Rich Text Format (RTF).</span></span> <span data-ttu-id="3e0f1-135">文本转换器使您能够到另一个窗体中更改的文档流格式，以及有选择地删除可能会带来安全风险文档中的元素。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-135">Text converters enable you to change the format of a document stream from one form to another as well as selectively remove elements of a document that might pose a security risk.</span></span>  <br/> |
|[<span data-ttu-id="3e0f1-136">Microsoft.Exchange.Data.ContentTypes.Tnef</span><span class="sxs-lookup"><span data-stu-id="3e0f1-136">Microsoft.Exchange.Data.ContentTypes.Tnef</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.aspx) <br/> |<span data-ttu-id="3e0f1-137">包含仅向前型流读取器和作者、 异常类，和结构和加快读取和写入数据传输中性封装格式 (TNEF) 的枚举。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-137">Contains a forward-only stream reader and writer, an exception class, and structures and enumerations that facilitate reading and writing Transport Neutral Encapsulation Format (TNEF) data.</span></span>  <br/> |
|[<span data-ttu-id="3e0f1-138">Microsoft.Exchange.Data.ContentTypes.vCard</span><span class="sxs-lookup"><span data-stu-id="3e0f1-138">Microsoft.Exchange.Data.ContentTypes.vCard</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.vCard.aspx) <br/> |<span data-ttu-id="3e0f1-139">包含仅向前型流读取器和作者、 异常类，和结构和加快读取和写入 vCard 格式联系人数据的枚举。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-139">Contains a forward-only stream reader and writer, an exception class, and structures and enumerations that facilitate reading and writing vCard-formatted contact data.</span></span>  <br/> |
   
## <a name="encoders-namespace"></a><span data-ttu-id="3e0f1-140">编码器命名空间</span><span class="sxs-lookup"><span data-stu-id="3e0f1-140">Encoders namespace</span></span>
<span data-ttu-id="3e0f1-141"><a name="Encoders"> </a></span><span class="sxs-lookup"><span data-stu-id="3e0f1-141"></span></span>

<span data-ttu-id="3e0f1-142">编码器命名空间包含用于内存中编码和解码类。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-142">The Encoders namespace contains classes for in-memory encoding and decoding.</span></span> <span data-ttu-id="3e0f1-143">这些从[ByteEncoder](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoder.aspx)基类继承。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-143">These inherit from the [ByteEncoder](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoder.aspx) base class.</span></span> <span data-ttu-id="3e0f1-144">类进行编码和解码为 Base64，BinHex，正文 (qp) 和 Unix 到 Unix (Uu)。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-144">Classes encode and decode for Base64, BinHex, Quoted-printable (qp), and Unix-to-Unix (Uu).</span></span> <span data-ttu-id="3e0f1-145">以下类用于内存中编码和解码：</span><span class="sxs-lookup"><span data-stu-id="3e0f1-145">The following classes are used for in-memory encoding and decoding:</span></span> 
  
- [<span data-ttu-id="3e0f1-146">Base64Encoder</span><span class="sxs-lookup"><span data-stu-id="3e0f1-146">Base64Encoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.Base64Encoder.aspx)
    
- [<span data-ttu-id="3e0f1-147">Base64Decoder</span><span class="sxs-lookup"><span data-stu-id="3e0f1-147">Base64Decoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.Base64Decoder.aspx)
    
- [<span data-ttu-id="3e0f1-148">BinHexEncoder</span><span class="sxs-lookup"><span data-stu-id="3e0f1-148">BinHexEncoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.BinHexEncoder.aspx)
    
- [<span data-ttu-id="3e0f1-149">BinHexDecoder</span><span class="sxs-lookup"><span data-stu-id="3e0f1-149">BinHexDecoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.BinHexDecoder.aspx)
    
- [<span data-ttu-id="3e0f1-150">QPEncoder</span><span class="sxs-lookup"><span data-stu-id="3e0f1-150">QPEncoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.QPEncoder.aspx)
    
- [<span data-ttu-id="3e0f1-151">QPDecoder</span><span class="sxs-lookup"><span data-stu-id="3e0f1-151">QPDecoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.QPDecoder.aspx)
    
- [<span data-ttu-id="3e0f1-152">UUEncoder</span><span class="sxs-lookup"><span data-stu-id="3e0f1-152">UUEncoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.UUEncoder.aspx)
    
- [<span data-ttu-id="3e0f1-153">UUDecoder</span><span class="sxs-lookup"><span data-stu-id="3e0f1-153">UUDecoder</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.UUDecoder.aspx)
    
<span data-ttu-id="3e0f1-154">编码器和解码器从[ByteEncoder](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoder.aspx)基类继承并[ByteEncoderException](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoderException.aspx)异常类用于错误处理。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-154">The encoders and decoders inherit from the [ByteEncoder](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoder.aspx) base class and use the [ByteEncoderException](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.ByteEncoderException.aspx) exception class for error handling.</span></span> 
  
<span data-ttu-id="3e0f1-155">此外，该命名空间包含标识 MacBinary 编码文件并读取其关联的文件标头的[MacBinaryHeader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.MacBinaryHeader.aspx)类。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-155">Additionally, the namespace contains the [MacBinaryHeader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.MacBinaryHeader.aspx) class, which identifies MacBinary encoded files and reads their associated file header.</span></span> 
  
<span data-ttu-id="3e0f1-156">最后， [EncoderStream](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.EncoderStream.aspx)类对而不是内存中对象的数据流执行转换。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-156">Finally, the [EncoderStream](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.EncoderStream.aspx) class performs a conversion on a data stream instead of an in-memory object.</span></span> <span data-ttu-id="3e0f1-157">此类接受编码器或解码器类之一和任一读取或写入根据关联的[EncoderStreamAccess](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.EncoderStreamAccess.aspx)枚举。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-157">This class accepts one of the encoder or decoder classes and either reads or writes according to the associated [EncoderStreamAccess](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.Encoders.EncoderStreamAccess.aspx) enumeration.</span></span> 
  
## <a name="icalendar-namespace"></a><span data-ttu-id="3e0f1-158">iCalendar 命名空间</span><span class="sxs-lookup"><span data-stu-id="3e0f1-158">iCalendar namespace</span></span>
<span data-ttu-id="3e0f1-159"><a name="iCalendar"> </a></span><span class="sxs-lookup"><span data-stu-id="3e0f1-159"></span></span>

<span data-ttu-id="3e0f1-160">ICalendar 命名空间提供的 iCalendar 数据，除了支持结构和类可用于创建、 访问和修改 iCalendar 流仅向前型读者和编写器。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-160">The iCalendar namespace provides a forward-only reader and writer for iCalendar data, in addition to supporting structures and classes for creating, accessing, and modifying iCalendar streams.</span></span>
  
<span data-ttu-id="3e0f1-161">[CalendarReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.aspx)和[CalendarWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarWriter.aspx)类用于读取和写入 iCalendar 流数据。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-161">The [CalendarReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.aspx) and [CalendarWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarWriter.aspx) classes are used to read and write iCalendar stream data.</span></span> 
  
<span data-ttu-id="3e0f1-162">CalendarReader 到其构造函数将作为参数的可读的[流](https://msdn.microsoft.com/library/System.IO.Stream.aspx)。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-162">The CalendarReader takes a readable [Stream](https://msdn.microsoft.com/library/System.IO.Stream.aspx) as an argument to its constructors.</span></span> <span data-ttu-id="3e0f1-163">然后可以使用[ReadFirstChildComponent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ReadFirstChildComponent.aspx)、 [ReadNextSiblingComponent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ReadNextSiblingComponent.aspx)和[ReadNextComponent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ReadNextComponent.aspx)方法按顺序访问中的数据流的 iCalendar 组件。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-163">You can then use the [ReadFirstChildComponent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ReadFirstChildComponent.aspx), [ReadNextSiblingComponent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ReadNextSiblingComponent.aspx), and [ReadNextComponent](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ReadNextComponent.aspx) methods to sequentially access the iCalendar components in the data stream.</span></span> <span data-ttu-id="3e0f1-164">根据您已为[ComplianceMode](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ComplianceMode.aspx)属性设置的值，iCalendar 流中的错误会导致引发异常，或将导致[ComplianceStatus](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ComplianceStatus.aspx)属性设置为非[兼容](https://msdn.microsoft.com/en-us/library/microsoft.exchange.data.contenttypes.icalendar.calendarcompliancestatus.aspx)的值。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-164">Based on the value that you have set for the [ComplianceMode](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ComplianceMode.aspx) property, errors in the iCalendar stream will cause an exception to be thrown or will cause the [ComplianceStatus](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarReader.ComplianceStatus.aspx) property to be set to a value other than [Compliant](https://msdn.microsoft.com/en-us/library/microsoft.exchange.data.contenttypes.icalendar.calendarcompliancestatus.aspx).</span></span> <span data-ttu-id="3e0f1-165">您可以检查此属性以发现任何问题传入 iCalendar 数据。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-165">You can check this property to discover any issues with incoming iCalendar data.</span></span> 
  
<span data-ttu-id="3e0f1-166">[CalendarWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarWriter.aspx)类到其构造函数将作为参数的可写的[流](https://msdn.microsoft.com/library/System.IO.Stream.aspx)。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-166">The [CalendarWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.iCalendar.CalendarWriter.aspx) class takes a writable [Stream](https://msdn.microsoft.com/library/System.IO.Stream.aspx) as an argument to its constructors.</span></span> 
  
## <a name="mime-namespace"></a><span data-ttu-id="3e0f1-167">MIME 命名空间</span><span class="sxs-lookup"><span data-stu-id="3e0f1-167">MIME namespace</span></span>
<span data-ttu-id="3e0f1-168"><a name="MIME"> </a></span><span class="sxs-lookup"><span data-stu-id="3e0f1-168"></span></span>

<span data-ttu-id="3e0f1-169">MIME 命名空间提供了使您能够创建、 访问和修改 MIME 文档的类。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-169">The MIME namespace provides classes that enable you to create, access, and modify MIME documents.</span></span> <span data-ttu-id="3e0f1-170">您可以通过使用基于流或基于 DOM 方法使用 MIME 文档。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-170">You can work with MIME documents by using either a stream-based or DOM-based method.</span></span>
  
### <a name="mimedocument-class-and-the-mime-dom"></a><span data-ttu-id="3e0f1-171">MimeDocument 类和 MIME DOM</span><span class="sxs-lookup"><span data-stu-id="3e0f1-171">MimeDocument class and the MIME DOM</span></span>

<span data-ttu-id="3e0f1-172">[MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx)类使对 MIME 文档的 DOM 访问。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-172">The [MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx) class enables DOM access to a MIME document.</span></span> <span data-ttu-id="3e0f1-173">此类型后加载整个 DOM 和您的可用内存的使用对象必须具有随机访问的标头和邮件内容。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-173">Use objects of this type when you have the available memory to load a whole DOM and you must have random access to the headers and content of the message.</span></span> 
  
<span data-ttu-id="3e0f1-174">通过使用[GetLoadStream](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.GetLoadStream.aspx)或[负载](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.Load.aspx)繁重方法将数据加载到[MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx)对象。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-174">You load data into a [MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx) object by using the [GetLoadStream](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.GetLoadStream.aspx) or [Load](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.Load.aspx) methods.</span></span> <span data-ttu-id="3e0f1-175">您然后可以浏览 DOM 层次结构和创建、 修改或删除 MIME 数据。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-175">You can then walk the DOM hierarchy and create, modify, or remove MIME data.</span></span> <span data-ttu-id="3e0f1-176">已修改的 MIME 数据后，您可以将它编写为流使用[WriteTo](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeNode.WriteTo.aspx)方法之一。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-176">After you have modified the MIME data, you can write it to a stream by using one of the [WriteTo](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeNode.WriteTo.aspx) methods.</span></span> 
  
<span data-ttu-id="3e0f1-177">下图显示了[MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx)对象中的数据结构。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-177">The following figure shows the structure of data within a [MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx) object.</span></span> 
  
<span data-ttu-id="3e0f1-178">**图 1。MimeDocument 对象的结构**</span><span class="sxs-lookup"><span data-stu-id="3e0f1-178">**Figure 1. Structure of MimeDocument objects**</span></span>

![MIME DOM 体系结构](media/MimeDomArchitecture.gif)
  
### <a name="mimereader-and-mimewriter-classes-and-stream-based-mime-parsing"></a><span data-ttu-id="3e0f1-180">MimeReader 和 MimeWriter 类和基于数据流的 MIME 分析</span><span class="sxs-lookup"><span data-stu-id="3e0f1-180">MimeReader and MimeWriter classes and stream-based MIME parsing</span></span>

<span data-ttu-id="3e0f1-181">[MimeReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.aspx)和[MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx)类允许仅向前型访问 MIME 流。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-181">The [MimeReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.aspx) and [MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx) classes enable forward-only access to MIME streams.</span></span> <span data-ttu-id="3e0f1-182">不需要更改需要已读取或写入的数据的 MIME 数据时使用这些类。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-182">Use these classes when you do not have to change the MIME data that requires data that has already been read or written.</span></span> <span data-ttu-id="3e0f1-183">例如，如果您想要打印适合的预定义的格式的消息，可能是理想[MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx)类。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-183">For example, if you want to print messages that fit a predefined format, the [MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx) class might be ideal.</span></span> 
  
<span data-ttu-id="3e0f1-184">[MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx)类封装 dom。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-184">The [MimeDocument](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeDocument.aspx) class encapsulates a DOM.</span></span> <span data-ttu-id="3e0f1-185">[MimeReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.aspx)和[MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx)类表示状态计算机。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-185">The [MimeReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.aspx) and [MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx) classes represent state computers.</span></span> <span data-ttu-id="3e0f1-186">基于接收的输入和调用的方法及其状态发生更改。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-186">Their states change based on the input received and the methods called.</span></span> <span data-ttu-id="3e0f1-187">图表 2 至 5 是显示，对于[MimeReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.aspx)对象，方法是有效从每个状态和状态可能会导致调用简化的状态切换图表。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-187">Figures 2 through 5 are simplified state transition diagrams that show, for the [MimeReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.aspx) object, which methods are valid to call from each state and the state that will result.</span></span> 
  
<span data-ttu-id="3e0f1-188">若要使用这些图表，按照从一种状态的箭头，到下一步，注意在方法调用或返回导致的状态更改的值。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-188">To use these diagrams, follow the arrows from one state to the next, noting the method calls or return values that cause the state to change.</span></span> <span data-ttu-id="3e0f1-189">例如，在第一个图表中，假定您已创建 MimeReader 所属的 stream 的开头。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-189">For example, in the first diagram, assume that you are at the start of the stream that belongs to the MimeReader that you have created.</span></span> <span data-ttu-id="3e0f1-190">若要获取为部件标题的状态，请调用该顺序[ReadNextPart](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.ReadNextPart.aspx)或[ReadFirstChildPart](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.ReadFirstChildPart.aspx)，之一。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-190">To get to the Part Headers state, call one of [ReadNextPart](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.ReadNextPart.aspx) or [ReadFirstChildPart](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeReader.ReadFirstChildPart.aspx), in that order.</span></span> <span data-ttu-id="3e0f1-191">如果有标头 （即，如果 MIME 是格式正确），您将输入到部件标题状态。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-191">If there are headers (that is, if the MIME is well-formed), you will enter into the Part Headers state.</span></span> <span data-ttu-id="3e0f1-192">否则，将引发异常。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-192">Otherwise, an exception will be thrown.</span></span> 
  
<span data-ttu-id="3e0f1-193">**图 2。MimeReader 对象的简化的状态转换关系图**</span><span class="sxs-lookup"><span data-stu-id="3e0f1-193">**Figure 2. Simplified state transition diagram for MimeReader objects**</span></span>

![MimeReader 状态图表](media/MimeReader_StateDiagram_01.gif)
  
> [!NOTE]
> <span data-ttu-id="3e0f1-195">图表 3、 4 和 5 展开上每个前面的图表中显示的状态。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-195">Figures 3, 4, and 5 expand on states shown in each of the previous diagrams.</span></span> 
  
<span data-ttu-id="3e0f1-196">**图 3。图 2 中的部件标题状态扩展**</span><span class="sxs-lookup"><span data-stu-id="3e0f1-196">**Figure 3. Expansion of Part Headers state from Figure 2**</span></span>

![“部件标题”状态扩展](media/MimeReader_StateDiagram_02.gif)
  
<span data-ttu-id="3e0f1-198">**图 4。图 3 标头中遇到参数后从标题状态扩展**</span><span class="sxs-lookup"><span data-stu-id="3e0f1-198">**Figure 4. Expansion of Header state from Figure 3 when a parameter has been encountered in a header**</span></span>

![“部件标题”状态扩展](media/MimeReader_StateDiagram_03.gif)
  
> [!NOTE]
> <span data-ttu-id="3e0f1-200">图 5 所表示的状态，因此是递归，如果遇到一个通讯组，您可以使用[GroupRecipientReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeAddressReader.GroupRecipientReader.aspx)属性读取组中的地址。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-200">The state represented by Figure 5 is recursive in that, if an address group is encountered, you can use the [GroupRecipientReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeAddressReader.GroupRecipientReader.aspx) property to read the addresses in the group.</span></span> 
  
<span data-ttu-id="3e0f1-201">**图 5。图 3 时遇到的地址或通讯组中的标题状态扩展**</span><span class="sxs-lookup"><span data-stu-id="3e0f1-201">**Figure 5. Expansion of Header state from Figure 3 when an address or address group is encountered**</span></span>

![用于地址或组的“标题”状态扩展](media/MimeReader_StateDiagram_04.gif)
  
<span data-ttu-id="3e0f1-203">图 6 和 7 显示[MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx)对象的简化的状态转换关系图。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-203">Figures 6 and 7 show simplified state transition diagrams for the [MimeWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.Mime.MimeWriter.aspx) object.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="3e0f1-204">图 7 展开图 6 所示的部件标题状态。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-204">Figure 7 expands on the Part Headers state shown in Figure 6.</span></span> 
  
<span data-ttu-id="3e0f1-205">**图 6。MimeWriter 对象的简化的状态转换关系图**</span><span class="sxs-lookup"><span data-stu-id="3e0f1-205">**Figure 6. Simplified state transition diagram for MimeWriter objects**</span></span>

![用于 MimeWriter 的状态切换图表](media/MimeWriter_TopLevel.gif)
  
<span data-ttu-id="3e0f1-207">**图 7。图 6 中的部件标题状态扩展**</span><span class="sxs-lookup"><span data-stu-id="3e0f1-207">**Figure 7. Expansion of Part Headers state from Figure 6**</span></span>

![用于 MimeWriter 的状态切换图表扩展](media/MimeWriter_Diagram_Expansion.gif)
  
## <a name="textconverters-namespace"></a><span data-ttu-id="3e0f1-209">TextConverters 命名空间</span><span class="sxs-lookup"><span data-stu-id="3e0f1-209">TextConverters namespace</span></span>
<span data-ttu-id="3e0f1-210"><a name="TextConverters"> </a></span><span class="sxs-lookup"><span data-stu-id="3e0f1-210"></span></span>

<span data-ttu-id="3e0f1-211">TextConverters 命名空间包含支持的电子邮件内容的转换类型。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-211">The TextConverters namespace contains types that support the conversion of the contents of email messages.</span></span> <span data-ttu-id="3e0f1-212">这些类型可以执行的代码页转换、 移除不安全的 HTML 和电子邮件正文执行其他转换。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-212">These types can perform code page conversion, remove HTML that is not secure, and perform other transformations on email message bodies.</span></span> <span data-ttu-id="3e0f1-213">[Microsoft.Exchange.Data.TextConverters](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.aspx)命名空间包括以下[TextConverter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.TextConverter.aspx)抽象类派生的类：</span><span class="sxs-lookup"><span data-stu-id="3e0f1-213">The [Microsoft.Exchange.Data.TextConverters](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.aspx) namespace includes the following classes that derive from the [TextConverter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.TextConverter.aspx) abstract class:</span></span> 
  
- [<span data-ttu-id="3e0f1-214">EnrichedToHtml</span><span class="sxs-lookup"><span data-stu-id="3e0f1-214">EnrichedToHtml</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.EnrichedToHtml.aspx)
    
- [<span data-ttu-id="3e0f1-215">EnrichedToText</span><span class="sxs-lookup"><span data-stu-id="3e0f1-215">EnrichedToText</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.EnrichedToText.aspx)
    
- [<span data-ttu-id="3e0f1-216">HtmlToEnriched</span><span class="sxs-lookup"><span data-stu-id="3e0f1-216">HtmlToEnriched</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.HtmlToEnriched.aspx)
    
- [<span data-ttu-id="3e0f1-217">HtmlToHtml</span><span class="sxs-lookup"><span data-stu-id="3e0f1-217">HtmlToHtml</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.HtmlToHtml.aspx)
    
- [<span data-ttu-id="3e0f1-218">HtmlToRtf</span><span class="sxs-lookup"><span data-stu-id="3e0f1-218">HtmlToRtf</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.HtmlToRtf.aspx)
    
- [<span data-ttu-id="3e0f1-219">HtmlToText</span><span class="sxs-lookup"><span data-stu-id="3e0f1-219">HtmlToText</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.HtmlToText.aspx)
    
- [<span data-ttu-id="3e0f1-220">RtfCompressedToRtf</span><span class="sxs-lookup"><span data-stu-id="3e0f1-220">RtfCompressedToRtf</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.RtfCompressedToRtf.aspx)
    
- [<span data-ttu-id="3e0f1-221">RtfToHtml</span><span class="sxs-lookup"><span data-stu-id="3e0f1-221">RtfToHtml</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.RtfToHtml.aspx)
    
- [<span data-ttu-id="3e0f1-222">RtfToRtf</span><span class="sxs-lookup"><span data-stu-id="3e0f1-222">RtfToRtf</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.RtfToRtf.aspx)
    
- [<span data-ttu-id="3e0f1-223">RtfToRtfCompressed</span><span class="sxs-lookup"><span data-stu-id="3e0f1-223">RtfToRtfCompressed</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.RtfToRtfCompressed.aspx)
    
- [<span data-ttu-id="3e0f1-224">RtfToText</span><span class="sxs-lookup"><span data-stu-id="3e0f1-224">RtfToText</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.RtfToText.aspx)
    
- [<span data-ttu-id="3e0f1-225">TextToHtml</span><span class="sxs-lookup"><span data-stu-id="3e0f1-225">TextToHtml</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.TextToHtml.aspx)
    
- [<span data-ttu-id="3e0f1-226">TextToRtf</span><span class="sxs-lookup"><span data-stu-id="3e0f1-226">TextToRtf</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.TextToRtf.aspx)
    
- [<span data-ttu-id="3e0f1-227">TextToText</span><span class="sxs-lookup"><span data-stu-id="3e0f1-227">TextToText</span></span>](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.TextToText.aspx)
    
<span data-ttu-id="3e0f1-228">这些文本转换器允许您更改的文档流格式或删除不安全的 HTML 文档中的元素。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-228">These text converters enable you to change the format of a document stream or to remove elements that are not secure from an HTML document.</span></span> <span data-ttu-id="3e0f1-229">这些类可用于本身中[TextConverter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.TextConverter.aspx)基类，使用单个呼叫到 Convert 方法之一执行转换或可以将它们传递给转换器，使用它来执行转换的读取或写入的构造函数。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-229">These classes can be used by themselves to perform a conversion by using a single call to one of the Convert methods in the [TextConverter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.TextConverter.aspx) base class, or they can be passed to a constructor of the converter, which uses it to perform converted reads or writes.</span></span> 
  
<span data-ttu-id="3e0f1-230">从基类继承的功能可用于执行转换，如果您有足够的空间来存储原始文档和其已转换的输出，或您想要存储的转换结果时。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-230">The functionality inherited from the base class is useful for performing conversions when you have sufficient space to store the original document and its converted output, or when you want to store the results of the conversion.</span></span> <span data-ttu-id="3e0f1-231">**Convert**方法采用输入和输出流、 文本读者或文本编写器，并将转换的内容关联的输出的输入。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-231">The **Convert** method takes input and output streams, text readers, or text writers, and converts the content of the input to the associated output.</span></span> 
  
<span data-ttu-id="3e0f1-232">此外包含命名空间中的以下文本读者、 作者和流类：</span><span class="sxs-lookup"><span data-stu-id="3e0f1-232">Also included in the namespace are the following text reader, writer, and stream classes:</span></span>
  
- <span data-ttu-id="3e0f1-233">[ConverterReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.ConverterReader.aspx) — 派生自**System.IO.TextReader**。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-233">[ConverterReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.ConverterReader.aspx) — Derived from **System.IO.TextReader**.</span></span> 
    
- <span data-ttu-id="3e0f1-234">[ConverterWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.ConverterWriter.aspx) — 派生自**System.IO.TextWriter**。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-234">[ConverterWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.ConverterWriter.aspx) — Derived from **System.IO.TextWriter**.</span></span> 
    
- <span data-ttu-id="3e0f1-235">[ConverterStream](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.ConverterStream.aspx) — 派生自**System.IO.Stream**。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-235">[ConverterStream](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.TextConverters.ConverterStream.aspx) — Derived from **System.IO.Stream**.</span></span> 
    
<span data-ttu-id="3e0f1-236">这些用于执行转换时没有空间以存储原始对象或其已转换的输出，当您收到来自输入或输出发送到流，或者仅用于索引编制或搜索目的希望输出，因此不想存储转换的结果。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-236">These are used to perform conversions when you do not have room to store the original or its converted output, when you receive the input from or send the output to a stream, or when you want the output only for indexing or search purposes and therefore do not want to store the result of a conversion.</span></span>
  
## <a name="tnef-namespace"></a><span data-ttu-id="3e0f1-237">Tnef 命名空间</span><span class="sxs-lookup"><span data-stu-id="3e0f1-237">Tnef namespace</span></span>
<span data-ttu-id="3e0f1-238"><a name="TNEF"> </a></span><span class="sxs-lookup"><span data-stu-id="3e0f1-238"></span></span>

<span data-ttu-id="3e0f1-239">Tnef 命名空间包含类和启用仅向前型的流读取和写入 TNEF 数据的类型。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-239">The Tnef namespace contains classes and types that enable forward-only stream-based reading and writing of TNEF data.</span></span> <span data-ttu-id="3e0f1-240">TNEF 是用于客户端无法解释 MAPI 封装 MAPI 属性的数据格式。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-240">TNEF is a data format that is used to encapsulate MAPI properties for clients that cannot interpret MAPI.</span></span>
  
<span data-ttu-id="3e0f1-241">[TnefReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.aspx)和[TnefWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefWriter.aspx)类提供[Microsoft.Exchange.Data.ContentTypes.Tnef](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.aspx)命名空间中的核心功能。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-241">The [TnefReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.aspx) and [TnefWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefWriter.aspx) classes provide the core functionality in the [Microsoft.Exchange.Data.ContentTypes.Tnef](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.aspx) namespace.</span></span> 
  
<span data-ttu-id="3e0f1-242">[TnefReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.aspx)类将作为参数的可读流带到其构造函数中。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-242">The [TnefReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.aspx) class takes a readable stream as an argument to its constructors.</span></span> <span data-ttu-id="3e0f1-243">然后可以使用[ReadNextAttribute](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.ReadNextAttribute.aspx)方法以按顺序阅读 TNEF 流中的属性。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-243">You then use the [ReadNextAttribute](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.ReadNextAttribute.aspx) method to sequentially read the attributes in the TNEF stream.</span></span> <span data-ttu-id="3e0f1-244">您已阅读属性后，您可以对[TnefReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.aspx)对象，除了获取[TnefPropertyReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefPropertyReader.aspx)读取当前属性使用的任何只读属性来访问有关属性信息。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-244">After you have read an attribute, you can access information about the attribute by using any of the read-only properties on the [TnefReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.aspx) object, in addition to getting a [TnefPropertyReader](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefPropertyReader.aspx) to read the current property.</span></span> <span data-ttu-id="3e0f1-245">您可以使用[ReadAttributeRawValue](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.ReadAttributeRawValue.aspx)方法还直接访问当前属性。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-245">You can also directly access the current attribute by using the [ReadAttributeRawValue](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefReader.ReadAttributeRawValue.aspx) method.</span></span> 
  
<span data-ttu-id="3e0f1-246">[TnefWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefWriter.aspx)类到其构造函数将作为参数的可写的[流](https://msdn.microsoft.com/library/System.IO.Stream.aspx)。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-246">The [TnefWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefWriter.aspx) class takes a writable [Stream](https://msdn.microsoft.com/library/System.IO.Stream.aspx) as an argument to its constructors.</span></span> <span data-ttu-id="3e0f1-247">[TnefWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefWriter.aspx)类提供了多种方式在其中将数据写入此流。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-247">The [TnefWriter](https://msdn.microsoft.com/library/Microsoft.Exchange.Data.ContentTypes.Tnef.TnefWriter.aspx) class provides multiple ways in which to write data to this stream.</span></span> 
  
## <a name="vcard-namespace"></a><span data-ttu-id="3e0f1-248">vCard 命名空间</span><span class="sxs-lookup"><span data-stu-id="3e0f1-248">vCard namespace</span></span>
<span data-ttu-id="3e0f1-249"><a name="vCard"> </a></span><span class="sxs-lookup"><span data-stu-id="3e0f1-249"></span></span>

<span data-ttu-id="3e0f1-250">VCard 命名空间包含类、 结构和用于读取和写入位于 vCard 数据格式的电子邮件中包含的联系人信息的枚举。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-250">The vCard namespace contains classes, structures, and enumerations used to read and write contact information contained in an email message that is in the vCard data format.</span></span> <span data-ttu-id="3e0f1-251">命名空间包含联系人读者和编写器、 异常类、 属性读取器、 参数读者，和支持，可以阅读电子邮件与关联的电子名片数据的枚举。</span><span class="sxs-lookup"><span data-stu-id="3e0f1-251">The namespace contains a contact reader and writer, an exception class, a property reader, a parameter reader, and supporting enumerations that allow you to read vCard data associated with an email message.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="3e0f1-252">另请参阅</span><span class="sxs-lookup"><span data-stu-id="3e0f1-252">See also</span></span>

- [<span data-ttu-id="3e0f1-253">在 Exchange 传输代理</span><span class="sxs-lookup"><span data-stu-id="3e0f1-253">Transport agents in Exchange</span></span>](transport-agents-in-exchange-2013.md)  
- [<span data-ttu-id="3e0f1-254">传输代理 Exchange 2013 中的概念</span><span class="sxs-lookup"><span data-stu-id="3e0f1-254">Transport agent concepts in Exchange 2013</span></span>](transport-agent-concepts-in-exchange-2013.md) 
- [<span data-ttu-id="3e0f1-255">Exchange 2013 的传输代理引用</span><span class="sxs-lookup"><span data-stu-id="3e0f1-255">Transport agent reference for Exchange 2013</span></span>](transport-agent-reference-for-exchange-2013.md)
- [<span data-ttu-id="3e0f1-256">MIME 媒体类型</span><span class="sxs-lookup"><span data-stu-id="3e0f1-256">MIME Media Types</span></span>](http://www.iana.org/assignments/media-types)
    

