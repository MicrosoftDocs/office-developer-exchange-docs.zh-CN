---
title: 导出和导入在 Exchange 中使用 EWS 的项目
manager: sethgros
ms.date: 03/9/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: ad5f75f9-47c3-4f51-a535-80cba4243683
description: 了解如何导出和导入在 Exchange 使用 EWS 托管 API 或 EWS 的约会、 电子邮件、 联系人、 任务和其他邮箱项目。
ms.openlocfilehash: 00c72806b95c162077733f77a52c4ea4da03631f
ms.sourcegitcommit: 9061fcf40c218ebe88911783f357b7df278846db
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/28/2018
ms.locfileid: "21353649"
---
# <a name="exporting-and-importing-items-by-using-ews-in-exchange"></a><span data-ttu-id="242a5-103">导出和导入在 Exchange 中使用 EWS 的项目</span><span class="sxs-lookup"><span data-stu-id="242a5-103">Exporting and importing items by using EWS in Exchange</span></span>

<span data-ttu-id="242a5-104">了解如何导出和导入在 Exchange 使用 EWS 托管 API 或 EWS 的约会、 电子邮件、 联系人、 任务和其他邮箱项目。</span><span class="sxs-lookup"><span data-stu-id="242a5-104">Learn about exporting and importing appointments, emails, contacts, tasks, and other mailbox items by using the EWS Managed API or EWS in Exchange.</span></span> 
  
<span data-ttu-id="242a5-105">Exchange 是金色挖掘重要信息： 电子邮件、 联系人、 任务和日历的核心组织的函数。</span><span class="sxs-lookup"><span data-stu-id="242a5-105">Exchange is a gold mine of important information: email, contacts, tasks, and calendars are core to an organization's functions.</span></span> <span data-ttu-id="242a5-106">EWS 使您能够导出和导入通过三种不同方法的核心项目类型：</span><span class="sxs-lookup"><span data-stu-id="242a5-106">EWS enables you to export and import core item types via three different approaches:</span></span>
  
- <span data-ttu-id="242a5-107">Exchange 项目类型。</span><span class="sxs-lookup"><span data-stu-id="242a5-107">Exchange item types.</span></span> <span data-ttu-id="242a5-108">我们建议使用此方法用于导入和导出项目与其他系统和文件。</span><span class="sxs-lookup"><span data-stu-id="242a5-108">We recommend this approach for importing and exporting items to and from other systems and files.</span></span>
    
- <span data-ttu-id="242a5-109">项目级功能 (仅限 EWS)。</span><span class="sxs-lookup"><span data-stu-id="242a5-109">Item-level capability (EWS only).</span></span> <span data-ttu-id="242a5-110">我们建议导出或从一个 Exchange 服务器或邮箱复制和导入到另一个此选项。</span><span class="sxs-lookup"><span data-stu-id="242a5-110">We recommend this option for exporting or copying from one Exchange server or mailbox and importing to another.</span></span>
    
- <span data-ttu-id="242a5-111">MIME 等 iCalendar 电子名片的常见标准文件格式的窗体中的流。</span><span class="sxs-lookup"><span data-stu-id="242a5-111">MIME streams in the form of common standard file formats such as iCalendar and vCard.</span></span> <span data-ttu-id="242a5-112">由于有限的属性集并 MIME 的转换会消耗大量资金，我们建议仅用于导入或导出的少量数据的方法。</span><span class="sxs-lookup"><span data-stu-id="242a5-112">Because the property set is limited and MIME conversion is costly, we recommend the approach only for importing or exporting a small amount of data.</span></span>
    
> [!IMPORTANT]
> <span data-ttu-id="242a5-113">EWS 不适用于邮箱备份和还原。</span><span class="sxs-lookup"><span data-stu-id="242a5-113">EWS is not designed for mailbox backup and restore.</span></span> <span data-ttu-id="242a5-114">若要备份和还原数据库，请使用[备份和还原 API](../backup-restore/backup-and-restore-for-exchange-2013.md)。</span><span class="sxs-lookup"><span data-stu-id="242a5-114">To back up and restore databases, use the [backup and restore API](../backup-restore/backup-and-restore-for-exchange-2013.md).</span></span> <span data-ttu-id="242a5-115">请参阅 TechNet 上的[备份、 还原和灾难恢复](http://technet.microsoft.com/en-us/library/dd876874%28v=exchg.150%29.aspx)。</span><span class="sxs-lookup"><span data-stu-id="242a5-115">See also [Backup, restore, and disaster recovery](http://technet.microsoft.com/en-us/library/dd876874%28v=exchg.150%29.aspx) on TechNet.</span></span> 
  
<span data-ttu-id="242a5-116">**表 1。导出和导入联系人、 电子邮件和日历项目**</span><span class="sxs-lookup"><span data-stu-id="242a5-116">**Table 1. Exporting and importing contact, email, and calendar items**</span></span>

|<span data-ttu-id="242a5-117">任务</span><span class="sxs-lookup"><span data-stu-id="242a5-117">Task</span></span>|<span data-ttu-id="242a5-118">EWS 托管的 API 方法</span><span class="sxs-lookup"><span data-stu-id="242a5-118">EWS Managed API method</span></span>|<span data-ttu-id="242a5-119">EWS 操作</span><span class="sxs-lookup"><span data-stu-id="242a5-119">EWS operation</span></span>|<span data-ttu-id="242a5-120">笔记</span><span class="sxs-lookup"><span data-stu-id="242a5-120">Notes</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="242a5-121">导出联系人、 电子邮件、 任务或日历项目的[指定的属性设置](properties-and-extended-properties-in-ews-in-exchange.md)的副本。</span><span class="sxs-lookup"><span data-stu-id="242a5-121">Export a copy of a contact, email, task, or calendar item with a [specified property set](properties-and-extended-properties-in-ews-in-exchange.md).</span></span>  <br/> |[<span data-ttu-id="242a5-122">Contact.Bind</span><span class="sxs-lookup"><span data-stu-id="242a5-122">Contact.Bind</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="242a5-123">EmailMessage.Bind</span><span class="sxs-lookup"><span data-stu-id="242a5-123">EmailMessage.Bind</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessage.bind%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="242a5-124">Appointment.Bind</span><span class="sxs-lookup"><span data-stu-id="242a5-124">Appointment.Bind</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment.bind%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="242a5-125">Task.Bind</span><span class="sxs-lookup"><span data-stu-id="242a5-125">Task.Bind</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.task.bind%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="242a5-126">GetItem</span><span class="sxs-lookup"><span data-stu-id="242a5-126">GetItem</span></span>](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) <br/> |<span data-ttu-id="242a5-127">如果您将邮箱项目导出到另一个非 Exchange 系统或 （包括电子名片和 iCal 文件类型） 文件，我们建议此选项。</span><span class="sxs-lookup"><span data-stu-id="242a5-127">We recommend this option if you're exporting mailbox items to another non-Exchange system or file (including vCard and iCal file types).</span></span><br/><span data-ttu-id="242a5-128">因为您可以控制导出的属性集，并且性能更佳的 Exchange 服务器，这通常是最佳选项。</span><span class="sxs-lookup"><span data-stu-id="242a5-128">Because you have control over the exported property set, and because performance is better for the Exchange server, this is generally the best option.</span></span><br/><br/><span data-ttu-id="242a5-129">根据属性设置邮箱的项，并注意可能在项目设置的非架构化属性标识符 （扩展属性） 的所有应用程序是否，此选项可能不会产生完全保真的副本。</span><span class="sxs-lookup"><span data-stu-id="242a5-129">Depending on the properties set on a mailbox item, and whether your application is aware of all of the non-schematized property identifiers (extended properties) that might be set on an item, this option might not produce a full-fidelity copy.</span></span><br/><br/><span data-ttu-id="242a5-130">这些方法和操作提供项目的属性以及任何请求的扩展的属性架构化的的集。</span><span class="sxs-lookup"><span data-stu-id="242a5-130">These methods and operation provide the schematized set of properties for an item plus any requested extended properties.</span></span><br/><span data-ttu-id="242a5-131">**绑定**方法或**GetItem**操作只能提供完全保真的导出的项目如果您知道项目设置的扩展的属性。</span><span class="sxs-lookup"><span data-stu-id="242a5-131">The **Bind** method or **GetItem** operation can only provide full-fidelity export of items if you know the extended properties that are set on an item.</span></span><br/><span data-ttu-id="242a5-132">您可以请求的所有已知的[扩展的属性](properties-and-extended-properties-in-ews-in-exchange.md)启用全保真方式。</span><span class="sxs-lookup"><span data-stu-id="242a5-132">You can request all the known [extended properties](properties-and-extended-properties-in-ews-in-exchange.md) to enable full fidelity.</span></span><br/><br/><span data-ttu-id="242a5-133">**提示**： 可以使用 EWS 托管 API 中的跟踪功能要获取的 XML 表示形式导出的项目。</span><span class="sxs-lookup"><span data-stu-id="242a5-133">**TIP**: You can use the tracing feature in the EWS Managed API to get the XML representation of exported items.</span></span>           <span data-ttu-id="242a5-134">有关详细信息，请参阅[导出一项插入自定义格式](how-to-export-items-by-using-ews-in-exchange.md#bk_exportcustom)。</span><span class="sxs-lookup"><span data-stu-id="242a5-134">For more information, see [Export an item into a custom format](how-to-export-items-by-using-ews-in-exchange.md#bk_exportcustom).</span></span>  <br/> |
|<span data-ttu-id="242a5-135">导入联系人、 电子邮件、 任务中或[指定的属性设置](properties-and-extended-properties-in-ews-in-exchange.md)的日历项目的副本。</span><span class="sxs-lookup"><span data-stu-id="242a5-135">Import a copy of a contact, email, task, or calendar item with a [specified property set](properties-and-extended-properties-in-ews-in-exchange.md).</span></span>  <br/> |[<span data-ttu-id="242a5-136">Contact.Save</span><span class="sxs-lookup"><span data-stu-id="242a5-136">Contact.Save</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.contact.save%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="242a5-137">EmailMessage.Save</span><span class="sxs-lookup"><span data-stu-id="242a5-137">EmailMessage.Save</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessage.save%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="242a5-138">Appointment.Save</span><span class="sxs-lookup"><span data-stu-id="242a5-138">Appointment.Save</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment.save%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="242a5-139">Task.Save</span><span class="sxs-lookup"><span data-stu-id="242a5-139">Task.Save</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.task.save%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="242a5-140">CreateItem</span><span class="sxs-lookup"><span data-stu-id="242a5-140">CreateItem</span></span>](http://msdn.microsoft.com/library/78a52120-f1d0-4ed7-8748-436e554f75b6%28Office.15%29.aspx) <br/> |<span data-ttu-id="242a5-141">我们建议将邮箱项目导入到 Exchange 此选项。</span><span class="sxs-lookup"><span data-stu-id="242a5-141">We recommend this option for importing mailbox items into Exchange.</span></span><br/><span data-ttu-id="242a5-142">您可能需要对一些项目类型的特殊属性设置为了维护导入的项的状态。</span><span class="sxs-lookup"><span data-stu-id="242a5-142">You might have to set special properties on some item types in order to maintain the state of the imported item.</span></span><br/><span data-ttu-id="242a5-143">由 Exchange 而非客户端仅设置某些属性，因为它并不总是可能需要完全保真的导入。</span><span class="sxs-lookup"><span data-stu-id="242a5-143">Because some properties are only set by Exchange and not by clients, it's not always possible to have a full-fidelity import.</span></span><br/><br/><span data-ttu-id="242a5-144">例如，您无法导入与与会者的会议邮箱因为 Exchange 将组织者和与会者之间的关系。</span><span class="sxs-lookup"><span data-stu-id="242a5-144">For example, you cannot import a meeting with attendees into a mailbox because Exchange sets the relationships between the organizer and attendees.</span></span> <br/><span data-ttu-id="242a5-145">仅可以通过发送组织者和与会者接收和响应会议请求中建立这种关系。</span><span class="sxs-lookup"><span data-stu-id="242a5-145">This relationship can only be established by organizers sending and attendees receiving and responding to the meeting request.</span></span><br/><br/><span data-ttu-id="242a5-146">Exchange 中的**约会**对象可以具有复杂的关系和设置。</span><span class="sxs-lookup"><span data-stu-id="242a5-146">**Appointment** objects in Exchange can have complex relationships and settings.</span></span><br/> <span data-ttu-id="242a5-147">有与会者 （会议） 的约会具有会议组织者和与会者将联系在一起的设置。</span><span class="sxs-lookup"><span data-stu-id="242a5-147">Appointments that have attendees (meetings) have settings that tie together the meeting organizer and meeting attendees.</span></span><br/><span data-ttu-id="242a5-148">导出和导入约会时，不会保留这些设置。</span><span class="sxs-lookup"><span data-stu-id="242a5-148">These settings are not maintained when you export and import appointments.</span></span><br/><span data-ttu-id="242a5-149">以编程方式重新建立会议组织者/attendee 关系直接对约会不支持。</span><span class="sxs-lookup"><span data-stu-id="242a5-149">Programmatically reestablishing meeting organizer/attendee relationships directly on the appointments is not supported.</span></span><br/><span data-ttu-id="242a5-150">您具有的重新建立这些关系执行选项然后后处理导入后，具有管理器重新发送会议并已接受会议的与会者。</span><span class="sxs-lookup"><span data-stu-id="242a5-150">An option you do have for reestablishing those relationships is to perform post-processing after an import, then have an organizer resend the meetings and have the attendees accept the meetings.</span></span><br/><span data-ttu-id="242a5-151">您可以使用 Exchange 模拟组织者和与会者发起呼叫。</span><span class="sxs-lookup"><span data-stu-id="242a5-151">You can use Exchange impersonation to make the calls for both the organizer and the attendees.</span></span><br/><span data-ttu-id="242a5-152">若要避免错误地与邮箱中的其他会议的会议导入前，您应更改**Appointment**对象的 UID 属性。</span><span class="sxs-lookup"><span data-stu-id="242a5-152">You should change the UID property of the **Appointment** object before you import to avoid having meetings be incorrectly related to other meetings in a mailbox.</span></span>  <br/> |
|<span data-ttu-id="242a5-153">导出联系人、 电子邮件、 任务或日历项完全保真的的副本。</span><span class="sxs-lookup"><span data-stu-id="242a5-153">Export a copy of a contact, email, task, or calendar item in full-fidelity.</span></span>  <br/> |<span data-ttu-id="242a5-154">不适用</span><span class="sxs-lookup"><span data-stu-id="242a5-154">Not applicable</span></span>  <br/> |[<span data-ttu-id="242a5-155">ExportItems</span><span class="sxs-lookup"><span data-stu-id="242a5-155">ExportItems</span></span>](http://msdn.microsoft.com/library/e2846abb-0b16-4732-bbd8-038a674672f6%28Office.15%29.aspx) <br/> |<span data-ttu-id="242a5-156">这是用于导出要导入回 Exchange 邮箱的邮箱项目的最佳选项。</span><span class="sxs-lookup"><span data-stu-id="242a5-156">This is the best option for exporting mailbox items that you want to import back into an Exchange mailbox.</span></span><br/><span data-ttu-id="242a5-157">您可以使用此选项可邮箱之间复制项。</span><span class="sxs-lookup"><span data-stu-id="242a5-157">You can also use this option to copy items between mailboxes.</span></span><br/><br/><span data-ttu-id="242a5-158">**ExportItems**操作提供不透明的数据流，代表可用于邮箱之间移动信息的项目。</span><span class="sxs-lookup"><span data-stu-id="242a5-158">The **ExportItems** operation provides an opaque stream that represents the item that you can use to move information between mailboxes.</span></span><br/><span data-ttu-id="242a5-159">您可以使用[GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx)操作**ExportItems**使查找另一个系统中的项的索引。</span><span class="sxs-lookup"><span data-stu-id="242a5-159">You can use **ExportItems** with the [GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) operation to make an index for finding the items in another system.</span></span><br/><span data-ttu-id="242a5-160">不能更改导出流。</span><span class="sxs-lookup"><span data-stu-id="242a5-160">You cannot change the export stream.</span></span>  <br/> <span data-ttu-id="242a5-161">有关详细信息，请参阅[导出全保真方式项目](how-to-export-items-by-using-ews-in-exchange.md#bk_exportfullfidelity)。</span><span class="sxs-lookup"><span data-stu-id="242a5-161">For more information, see [Export items with full fidelity](how-to-export-items-by-using-ews-in-exchange.md#bk_exportfullfidelity).</span></span>  <br/> |
|<span data-ttu-id="242a5-162">导入联系人、 电子邮件、 任务或完全保真的中的日历项目的副本。</span><span class="sxs-lookup"><span data-stu-id="242a5-162">Import a copy of a contact, email, task, or calendar item in full-fidelity.</span></span>  <br/> |<span data-ttu-id="242a5-163">不适用</span><span class="sxs-lookup"><span data-stu-id="242a5-163">Not applicable</span></span>  <br/> |[<span data-ttu-id="242a5-164">UploadItems</span><span class="sxs-lookup"><span data-stu-id="242a5-164">UploadItems</span></span>](http://msdn.microsoft.com/library/a88cbe99-7968-454d-a545-4f92c330909f%28Office.15%29.aspx) <br/> |<span data-ttu-id="242a5-165">这是唯一的选项的导入**ExportItems**操作已导出的项目。</span><span class="sxs-lookup"><span data-stu-id="242a5-165">This is the only option for importing items that were exported by the **ExportItems** operation.</span></span>  <br/> |
|<span data-ttu-id="242a5-166">将一个联系人、 电子邮件或日历项一份导出为 MIME 流常见的文件类型。</span><span class="sxs-lookup"><span data-stu-id="242a5-166">Export a copy of a contact, email, or calendar item as a MIME stream for a common file type.</span></span>  <br/> |[<span data-ttu-id="242a5-167">Contact.Bind</span><span class="sxs-lookup"><span data-stu-id="242a5-167">Contact.Bind</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="242a5-168">EmailMessage.Bind</span><span class="sxs-lookup"><span data-stu-id="242a5-168">EmailMessage.Bind</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessage.bind%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="242a5-169">Appointment.Bind</span><span class="sxs-lookup"><span data-stu-id="242a5-169">Appointment.Bind</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment.bind%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="242a5-170">**GetItem**</span><span class="sxs-lookup"><span data-stu-id="242a5-170">**GetItem**</span></span> <br/> |<span data-ttu-id="242a5-171">[MimeContent](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.mimecontent%28v=exchg.80%29.aspx)属性可用于获取项目的 MIME 流表示形式。</span><span class="sxs-lookup"><span data-stu-id="242a5-171">You can use the [MimeContent](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.mimecontent%28v=exchg.80%29.aspx) property to get the MIME stream representation of an item.</span></span><br/><br/><span data-ttu-id="242a5-172">这将在项目上提供基本的所有属性的子集。</span><span class="sxs-lookup"><span data-stu-id="242a5-172">This will provide a basic subset of all the properties on an item.</span></span><br/><span data-ttu-id="242a5-173">作为最佳实践，只能使用一次性操作 MIME 流。</span><span class="sxs-lookup"><span data-stu-id="242a5-173">As a best practice, only use the MIME stream for one-off operations.</span></span><br/><span data-ttu-id="242a5-174">不依赖于 MIME 的较大且常用导入/导出的项目，因为 Exchange 执行内容转换为 MIME，这会影响性能。</span><span class="sxs-lookup"><span data-stu-id="242a5-174">Do not rely on MIME for large and frequent importing/exporting of items, because Exchange performs content conversion for the MIME and this can affect performance.</span></span><br/><br/><span data-ttu-id="242a5-175">**联系人**MIME 流是一个[vCard](http://www.faqs.org/rfcs/rfc2426.html) (.vcf) 文件。</span><span class="sxs-lookup"><span data-stu-id="242a5-175">The **Contact** MIME stream is a [vCard](http://www.faqs.org/rfcs/rfc2426.html) (.vcf) file.</span></span><br/><span data-ttu-id="242a5-176">根据联系人设置的属性，这可能不会产生完全保真的副本。</span><span class="sxs-lookup"><span data-stu-id="242a5-176">Depending on the properties set on a contact, this might not produce a full-fidelity copy.</span></span><br/><span data-ttu-id="242a5-177">请注意，您无法使用该电子名片 MIME 流来导入联系人。</span><span class="sxs-lookup"><span data-stu-id="242a5-177">Note that you cannot import a contact by using the vCard MIME stream.</span></span><br/><span data-ttu-id="242a5-178">若要了解详细信息，请参阅[导出到一个 vCard 文件联系人](how-to-export-items-by-using-ews-in-exchange.md#bk_exportvcardmime)。</span><span class="sxs-lookup"><span data-stu-id="242a5-178">To learn more, see [Export a contact into a vCard file](how-to-export-items-by-using-ews-in-exchange.md#bk_exportvcardmime).</span></span><br/><br/><span data-ttu-id="242a5-179">**EmailMessage** MIME 流是一个.eml 文件。</span><span class="sxs-lookup"><span data-stu-id="242a5-179">The **EmailMessage** MIME stream is an .eml file.</span></span><br/><span data-ttu-id="242a5-180">.Eml 格式是方便，因为 Outlook 和其他电子邮件客户端可以发现它。</span><span class="sxs-lookup"><span data-stu-id="242a5-180">The .eml format is convenient because Outlook and other email clients can identify it.</span></span><br/><span data-ttu-id="242a5-181">MIME 流还可用于创建.mht 文件，这是因为许多浏览器可以使用该文件类型方便。</span><span class="sxs-lookup"><span data-stu-id="242a5-181">You can also use the MIME stream to create an .mht file, which is convenient because many browsers can use that file type.</span></span><br/><span data-ttu-id="242a5-182">EWS 不用于导出到的.msg 文件的电子邮件提供.msg 文件流。</span><span class="sxs-lookup"><span data-stu-id="242a5-182">EWS doesn't provide a .msg file stream for exporting an email to a .msg file.</span></span><br/><span data-ttu-id="242a5-183">用于导出.msg 文件的选项是为[构造。MSG 文件](http://msdn.microsoft.com/en-us/library/cc463912%28v=EXCHG.80%29.aspx)从**EmailMessage.Bind**方法或**GetItem**操作的结果呼叫，或使用第三方 API 调用 EWS 和构造从结果.msg 文件。</span><span class="sxs-lookup"><span data-stu-id="242a5-183">Your options for exporting an .msg file are to either [construct an .MSG file](http://msdn.microsoft.com/en-us/library/cc463912%28v=EXCHG.80%29.aspx) from the results of an **EmailMessage.Bind** method or **GetItem** operation call, or use a third-party API that calls EWS and constructs the .msg file from the results.</span></span><br/><span data-ttu-id="242a5-184">有关详细信息，请参阅[导出电子邮件以.eml 文件](how-to-export-items-by-using-ews-in-exchange.md#bk_exportemailmime)。</span><span class="sxs-lookup"><span data-stu-id="242a5-184">For more information, see [Export an email as an .eml file](how-to-export-items-by-using-ews-in-exchange.md#bk_exportemailmime).</span></span><br/><br/><span data-ttu-id="242a5-185">**约会**MIME 流是一个 iCal (.ics) 文件。</span><span class="sxs-lookup"><span data-stu-id="242a5-185">The **Appointment** MIME stream is an iCal (.ics) file.</span></span><br/><span data-ttu-id="242a5-186">.Ics 格式是方便，因为 Outlook 和其他电子邮件客户端可以发现它。</span><span class="sxs-lookup"><span data-stu-id="242a5-186">The .ics format is convenient because Outlook and other email clients can identify it.</span></span><br/><span data-ttu-id="242a5-187">这不是因为 MIME 用于将 stream 中不提供与会者信息导出会议的可行选项。</span><span class="sxs-lookup"><span data-stu-id="242a5-187">This is not a viable option for exporting meetings because attendee information is not provided in the MIME stream.</span></span> <br/><span data-ttu-id="242a5-188">附件和其他属性可能不会包含 MIME 用于将 stream 中。</span><span class="sxs-lookup"><span data-stu-id="242a5-188">Attachments and other properties might not be included in the MIME stream.</span></span><br/><span data-ttu-id="242a5-189">请考虑构建 iCal 格式从[Appointment](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment%28v=exchg.80%29.aspx)对象或从由**GetItem**操作返回的 XML。</span><span class="sxs-lookup"><span data-stu-id="242a5-189">Consider constructing the iCal format from either the [Appointment](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment%28v=exchg.80%29.aspx) object or from the XML returned by the **GetItem** operation.</span></span><br/><span data-ttu-id="242a5-190">这种方式，您可以捕获多个 Exchange 属性与扩展属性 ("x 属性) iCal 文件中。</span><span class="sxs-lookup"><span data-stu-id="242a5-190">This way, you can capture more of the Exchange properties with extended properties ("X-' properties) in the iCal file.</span></span><br/><span data-ttu-id="242a5-191">您还可以导出的 XML 表单中的约会。</span><span class="sxs-lookup"><span data-stu-id="242a5-191">You can also export an appointment in XML form.</span></span><br/><span data-ttu-id="242a5-192">调用**GetItem**操作并保存在您的系统的 XML。</span><span class="sxs-lookup"><span data-stu-id="242a5-192">Call the **GetItem** operation and save the XML in your system.</span></span><br/><span data-ttu-id="242a5-193">您可以使用 EWS 托管 API 中的[跟踪功能](how-to-trace-requests-responses-to-troubleshoot-ews-managed-api-applications.md)捕获的 XML，置于 XML 数据库。</span><span class="sxs-lookup"><span data-stu-id="242a5-193">You can also use the [tracing functionality](how-to-trace-requests-responses-to-troubleshoot-ews-managed-api-applications.md) in the EWS Managed API to capture the XML to put in an XML database.</span></span><br/><span data-ttu-id="242a5-194">有关详细信息，请参阅[导出 iCal 文件形式的约会](how-to-export-items-by-using-ews-in-exchange.md#bk_exporticalmime)。</span><span class="sxs-lookup"><span data-stu-id="242a5-194">For more information, see [Exporting an appointment as an iCal file](how-to-export-items-by-using-ews-in-exchange.md#bk_exporticalmime).</span></span>  <br/> |
|<span data-ttu-id="242a5-195">导入作为 MIME 流常见的文件类型的电子邮件或日历项目的副本。</span><span class="sxs-lookup"><span data-stu-id="242a5-195">Import a copy of an email or calendar item as a MIME stream for a common file type.</span></span>  <br/> |[<span data-ttu-id="242a5-196">EmailMessage.Save</span><span class="sxs-lookup"><span data-stu-id="242a5-196">EmailMessage.Save</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessage.save%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="242a5-197">Appointment.Save</span><span class="sxs-lookup"><span data-stu-id="242a5-197">Appointment.Save</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment.save%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="242a5-198">**CreateItem**</span><span class="sxs-lookup"><span data-stu-id="242a5-198">**CreateItem**</span></span> <br/> |<span data-ttu-id="242a5-199">您可以通过**EmailMessage**或**约会**对象上使用**MimeContent**属性导入.eml 或.ics 文件。</span><span class="sxs-lookup"><span data-stu-id="242a5-199">You can import an .eml or .ics file by using the **MimeContent** property on an **EmailMessage** or **Appointment** object.</span></span><br/><span data-ttu-id="242a5-200">您需要设置[PidTagMessageFlags (0x0E07)](http://msdn.microsoft.com/en-us/library/office/cc839733%28v=office.15%29.aspx)如果电子邮件不是草稿扩展属性。</span><span class="sxs-lookup"><span data-stu-id="242a5-200">You will need to set the [PidTagMessageFlags (0x0E07)](http://msdn.microsoft.com/en-us/library/office/cc839733%28v=office.15%29.aspx) extended property if the email is not a draft.</span></span><br/><br/><span data-ttu-id="242a5-201">此方法不能用于导入会议。</span><span class="sxs-lookup"><span data-stu-id="242a5-201">You cannot use this approach to import meetings.</span></span>  <br/> |
   
## <a name="alternatives-to-exporting-and-importing-items-by-using-ews"></a><span data-ttu-id="242a5-202">替代项为导出和导入使用 EWS 的项目</span><span class="sxs-lookup"><span data-stu-id="242a5-202">Alternatives to exporting and importing items by using EWS</span></span>
<span data-ttu-id="242a5-203"><a name="alternatives"> </a></span><span class="sxs-lookup"><span data-stu-id="242a5-203"></span></span>

<span data-ttu-id="242a5-204">其他选项供 exporing 和导入项目与 Exchange 邮箱。</span><span class="sxs-lookup"><span data-stu-id="242a5-204">Other options are available for exporing and importing items to and from an Exchange mailbox.</span></span> <span data-ttu-id="242a5-205">设计导入和导出策略的时要考虑的一些方法如下：</span><span class="sxs-lookup"><span data-stu-id="242a5-205">The following are some ideas to consider when you design your import and export strategy:</span></span>
  
- <span data-ttu-id="242a5-206">使用 PowerShell 调用 EWS 和设置输出格式到.csv 文件。</span><span class="sxs-lookup"><span data-stu-id="242a5-206">Use PowerShell to call EWS and format the output into a .csv file.</span></span>
    
- <span data-ttu-id="242a5-207">使用实现 MAPI 导出和导入项目的第三方库。</span><span class="sxs-lookup"><span data-stu-id="242a5-207">Use third-party libraries that implement MAPI to export and import items.</span></span> <span data-ttu-id="242a5-208">第三方库的转换为.msg 文件的 EWS 太均可用。</span><span class="sxs-lookup"><span data-stu-id="242a5-208">Third-party libraries that convert EWS to .msg files are available too.</span></span>
    
- <span data-ttu-id="242a5-209">使用 Exchange 命令行管理程序和[MailboxImportRequest](http://technet.microsoft.com/en-us/library/ff607310%28v=exchg.150%29.aspx)和[MailboxExportRequest](http://technet.microsoft.com/en-us/library/ff607299%28v=exchg.150%29.aspx) cmdlet 为[满足邮箱导入和导出请求](http://technet.microsoft.com/en-us/library/ee633455%28v=exchg.150%29.aspx)。</span><span class="sxs-lookup"><span data-stu-id="242a5-209">Use the Exchange Management Shell and the [MailboxImportRequest](http://technet.microsoft.com/en-us/library/ff607310%28v=exchg.150%29.aspx) and [MailboxExportRequest](http://technet.microsoft.com/en-us/library/ff607299%28v=exchg.150%29.aspx) cmdlets to [fulfill mailbox import and export requests](http://technet.microsoft.com/en-us/library/ee633455%28v=exchg.150%29.aspx).</span></span> 
    
- <span data-ttu-id="242a5-210">使用[Outlook 的导入选项](http://office.microsoft.com/en-us/outlook-help/import-outlook-items-from-an-outlook-data-file-pst-HA102505743.aspx)导入和导出的项目。</span><span class="sxs-lookup"><span data-stu-id="242a5-210">Use [Outlook's import options](http://office.microsoft.com/en-us/outlook-help/import-outlook-items-from-an-outlook-data-file-pst-HA102505743.aspx) to import and export items.</span></span> 
    
## <a name="in-this-section"></a><span data-ttu-id="242a5-211">本节内容</span><span class="sxs-lookup"><span data-stu-id="242a5-211">In this section</span></span>
<span data-ttu-id="242a5-212"><a name="alternatives"> </a></span><span class="sxs-lookup"><span data-stu-id="242a5-212"></span></span>

- [<span data-ttu-id="242a5-213">在 Exchange 使用 EWS 导出项目</span><span class="sxs-lookup"><span data-stu-id="242a5-213">Export items by using EWS in Exchange</span></span>](how-to-export-items-by-using-ews-in-exchange.md)    
- [<span data-ttu-id="242a5-214">在 Exchange 使用 EWS 导入项目</span><span class="sxs-lookup"><span data-stu-id="242a5-214">Import items by using EWS in Exchange</span></span>](how-to-import-items-by-using-ews-in-exchange.md)
    
## <a name="see-also"></a><span data-ttu-id="242a5-215">另请参阅</span><span class="sxs-lookup"><span data-stu-id="242a5-215">See also</span></span>

- [<span data-ttu-id="242a5-216">备份、 还原和灾难恢复</span><span class="sxs-lookup"><span data-stu-id="242a5-216">Backup, Restore, and Disaster Recovery</span></span>](http://technet.microsoft.com/en-us/library/dd876874%28v=exchg.150%29.aspx)  
- [<span data-ttu-id="242a5-217">日记功能</span><span class="sxs-lookup"><span data-stu-id="242a5-217">Journaling</span></span>](http://technet.microsoft.com/en-us/library/aa998649%28v=exchg.150%29.aspx)    
- [<span data-ttu-id="242a5-218">Internet 日历和计划核心对象规范 (RFC 5545)</span><span class="sxs-lookup"><span data-stu-id="242a5-218">Internet Calendaring and Scheduling Core Object Specification (RFC 5545)</span></span>](http://tools.ietf.org/html/rfc5545)   
- [<span data-ttu-id="242a5-219">邮箱同步和交换中的 EWS</span><span class="sxs-lookup"><span data-stu-id="242a5-219">Mailbox synchronization and EWS in Exchange</span></span>](mailbox-synchronization-and-ews-in-exchange.md)
    

