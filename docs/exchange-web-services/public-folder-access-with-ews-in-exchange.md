---
title: 使用 EWS 在 Exchange 公用文件夹访问。
manager: sethgros
ms.date: 7/17/2015
ms.audience: Developer
ms.assetid: d9372057-1deb-45de-8f98-b9149604429a
description: 了解如何使用 EWS 和 EWS 托管 API 访问公用文件夹并路由 Exchange 中的公用文件夹请求。
localization_priority: Priority
ms.openlocfilehash: e921a77b250e11e974b0c47b1d28a8e020837d44
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/03/2020
ms.locfileid: "44460209"
---
# <a name="public-folder-access-with-ews-in-exchange"></a><span data-ttu-id="e1eeb-103">使用 EWS 在 Exchange 公用文件夹访问。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-103">Public folder access with EWS in Exchange</span></span>

<span data-ttu-id="e1eeb-104">了解如何使用 EWS 和 EWS 托管 API 访问公用文件夹并路由 Exchange 中的公用文件夹请求。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-104">Learn about how to use EWS and the EWS Managed API to access public folders and route public folder requests in Exchange.</span></span>
  
<span data-ttu-id="e1eeb-105">公用文件夹提供组织中的用户可以访问的项目的共享存储库。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-105">Public folders provide a shared repository of items that users in your organization can access.</span></span> <span data-ttu-id="e1eeb-106">Office 365、Exchange Online 和本地版本的 Exchange 从 Exchange 2013 开始引入了一个新的公用文件夹体系结构。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-106">Office 365, Exchange Online, and on-premises versions of Exchange starting with Exchange 2013 introduce a new architecture for public folders.</span></span> <span data-ttu-id="e1eeb-107">Exchange 中的公用文件夹使用专用邮箱设计（而不是公用文件夹数据库）来存储公用文件夹层次结构和公用文件夹内容。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-107">Public folders in Exchange use a specialized mailbox design (instead of a public folder database) to store the public folder hierarchy and public folder content.</span></span> <span data-ttu-id="e1eeb-108">公用文件夹权限通过基于角色的访问控制（RBAC）进行管理。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-108">Public folder permissions are managed through Role Based Access Control (RBAC).</span></span>
  
<span data-ttu-id="e1eeb-109">客户端访问技术（如 Exchange Web 服务（EWS）和 EWS 托管 API）提供对公用文件夹层次结构和公用文件夹数据库中的内容项目的编程访问。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-109">Client access technologies, like Exchange Web Services (EWS) and the EWS Managed API, provide programmatic access to both the public folder hierarchy and content items in a public folder database.</span></span> <span data-ttu-id="e1eeb-110">本文提供了有关如何使用 EWS 和 EWS 托管 API 访问公用文件夹和公用文件夹和公用文件夹数据的信息。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-110">This article provides information about how you can use EWS and the EWS Managed API to access public folders and public folders and public folder data.</span></span> 
  
## <a name="ews-operations-and-ews-managed-api-methods-for-public-folder-access"></a><span data-ttu-id="e1eeb-111">用于公用文件夹访问的 EWS 操作和 EWS 托管 API 方法</span><span class="sxs-lookup"><span data-stu-id="e1eeb-111">EWS operations and EWS Managed API methods for public folder access</span></span>
<span data-ttu-id="e1eeb-112"><a name="bk_functionality"> </a></span><span class="sxs-lookup"><span data-stu-id="e1eeb-112"><a name="bk_functionality"> </a></span></span>

<span data-ttu-id="e1eeb-113">大多数核心 EWS 操作都支持公用文件夹访问。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-113">Most of the core EWS operations support public folder access.</span></span> <span data-ttu-id="e1eeb-114">您可以使用下表中列出的文件夹和项目操作以及 EWS 托管的 API 方法来处理公用文件夹。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-114">You can use the folder and item operations and the EWS Managed API methods listed in the following table to work with public folders.</span></span>
  
<span data-ttu-id="e1eeb-115">有关 EWS 托管 API 方法的信息，请参阅[Ews 托管 api 命名空间](https://msdn.microsoft.com/library/jj220535%28v=exchg.80%29.aspx)。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-115">For information about EWS Managed API methods, see [EWS Managed API namespaces](https://msdn.microsoft.com/library/jj220535%28v=exchg.80%29.aspx).</span></span>
  
|<span data-ttu-id="e1eeb-116">**EWS 操作**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-116">**EWS operation**</span></span>|<span data-ttu-id="e1eeb-117">**EWS 托管的 API 方法**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-117">**EWS Managed API method**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="e1eeb-118">CreateFolder 操作</span><span class="sxs-lookup"><span data-stu-id="e1eeb-118">CreateFolder operation</span></span>](https://msdn.microsoft.com/library/6f6c334c-b190-4e55-8f0a-38f2a018d1b3%28Office.15%29.aspx) <br/> |<span data-ttu-id="e1eeb-119">**文件夹. Save （）**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-119">**Folder.Save()**</span></span> <br/> |
|[<span data-ttu-id="e1eeb-120">UpdateFolder 操作</span><span class="sxs-lookup"><span data-stu-id="e1eeb-120">UpdateFolder operation</span></span>](https://msdn.microsoft.com/library/3494c996-b834-4813-b1ca-d99642d8b4e7%28Office.15%29.aspx) <br/> |<span data-ttu-id="e1eeb-121">**Folder. Update （）**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-121">**Folder.Update()**</span></span> <br/> |
|[<span data-ttu-id="e1eeb-122">DeleteFolder 操作</span><span class="sxs-lookup"><span data-stu-id="e1eeb-122">DeleteFolder operation</span></span>](https://msdn.microsoft.com/library/b0f92682-4895-4bcf-a4a1-e4c2e8403979%28Office.15%29.aspx) <br/> |<span data-ttu-id="e1eeb-123">**Folder。 Delete （）**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-123">**Folder.Delete()**</span></span> <br/> |
|<span data-ttu-id="e1eeb-124">[MoveFolder 操作](https://msdn.microsoft.com/library/c7233966-6c87-4a14-8156-b1610760176d%28Office.15%29.aspx)<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="e1eeb-124">[MoveFolder operation](https://msdn.microsoft.com/library/c7233966-6c87-4a14-8156-b1610760176d%28Office.15%29.aspx)<sup>1</sup></span></span> <br/> |<span data-ttu-id="e1eeb-125">**Folder. Move （）**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-125">**Folder.Move()**</span></span> <br/> |
|<span data-ttu-id="e1eeb-126">[CopyFolder 操作](https://msdn.microsoft.com/library/c7ea0d68-9793-4144-b378-d99536776db9%28Office.15%29.aspx)<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="e1eeb-126">[CopyFolder operation](https://msdn.microsoft.com/library/c7ea0d68-9793-4144-b378-d99536776db9%28Office.15%29.aspx)<sup>2</sup></span></span> <br/> |<span data-ttu-id="e1eeb-127">**Folder （）**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-127">**Folder.Copy()**</span></span> <br/> |
|[<span data-ttu-id="e1eeb-128">GetFolder 操作</span><span class="sxs-lookup"><span data-stu-id="e1eeb-128">GetFolder operation</span></span>](https://msdn.microsoft.com/library/355bcf93-dc71-4493-b177-622afac5fdb9%28Office.15%29.aspx) <br/> |<span data-ttu-id="e1eeb-129">**文件夹绑定（）**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-129">**Folder.Bind()**</span></span> <br/> |
|<span data-ttu-id="e1eeb-130">[EmptyFolder 操作](https://msdn.microsoft.com/library/98161486-e2f2-480f-8d5d-708ba81b208a%28Office.15%29.aspx)<sup>3</sup></span><span class="sxs-lookup"><span data-stu-id="e1eeb-130">[EmptyFolder operation](https://msdn.microsoft.com/library/98161486-e2f2-480f-8d5d-708ba81b208a%28Office.15%29.aspx)<sup>3</sup></span></span> <br/> |<span data-ttu-id="e1eeb-131">**Folder。空（）**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-131">**Folder.Empty()**</span></span> <br/> |
|[<span data-ttu-id="e1eeb-132">FindFolder 操作</span><span class="sxs-lookup"><span data-stu-id="e1eeb-132">FindFolder operation</span></span>](https://msdn.microsoft.com/library/7a9855aa-06cc-45ba-ad2a-645c15b7d031%28Office.15%29.aspx) <br/> |<span data-ttu-id="e1eeb-133">**ExchangeService FindFolders （）**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-133">**ExchangeService.FindFolders()**</span></span> <br/> <span data-ttu-id="e1eeb-134">**FindFolders （）**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-134">**Folder.FindFolders()**</span></span> <br/> |
|[<span data-ttu-id="e1eeb-135">CreateItem 操作</span><span class="sxs-lookup"><span data-stu-id="e1eeb-135">CreateItem operation</span></span>](https://msdn.microsoft.com/library/78a52120-f1d0-4ed7-8748-436e554f75b6%28Office.15%29.aspx) <br/> |<span data-ttu-id="e1eeb-136">**Item. Save （）**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-136">**Item.Save()**</span></span> <br/> |
|[<span data-ttu-id="e1eeb-137">MoveItem 操作</span><span class="sxs-lookup"><span data-stu-id="e1eeb-137">MoveItem operation</span></span>](https://msdn.microsoft.com/library/dcf40fa7-7796-4a5c-bf5b-7a509a18d208%28Office.15%29.aspx) <br/> |<span data-ttu-id="e1eeb-138">**Item。 Move （）**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-138">**Item.Move()**</span></span> <br/> |
|[<span data-ttu-id="e1eeb-139">CopyItem 操作</span><span class="sxs-lookup"><span data-stu-id="e1eeb-139">CopyItem operation</span></span>](https://msdn.microsoft.com/library/bcc68f9e-d511-4c29-bba6-ed535524624a%28Office.15%29.aspx) <br/> |<span data-ttu-id="e1eeb-140">**Item. Copy （）**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-140">**Item.Copy()**</span></span> <br/> |
|[<span data-ttu-id="e1eeb-141">UpdateItem 操作</span><span class="sxs-lookup"><span data-stu-id="e1eeb-141">UpdateItem operation</span></span>](https://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx) <br/> |<span data-ttu-id="e1eeb-142">**Item。 Update （）**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-142">**Item.Update()**</span></span> <br/> |
|[<span data-ttu-id="e1eeb-143">DeleteItem 操作</span><span class="sxs-lookup"><span data-stu-id="e1eeb-143">DeleteItem operation</span></span>](https://msdn.microsoft.com/library/3e26c416-fa12-476e-bfd2-5c1f4bb7b348%28Office.15%29.aspx) <br/> |<span data-ttu-id="e1eeb-144">**Item。 Delete （）**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-144">**Item.Delete()**</span></span> <br/> |
|<span data-ttu-id="e1eeb-145">[FindItem 操作](https://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx)<sup>4</sup></span><span class="sxs-lookup"><span data-stu-id="e1eeb-145">[FindItem operation](https://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx)<sup>4</sup></span></span> <br/> |<span data-ttu-id="e1eeb-146">**ExchangeService FindItems （）**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-146">**ExchangeService.FindItems()**</span></span> <br/> <span data-ttu-id="e1eeb-147">**FindItems （）**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-147">**Folder.FindItems()**</span></span> <br/> |
|[<span data-ttu-id="e1eeb-148">GetItem 操作</span><span class="sxs-lookup"><span data-stu-id="e1eeb-148">GetItem operation</span></span>](https://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) <br/> |<span data-ttu-id="e1eeb-149">**Item. Bind （）**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-149">**Item.Bind()**</span></span> <br/> |
|<span data-ttu-id="e1eeb-150">[ConvertId 操作](https://msdn.microsoft.com/library/47d96cf6-9e2f-4fc0-9682-7258d3fbf918%28Office.15%29.aspx)<sup>5</sup></span><span class="sxs-lookup"><span data-stu-id="e1eeb-150">[ConvertId operation](https://msdn.microsoft.com/library/47d96cf6-9e2f-4fc0-9682-7258d3fbf918%28Office.15%29.aspx)<sup>5</sup></span></span> <br/> |<span data-ttu-id="e1eeb-151">**ExchangeService ConvertId （）**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-151">**ExchangeService.ConvertId()**</span></span> <br/> <span data-ttu-id="e1eeb-152">**ExchangeService ConvertIds （）**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-152">**ExchangeService.ConvertIds()**</span></span> <br/> |
   
<span data-ttu-id="e1eeb-153"><sup>1</sup>在从 exchange 2013 开始的 exchange 版本中，在公用文件夹和私有文件夹之间移动文件夹的版本不可用。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-153"><sup>1</sup> Moving folders between a public folder and private folder is not available in versions of Exchange starting with Exchange 2013.</span></span> 
  
<span data-ttu-id="e1eeb-154"><sup>2</sup>此操作仅适用于 exchange server 2007 和 exchange server 2010 中的公用文件夹。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-154"><sup>2</sup> This operation is only applicable to public folders in Exchange Server 2007 and Exchange Server 2010.</span></span> 
  
<span data-ttu-id="e1eeb-155"><sup>3</sup>此操作仅适用于 Exchange 2010 中的公用文件夹。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-155"><sup>3</sup> This operation is only applicable to public folders in Exchange 2010.</span></span> 
  
<span data-ttu-id="e1eeb-156"><sup>4</sup>通过从 exchange 2013 开始的 exchange 版本中支持查询字符串搜索选项，在单个公用文件夹中对单个公用文件夹中的全文索引搜索。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-156"><sup>4</sup> Full text indexed search within a single public folder by means of the QueryString search option is supported in versions of Exchange starting with Exchange 2013.</span></span> 
  
<span data-ttu-id="e1eeb-157"><sup>5</sup> ConvertId 操作不能将公用文件夹标识符从 EWS 标识符正确转换为存储标识符。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-157"><sup>5</sup> The ConvertId operation does not correctly convert public folder identifiers from the EWS identifier to the store identifier.</span></span> <span data-ttu-id="e1eeb-158">您可以手动更新作为[解决方法](https://msdn.microsoft.com/library/47d96cf6-9e2f-4fc0-9682-7258d3fbf918%28Office.15%29.aspx#bk_usingConvertId)返回的标识符。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-158">You can manually update the identifier that is returned as a [workaround](https://msdn.microsoft.com/library/47d96cf6-9e2f-4fc0-9682-7258d3fbf918%28Office.15%29.aspx#bk_usingConvertId).</span></span>
  
<span data-ttu-id="e1eeb-159">对于从 Exchange 2013 开始的 Exchange 版本中的公用文件夹，不支持或部分支持以下操作：</span><span class="sxs-lookup"><span data-stu-id="e1eeb-159">The following operations are not supported, or are partially supported, for public folders in versions of Exchange starting with Exchange 2013:</span></span>
  
- <span data-ttu-id="e1eeb-160">**CopyFolder** （不支持）。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-160">**CopyFolder** (not supported).</span></span> <span data-ttu-id="e1eeb-161">可以将**CreateFolder**与**CopyItems**操作一起使用，以实现**CopyFolder**操作功能。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-161">You can use **CreateFolder** with the **CopyItems** operation to implement **CopyFolder** operation functionality.</span></span> 
    
- <span data-ttu-id="e1eeb-162">**EmptyFolder** （不支持）。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-162">**EmptyFolder** (not supported).</span></span> <span data-ttu-id="e1eeb-163">可以将**FindItem**与**DeleteItem**操作一起使用，以实现**EmptyFolder**操作功能。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-163">You can use **FindItem** with the **DeleteItem** operation to implement **EmptyFolder** operation functionality.</span></span> 
    
- <span data-ttu-id="e1eeb-164">**MoveFolder** （部分受支持）。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-164">**MoveFolder** (partially supported).</span></span> <span data-ttu-id="e1eeb-165">无法在私有和公用文件夹之间移动文件夹。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-165">You cannot move folders between private and public folders.</span></span> <span data-ttu-id="e1eeb-166">您可以在 Exchange 2007 和 Exchange 2010 中的私人文件夹和公用文件夹之间移动文件夹。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-166">You can move folders between private and public folders in Exchange 2007 and Exchange 2010.</span></span> <span data-ttu-id="e1eeb-167">您可以在 Exchange 的所有版本中移动公用文件夹内的文件夹。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-167">You can move folders within a public folder in all versions of Exchange.</span></span> 
    
<span data-ttu-id="e1eeb-168">EWS 和 EWS 托管 API 不支持用于公用文件夹的以下功能：</span><span class="sxs-lookup"><span data-stu-id="e1eeb-168">EWS and the EWS Managed API do not support the following functionality for public folders:</span></span>
  
- <span data-ttu-id="e1eeb-169">使用**SyncFolderHierarchy**。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-169">Using **SyncFolderHierarchy**.</span></span> <span data-ttu-id="e1eeb-170">使用**FindFolder**、 **GetFolder**和**SyncFolderItems**操作在公用文件夹邮箱中同步项目和文件夹。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-170">Use the **FindFolder**, **GetFolder** and **SyncFolderItems** operations to synchronize items and folders in a public folder mailbox.</span></span> 
    
- <span data-ttu-id="e1eeb-171">对公用文件夹层次结构的深层遍历搜索。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-171">Deep-traversal searches of a public folder hierarchy.</span></span> <span data-ttu-id="e1eeb-172">使用递归**FindFolder**操作调用遍历公用文件夹层次结构。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-172">Use recursive **FindFolder** operation calls to traverse the public folder hierarchy.</span></span> 
    
- <span data-ttu-id="e1eeb-173">使用**CreateFolderPath**操作创建公用文件夹的文件夹层次结构。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-173">Using the **CreateFolderPath** operation to create a folder hierarchy for public folders.</span></span> <span data-ttu-id="e1eeb-174">当您针对公用文件夹邮箱时，您需要在不同的文件夹层次结构中对每个文件夹级别使用**CreateFolder**操作。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-174">You will need to use the **CreateFolder** operation for each folder level in a distinct folder hierarchy when you target a public folder mailbox.</span></span> 
    
- <span data-ttu-id="e1eeb-175">使用**CreateItem**操作保存已发送电子邮件的副本。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-175">Using the **CreateItem** operation to save copies of sent email messages.</span></span> <span data-ttu-id="e1eeb-176">而是使用**MoveItem**操作将邮件的副本移动到公用文件夹中。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-176">Instead, use the **MoveItem** operation to move a copy of the message into a public folder.</span></span> 
    
## <a name="scenarios-for-using-ews-and-the-ews-managed-api-to-work-with-public-folders"></a><span data-ttu-id="e1eeb-177">使用 EWS 和 EWS 托管 API 处理公用文件夹的方案</span><span class="sxs-lookup"><span data-stu-id="e1eeb-177">Scenarios for using EWS and the EWS Managed API to work with public folders</span></span>
<span data-ttu-id="e1eeb-178"><a name="bk_scenarios"> </a></span><span class="sxs-lookup"><span data-stu-id="e1eeb-178"><a name="bk_scenarios"> </a></span></span>

<span data-ttu-id="e1eeb-179">公用文件夹为 Exchange 邮箱用户启用了许多重要的方案。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-179">Public folders enable many important scenarios for Exchange mailbox users.</span></span> <span data-ttu-id="e1eeb-180">您可以通过使用 EWS 和 EWS 托管 API 为用户实现用于访问和使用公用文件夹及其内容的自定义解决方案。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-180">You can empower users by using EWS and the EWS Managed API to implement custom solutions for accessing and using public folders and their contents.</span></span> 
  
### <a name="programmatically-access-email-messages-that-have-been-sent-to-distribution-lists"></a><span data-ttu-id="e1eeb-181">以编程方式访问已发送到通讯组列表的电子邮件</span><span class="sxs-lookup"><span data-stu-id="e1eeb-181">Programmatically access email messages that have been sent to distribution lists</span></span>

<span data-ttu-id="e1eeb-182">Exchange 邮箱用户可以使用公用文件夹来存储发送到通讯组列表的电子邮件。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-182">Exchange mailbox users can use public folders to store email messages that are sent to distribution lists.</span></span> <span data-ttu-id="e1eeb-183">这是保存通讯组列表历史记录的简便方法。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-183">This is a convenient way to save distribution list history.</span></span> <span data-ttu-id="e1eeb-184">您可以使用 EWS 中的[FindItem 操作](https://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx)，或使用 EWS 托管 API 中的**ExchangeService （）** 和**Folder FindItems （）** 方法来访问存储的通讯组列表电子邮件。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-184">You can use the [FindItem operation](https://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx) in EWS or the **ExchangeService.FindItems()** and **Folder.FindItems()** methods in the EWS Managed API to access stored distribution list email messages.</span></span> 
  
### <a name="share-important-email-messages-and-other-mailbox-items"></a><span data-ttu-id="e1eeb-185">共享重要的电子邮件和其他邮箱项目</span><span class="sxs-lookup"><span data-stu-id="e1eeb-185">Share important email messages and other mailbox items</span></span>

<span data-ttu-id="e1eeb-186">邮箱用户可以将公用文件夹用作邮箱项目的共享存储库。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-186">Mailbox users can use public folders as a shared repository for mailbox items.</span></span> <span data-ttu-id="e1eeb-187">组织中的不同用户可以通过使用公用文件夹来共享重要的电子邮件或联系人。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-187">Different users in an organization can share important email messages or contacts by using public folders.</span></span> <span data-ttu-id="e1eeb-188">EWS 可提供对这些共享邮箱项目的访问权限。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-188">EWS can provide the access to these shared mailbox items.</span></span> <span data-ttu-id="e1eeb-189">您可以使用 EWS 中的[MoveItem 操作](https://msdn.microsoft.com/library/dcf40fa7-7796-4a5c-bf5b-7a509a18d208%28Office.15%29.aspx)或在 EWS 托管 API 中的**Item （）** 方法将电子邮件、联系人和其他邮箱项目移入和移出公用文件夹。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-189">You can use the [MoveItem operation](https://msdn.microsoft.com/library/dcf40fa7-7796-4a5c-bf5b-7a509a18d208%28Office.15%29.aspx) in EWS or the **Item.Move()** method in the EWS Managed API to move email messages, contacts, and other mailbox items into and out of a public folder.</span></span> 
  
### <a name="public-discussions-with-post-items"></a><span data-ttu-id="e1eeb-190">包含帖子项的公共讨论</span><span class="sxs-lookup"><span data-stu-id="e1eeb-190">Public discussions with post items</span></span>

<span data-ttu-id="e1eeb-191">公用文件夹是用于发布项目的方便容器。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-191">Public folders are a convenient container for post items.</span></span> <span data-ttu-id="e1eeb-192">发布项提供了一种使用对话对话的方法，而无需在用户之间发送电子邮件。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-192">Post items provide a way to use threaded conversations without having to send email messages between users.</span></span> <span data-ttu-id="e1eeb-193">用户可以使用公用文件夹和发布项目来托管和维护组织中不同邮箱用户之间的线程对话。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-193">Users can use public folders and post items to host and maintain threaded conversations between different mailbox users in an organization.</span></span> <span data-ttu-id="e1eeb-194">这样，邮箱用户可以访问使用 post 项目的会话的共享历史记录，即使它们不是会话的一部分也是如此。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-194">This way, mailbox users can access the shared history of a conversation that uses post items even if they were not part of the conversation.</span></span> <span data-ttu-id="e1eeb-195">您可以使用 ews 托管 API 中的[CreateItem 操作](https://msdn.microsoft.com/library/78a52120-f1d0-4ed7-8748-436e554f75b6%28Office.15%29.aspx)或在 EWS 托管 API 中的**Item （）** 方法来创建和响应存储在公用文件夹中的发布项目。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-195">You can use the [CreateItem operation](https://msdn.microsoft.com/library/78a52120-f1d0-4ed7-8748-436e554f75b6%28Office.15%29.aspx) in EWS or the **Item.Save()** method in the EWS Managed API to both create and respond to post items stored in a public folder.</span></span> 
  
## <a name="routing-public-folder-requests"></a><span data-ttu-id="e1eeb-196">路由公用文件夹请求</span><span class="sxs-lookup"><span data-stu-id="e1eeb-196">Routing public folder requests</span></span>
<span data-ttu-id="e1eeb-197"><a name="bk_routing"> </a></span><span class="sxs-lookup"><span data-stu-id="e1eeb-197"><a name="bk_routing"> </a></span></span>

<span data-ttu-id="e1eeb-198">公用文件夹内容可以存储在多个邮箱服务器上。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-198">Public folder content can be stored on multiple mailbox servers.</span></span> <span data-ttu-id="e1eeb-199">公用文件夹层次结构可以存储在一个邮箱上，而公用文件夹的内容存储在另一个邮箱中。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-199">The public folder hierarchy can be stored on one mailbox, while the content for the public folder is stored on another.</span></span> <span data-ttu-id="e1eeb-200">每个服务器可以与请求信息的用户的邮箱服务器不同。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-200">And each of these servers can be different than the mailbox server for the user requesting the information.</span></span> <span data-ttu-id="e1eeb-201">在这些情况下，重要的是要在公用文件夹请求中包含额外的 X-anchormailbox 和 PublicFolderMailbox 标头，以接收有关公用文件夹的准确信息。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-201">In these situations, it's important to include the additional X-AnchorMailbox and X-PublicFolderMailbox headers in your public folder requests to receive accurate information about public folders.</span></span>
  
<span data-ttu-id="e1eeb-202">X-X-anchormailbox 和 X-PublicFolderMailbox 的值可能有所不同，具体取决于您是否在执行与文件夹层次结构或文件夹内容相关的请求。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-202">The value for the X-AnchorMailbox and X-PublicFolderMailbox can differ depending on whether you're performing a request related to the folder hierarchy or the folder content.</span></span> <span data-ttu-id="e1eeb-203">下表列出了每个 EWS 托管 API 方法或 EWS 操作应遵循的过程。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-203">The following table identifies which procedure to follow for each EWS Managed API method or EWS operation.</span></span>
  
<span data-ttu-id="e1eeb-204">**用于路由公用文件夹请求的 EWS 托管 API 方法和 EWS 操作**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-204">**EWS Managed API methods and EWS operations for routing public folder requests**</span></span>

|<span data-ttu-id="e1eeb-205">**调用这些方法时**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-205">**When calling these methods**</span></span>|<span data-ttu-id="e1eeb-206">**调用这些操作时**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-206">**When calling these operations**</span></span>|<span data-ttu-id="e1eeb-207">**使用此过程**</span><span class="sxs-lookup"><span data-stu-id="e1eeb-207">**Use this procedure**</span></span>|
|:-----|:-----|:-----|
|[<span data-ttu-id="e1eeb-208">FindFolders</span><span class="sxs-lookup"><span data-stu-id="e1eeb-208">Folder.FindFolders</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.folder.findfolders%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="e1eeb-209">文件夹。删除</span><span class="sxs-lookup"><span data-stu-id="e1eeb-209">Folder.Delete</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.folder.delete%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="e1eeb-210">文件夹。更新</span><span class="sxs-lookup"><span data-stu-id="e1eeb-210">Folder.Update</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.folder.update%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="e1eeb-211">Folder。 Move</span><span class="sxs-lookup"><span data-stu-id="e1eeb-211">Folder.Move</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.folder.move%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="e1eeb-212">CreateFolder</span><span class="sxs-lookup"><span data-stu-id="e1eeb-212">CreateFolder</span></span>](https://msdn.microsoft.com/library/6f6c334c-b190-4e55-8f0a-38f2a018d1b3%28Office.15%29.aspx) <br/> [<span data-ttu-id="e1eeb-213">FindFolder</span><span class="sxs-lookup"><span data-stu-id="e1eeb-213">FindFolder</span></span>](https://msdn.microsoft.com/library/7a9855aa-06cc-45ba-ad2a-645c15b7d031%28Office.15%29.aspx) <br/> [<span data-ttu-id="e1eeb-214">DeleteFolder</span><span class="sxs-lookup"><span data-stu-id="e1eeb-214">DeleteFolder</span></span>](https://msdn.microsoft.com/library/b0f92682-4895-4bcf-a4a1-e4c2e8403979%28Office.15%29.aspx) <br/> [<span data-ttu-id="e1eeb-215">UpdateFolder</span><span class="sxs-lookup"><span data-stu-id="e1eeb-215">UpdateFolder</span></span>](https://msdn.microsoft.com/library/3494c996-b834-4813-b1ca-d99642d8b4e7%28Office.15%29.aspx) <br/> [<span data-ttu-id="e1eeb-216">MoveFolder</span><span class="sxs-lookup"><span data-stu-id="e1eeb-216">MoveFolder</span></span>](https://msdn.microsoft.com/library/c7233966-6c87-4a14-8156-b1610760176d%28Office.15%29.aspx) <br/> |<span data-ttu-id="e1eeb-217">路由公用文件夹层次结构请求</span><span class="sxs-lookup"><span data-stu-id="e1eeb-217">Routing public folder hierarchy requests</span></span>  <br/> |
|[<span data-ttu-id="e1eeb-218">Item.Bind</span><span class="sxs-lookup"><span data-stu-id="e1eeb-218">Item.Bind</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="e1eeb-219">Item.Update</span><span class="sxs-lookup"><span data-stu-id="e1eeb-219">Item.Update</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.update%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="e1eeb-220">项。复制</span><span class="sxs-lookup"><span data-stu-id="e1eeb-220">Item.Copy</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.copy%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="e1eeb-221">Item。 Move</span><span class="sxs-lookup"><span data-stu-id="e1eeb-221">Item.Move</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.move%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="e1eeb-222">Item.Delete</span><span class="sxs-lookup"><span data-stu-id="e1eeb-222">Item.Delete</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.delete%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="e1eeb-223">文件夹。绑定</span><span class="sxs-lookup"><span data-stu-id="e1eeb-223">Folder.Bind</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.folder.bind%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="e1eeb-224">FindItems</span><span class="sxs-lookup"><span data-stu-id="e1eeb-224">Folder.FindItems</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.folder.finditems%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="e1eeb-225">CreateItem</span><span class="sxs-lookup"><span data-stu-id="e1eeb-225">CreateItem</span></span>](https://msdn.microsoft.com/library/78a52120-f1d0-4ed7-8748-436e554f75b6%28Office.15%29.aspx) <br/> [<span data-ttu-id="e1eeb-226">GetItem</span><span class="sxs-lookup"><span data-stu-id="e1eeb-226">GetItem</span></span>](https://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) <br/> [<span data-ttu-id="e1eeb-227">UpdateItem</span><span class="sxs-lookup"><span data-stu-id="e1eeb-227">UpdateItem</span></span>](https://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx) <br/> [<span data-ttu-id="e1eeb-228">CopyItem</span><span class="sxs-lookup"><span data-stu-id="e1eeb-228">CopyItem</span></span>](https://msdn.microsoft.com/library/bcc68f9e-d511-4c29-bba6-ed535524624a%28Office.15%29.aspx) <br/> [<span data-ttu-id="e1eeb-229">MoveItem</span><span class="sxs-lookup"><span data-stu-id="e1eeb-229">MoveItem</span></span>](https://msdn.microsoft.com/library/dcf40fa7-7796-4a5c-bf5b-7a509a18d208%28Office.15%29.aspx) <br/> [<span data-ttu-id="e1eeb-230">DeleteItem</span><span class="sxs-lookup"><span data-stu-id="e1eeb-230">DeleteItem</span></span>](../web-service-reference/deleteitem-operation.md) <br/> [<span data-ttu-id="e1eeb-231">GetFolder</span><span class="sxs-lookup"><span data-stu-id="e1eeb-231">GetFolder</span></span>](https://msdn.microsoft.com/library/355bcf93-dc71-4493-b177-622afac5fdb9%28Office.15%29.aspx) <br/> [<span data-ttu-id="e1eeb-232">FindItem</span><span class="sxs-lookup"><span data-stu-id="e1eeb-232">FindItem</span></span>](https://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx) <br/> |<span data-ttu-id="e1eeb-233">路由公用文件夹内容请求</span><span class="sxs-lookup"><span data-stu-id="e1eeb-233">Routing public folder content requests</span></span>  <br/> |
   
## <a name="version-differences"></a><span data-ttu-id="e1eeb-234">版本差异</span><span class="sxs-lookup"><span data-stu-id="e1eeb-234">Version differences</span></span>
<span data-ttu-id="e1eeb-235"><a name="VersionDifferences"> </a></span><span class="sxs-lookup"><span data-stu-id="e1eeb-235"><a name="VersionDifferences"> </a></span></span>

<span data-ttu-id="e1eeb-236">在 Exchange 2007 和 Exchange 2010 中，当将公用文件夹标识符从 EWS 标识符转换为存储标识符时， **ConvertId**操作将按预期方式工作。</span><span class="sxs-lookup"><span data-stu-id="e1eeb-236">In Exchange 2007 and Exchange 2010, the **ConvertId** operation works as expected when converting public folder identifiers from the EWS identifier to the store identifier.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="e1eeb-237">另请参阅</span><span class="sxs-lookup"><span data-stu-id="e1eeb-237">See also</span></span>


- [<span data-ttu-id="e1eeb-238">开发 Exchange Web 服务客户端</span><span class="sxs-lookup"><span data-stu-id="e1eeb-238">Develop web service clients for Exchange</span></span>](develop-web-service-clients-for-exchange.md)
    
- [<span data-ttu-id="e1eeb-239">Start using web services in Exchange</span><span class="sxs-lookup"><span data-stu-id="e1eeb-239">Start using web services in Exchange</span></span>](start-using-web-services-in-exchange.md)
    
- [<span data-ttu-id="e1eeb-240">公用文件夹限制</span><span class="sxs-lookup"><span data-stu-id="e1eeb-240">Public folder limits</span></span>](https://technet.microsoft.com/library/dn594582%28v=exchg.150%29.aspx)
    
- [<span data-ttu-id="e1eeb-241">FAQ：公用文件夹</span><span class="sxs-lookup"><span data-stu-id="e1eeb-241">FAQ: Public Folders</span></span>](https://technet.microsoft.com/library/jj552408.aspx)
    
- [<span data-ttu-id="e1eeb-242">公用文件夹过程</span><span class="sxs-lookup"><span data-stu-id="e1eeb-242">Public Folder Procedures</span></span>](https://technet.microsoft.com/library/jj657481.aspx)
    

