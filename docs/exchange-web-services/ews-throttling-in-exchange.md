---
title: 限制在 Exchange 中的 EWS
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: b4fff4c9-c625-4d2a-9d14-bb28a5da5baf
description: 了解如何使用 Exchange 时影响 EWS 的限制策略。
ms.openlocfilehash: 64393c173a6fc60cd4be969e8c7457d5b0109713
ms.sourcegitcommit: 9061fcf40c218ebe88911783f357b7df278846db
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/28/2018
ms.locfileid: "21354013"
---
# <a name="ews-throttling-in-exchange"></a><span data-ttu-id="b81f7-103">限制在 Exchange 中的 EWS</span><span class="sxs-lookup"><span data-stu-id="b81f7-103">EWS throttling in Exchange</span></span>

<span data-ttu-id="b81f7-104">了解如何使用 Exchange 时影响 EWS 的限制策略。</span><span class="sxs-lookup"><span data-stu-id="b81f7-104">Learn about the throttling policies that affect EWS when you are using Exchange.</span></span>
  
<span data-ttu-id="b81f7-105">**提供者：** Glen 标尺;Michael Mainer，Microsoft Corporation</span><span class="sxs-lookup"><span data-stu-id="b81f7-105">**Provided by:** Glen Scales; Michael Mainer, Microsoft Corporation</span></span> 
  
<span data-ttu-id="b81f7-106">文章提供有关 EWS 限制在 Exchange Online，Exchange Online 作为 Office 365 的一部分的信息和内部部署 Exchange 2010 开头的 Exchange 版本。</span><span class="sxs-lookup"><span data-stu-id="b81f7-106">The article provides information about EWS throttling in Exchange Online, Exchange Online as part of Office 365, and on-premises versions of Exchange starting with Exchange 2010.</span></span> <span data-ttu-id="b81f7-107">在 Exchange 限制有助于确保通过限制的单个用户或应用程序可以使用的服务器资源数量的服务器的可靠性和正常运行时间。</span><span class="sxs-lookup"><span data-stu-id="b81f7-107">Throttling in Exchange helps to ensure server reliability and uptime by limiting the amount of server resources that a single user or application can consume.</span></span> <span data-ttu-id="b81f7-108">限制是服务可靠性和功能可能会影响的系统资源过度使用的反应响应。</span><span class="sxs-lookup"><span data-stu-id="b81f7-108">Throttling is a reactive response to overuse of system resources that may affect service reliability and functionality.</span></span> <span data-ttu-id="b81f7-109">Exchange 持续监视关键基础结构的资源，如邮箱数据库的运行状况。</span><span class="sxs-lookup"><span data-stu-id="b81f7-109">Exchange constantly monitors the health of critical infrastructure resources, such as mailbox databases.</span></span> <span data-ttu-id="b81f7-110">高负载因素检测到的降低这些资源的性能时, EWS 连接将受到控制按比例基于每个呼叫者有贡献此高负载条件的金额。</span><span class="sxs-lookup"><span data-stu-id="b81f7-110">When high load factors are detected that degrade the performance of these resources, EWS connections are throttled proportionally based on the amount that each caller has contributed to this high load condition.</span></span> <span data-ttu-id="b81f7-111">结果是用户可能会在其限制的限制内，仍然遇到瓶颈，直到资源的运行状况回操作级别。</span><span class="sxs-lookup"><span data-stu-id="b81f7-111">The result is that a user may be within their throttling limit and still experience slowdowns until the health of the resource is back to operational levels.</span></span>
  
<span data-ttu-id="b81f7-112">在 Exchange，包括 EWS，每个客户端访问协议具有限制策略。</span><span class="sxs-lookup"><span data-stu-id="b81f7-112">Each client access protocol in Exchange, including EWS, has a throttling policy.</span></span> <span data-ttu-id="b81f7-113">在设计使用 EWS 的应用程序时，务必帐户限制策略，以帮助确保应用程序的可靠性和您的 Exchange 服务器的运行状况。</span><span class="sxs-lookup"><span data-stu-id="b81f7-113">When you design applications that use EWS, it is important to account for throttling policies, to help ensure application reliability and the health of your Exchange server.</span></span> <span data-ttu-id="b81f7-114">本文 ews，标识的不同的限制策略和服务限制是否面向的 Exchange Online 或 Exchange 内部部署 Exchange Server 2010 开头的版本。</span><span class="sxs-lookup"><span data-stu-id="b81f7-114">This article identifies the different throttling policies and service limits for EWS, whether you are targeting Exchange Online or versions of Exchange on-premises starting with Exchange Server 2010.</span></span> <span data-ttu-id="b81f7-115">如果适用，本文还标识限制策略不同版本的 Exchange 中的差异。</span><span class="sxs-lookup"><span data-stu-id="b81f7-115">As applicable, this article also identifies differences in throttling policies in different versions of Exchange.</span></span>
  
> [!IMPORTANT]
> <span data-ttu-id="b81f7-116">默认限制策略、 Exchange Online 和 Exchange 内部部署的访问限制策略，并限制策略配置不同。</span><span class="sxs-lookup"><span data-stu-id="b81f7-116">Default throttling policy, access to throttling policy, and throttling policy configuration differs between Exchange Online and Exchange on-premises.</span></span> <span data-ttu-id="b81f7-117">特定的限制设置值才准确的特定的 Exchange 版本。</span><span class="sxs-lookup"><span data-stu-id="b81f7-117">Specific throttling setting values are only accurate for a specific version of Exchange.</span></span> <span data-ttu-id="b81f7-118">由于设置值会有所不同跨版本，并且 Exchange 管理员可以更改默认限制策略的内部部署，本文不提供包含默认设置值。</span><span class="sxs-lookup"><span data-stu-id="b81f7-118">Because setting values vary across versions, and because Exchange administrators can change the default throttling policies for on-premises deployments, this article does not provide the default setting values.</span></span> <span data-ttu-id="b81f7-119">很多重要为您要注意的设计的应用程序功能内节流限制结果，并适当地对限制方案时的注意事项。</span><span class="sxs-lookup"><span data-stu-id="b81f7-119">It is more important for you to be aware of the considerations for designing an application that functions within throttling limits and reacts appropriately to throttling scenarios.</span></span> 
  
<span data-ttu-id="b81f7-120">如果您是应用程序开发人员，您需要因素到应用程序设计限制。</span><span class="sxs-lookup"><span data-stu-id="b81f7-120">If you are an application developer, you need to factor throttling into your application design.</span></span> <span data-ttu-id="b81f7-121">不同版本的 Exchange 具有不同的默认值为 EWS 限制参数。</span><span class="sxs-lookup"><span data-stu-id="b81f7-121">Different versions of Exchange have different default values for the EWS throttling parameters.</span></span> <span data-ttu-id="b81f7-122">旨在访问不同版本的 Exchange 的客户端与服务应用程序将需要考虑这些设置，它们是默认值，Exchange 管理员，设置的自定义值还是，如 Exchange Online，默认情况下设置，而不可供搜索。</span><span class="sxs-lookup"><span data-stu-id="b81f7-122">Client and service applications that are designed to access different versions of Exchange will need to account for these settings, whether they be default values, custom values set by an Exchange administrator, or, as for Exchange Online, set by default and not discoverable.</span></span> <span data-ttu-id="b81f7-123">限制参数值不能以编程方式发现，因为您的客户端设计规范应包括规划适应节流限制的不同潜在的应用程序。</span><span class="sxs-lookup"><span data-stu-id="b81f7-123">Because throttling parameter values cannot be discovered programmatically, your client design specifications should include a plan for the application to adapt to different potential throttling limits.</span></span> <span data-ttu-id="b81f7-124">多线程访问应用程序将大量邮箱，在设计时或在多个客户端访问的同一邮箱时，考虑对默认策略应用于 Exchange 的并发的限制。</span><span class="sxs-lookup"><span data-stu-id="b81f7-124">When you design multithreaded applications that will access a large number of mailboxes, or when many clients are accessing the same mailbox, consider the limits on concurrency that the default policy applies to Exchange.</span></span> 
  
## <a name="throttling-policies-that-affect-ews"></a><span data-ttu-id="b81f7-125">影响 EWS 的限制策略</span><span class="sxs-lookup"><span data-stu-id="b81f7-125">Throttling policies that affect EWS</span></span>
<span data-ttu-id="b81f7-126"><a name="bk_PolicyParameters"> </a></span><span class="sxs-lookup"><span data-stu-id="b81f7-126"></span></span>

<span data-ttu-id="b81f7-127">限制策略在 Office Outlook、 Outlook Web App 和 Exchange ActiveSync 的 Exchange 影响不仅 EWS，而且所有有还客户端连接到 Exchange 服务器，包括协议使用。</span><span class="sxs-lookup"><span data-stu-id="b81f7-127">The throttling polices in Exchange affect not only EWS, but also all client connections to the Exchange server, including the protocols used by Office Outlook, Outlook Web App, and Exchange ActiveSync.</span></span> 
  
<span data-ttu-id="b81f7-128">运行 Exchange 2010 时， **CPUStartPercent**限制策略可能会影响 EWS 性能。</span><span class="sxs-lookup"><span data-stu-id="b81f7-128">The **CPUStartPercent** throttling policy can affect EWS performance when you are running Exchange 2010.</span></span> <span data-ttu-id="b81f7-129">当 Exchange 的平均 CPU 使用率处理客户端访问服务器上运行 — 包括但不是限于 EWS 过程 — 超过指定此策略的值，入站的请求将延迟以减少 CPU 使用率。</span><span class="sxs-lookup"><span data-stu-id="b81f7-129">When the average CPU utilization of Exchange processes running on the Client Access server — including, but not limited to, the EWS process — exceeds the value specified by this policy, inbound requests will be delayed to reduce CPU utilization.</span></span> <span data-ttu-id="b81f7-130">不能更改此策略的值，但了解有关该产品可帮助您解决性能问题。</span><span class="sxs-lookup"><span data-stu-id="b81f7-130">You cannot change the value of this policy, but knowing about it can help you troubleshoot performance issues.</span></span> <span data-ttu-id="b81f7-131">客户端访问服务器执行此值采样逻辑平均通过滚动窗口 10 秒。</span><span class="sxs-lookup"><span data-stu-id="b81f7-131">The sampling logic the Client Access server performs for this value is an average over a 10 second rolling window.</span></span> <span data-ttu-id="b81f7-132">这样，正确响应快速高峰 CPU 利用率的过程。</span><span class="sxs-lookup"><span data-stu-id="b81f7-132">This allows the process to respond appropriately to quick spikes in CPU utilization.</span></span> <span data-ttu-id="b81f7-133">当超过此阈值时，延迟为 EWS 的入站的连接。</span><span class="sxs-lookup"><span data-stu-id="b81f7-133">When this threshold is exceeded, inbound connections to EWS are delayed.</span></span> <span data-ttu-id="b81f7-134">在每次 EWS 请求理论 100 %cpu 使用率情况下，此延迟上限为 500 毫秒 （毫秒）。</span><span class="sxs-lookup"><span data-stu-id="b81f7-134">This delay is capped at 500 milliseconds (msecs) at a theoretical 100% CPU usage per EWS request.</span></span> <span data-ttu-id="b81f7-135">如果传递批处理 EWS 请求以获取 100 个项目，则服务器将检查的 CPU 使用率 100 次 （一次每个项目） 的最大延迟为 50 秒。</span><span class="sxs-lookup"><span data-stu-id="b81f7-135">If a batch EWS request to get 100 items is passed, the server will check the CPU usage 100 times (once per item) for a maximum delay of 50 seconds.</span></span> <span data-ttu-id="b81f7-136">线性向 CPU 的使用率成比例延迟时间。</span><span class="sxs-lookup"><span data-stu-id="b81f7-136">The delay time is linearly proportional to CPU usage.</span></span> <span data-ttu-id="b81f7-137">在**CPUStartPercent**，延迟为 0 （线程收益），并且会增加线性达 500 毫秒在 100%的 CPU 使用率。</span><span class="sxs-lookup"><span data-stu-id="b81f7-137">At **CPUStartPercent**, the delay is 0 (a thread yield) and it increases linearly up to 500 msec at 100% CPU usage.</span></span> <span data-ttu-id="b81f7-138">限制策略应用于所有的 Exchange 用户，因为不太可能的 CPU 使用率超过**CPUStartPercent**限制在 Exchange 客户端访问服务器上，因为各个用户或应用程序无法获得影响足够 CPU 使用率服务器操作。</span><span class="sxs-lookup"><span data-stu-id="b81f7-138">Because throttling policies apply to all Exchange users, it's unlikely that CPU usage would exceed the **CPUStartPercent** limit on an Exchange Client Access server, because individual users or applications cannot gain enough CPU utilization to affect server operation.</span></span> 
  
<span data-ttu-id="b81f7-139">下表列出了影响使用 EWS 的应用程序的限制策略参数。</span><span class="sxs-lookup"><span data-stu-id="b81f7-139">The following table lists the throttling policy parameters that affect applications that use EWS.</span></span>
  
<span data-ttu-id="b81f7-140">**表 1： 限制影响 EWS 的策略参数**</span><span class="sxs-lookup"><span data-stu-id="b81f7-140">**Table 1: Throttling policy parameters that affect EWS**</span></span>

|<span data-ttu-id="b81f7-141">**限制策略参数名称**</span><span class="sxs-lookup"><span data-stu-id="b81f7-141">**Throttling policy parameter name**</span></span>|<span data-ttu-id="b81f7-142">**适用于**</span><span class="sxs-lookup"><span data-stu-id="b81f7-142">**Applies to**</span></span>|<span data-ttu-id="b81f7-143">**说明**</span><span class="sxs-lookup"><span data-stu-id="b81f7-143">**Description**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="b81f7-144">**DiscoveryMaxConcurrency**</span><span class="sxs-lookup"><span data-stu-id="b81f7-144">**DiscoveryMaxConcurrency**</span></span> <br/> |<span data-ttu-id="b81f7-145">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="b81f7-145">Exchange 2013</span></span>  <br/> <span data-ttu-id="b81f7-146">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="b81f7-146">Exchange Online</span></span>  <br/> |<span data-ttu-id="b81f7-147">指定用户可同时拥有的并发发现搜索连接数。</span><span class="sxs-lookup"><span data-stu-id="b81f7-147">Specifies the number of concurrent discovery search connections that a user can have at the same time.</span></span>  <br/> |
|<span data-ttu-id="b81f7-148">**DiscoveryMaxKeywords**</span><span class="sxs-lookup"><span data-stu-id="b81f7-148">**DiscoveryMaxKeywords**</span></span> <br/> |<span data-ttu-id="b81f7-149">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="b81f7-149">Exchange 2013</span></span>  <br/> <span data-ttu-id="b81f7-150">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="b81f7-150">Exchange Online</span></span>  <br/> |<span data-ttu-id="b81f7-151">指定用户可在发现搜索在搜索中包括的关键字的最大数量。</span><span class="sxs-lookup"><span data-stu-id="b81f7-151">Specifies the maximum number of keywords that a user can include in a discovery search.</span></span>  <br/> |
|<span data-ttu-id="b81f7-152">**DiscoveryMaxKeywordsPerPage**</span><span class="sxs-lookup"><span data-stu-id="b81f7-152">**DiscoveryMaxKeywordsPerPage**</span></span> <br/> |<span data-ttu-id="b81f7-153">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="b81f7-153">Exchange 2013</span></span>  <br/> <span data-ttu-id="b81f7-154">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="b81f7-154">Exchange Online</span></span>  <br/> |<span data-ttu-id="b81f7-155">指定要显示的统计信息的关键词数量。</span><span class="sxs-lookup"><span data-stu-id="b81f7-155">Specifies the number of keywords for which to show statistics.</span></span>  <br/> |
|<span data-ttu-id="b81f7-156">**DiscoveryMaxMailboxes**</span><span class="sxs-lookup"><span data-stu-id="b81f7-156">**DiscoveryMaxMailboxes**</span></span> <br/> |<span data-ttu-id="b81f7-157">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="b81f7-157">Exchange 2013</span></span>  <br/> <span data-ttu-id="b81f7-158">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="b81f7-158">Exchange Online</span></span>  <br/> |<span data-ttu-id="b81f7-159">指定用户可在发现搜索在搜索中包括的源邮箱的最大数。</span><span class="sxs-lookup"><span data-stu-id="b81f7-159">Specifies the maximum number of source mailboxes that a user can include in a discovery search.</span></span>  <br/> |
|<span data-ttu-id="b81f7-160">**DiscoveryMaxMailboxesResultsOnly**</span><span class="sxs-lookup"><span data-stu-id="b81f7-160">**DiscoveryMaxMailboxesResultsOnly**</span></span> <br/> |<span data-ttu-id="b81f7-161">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="b81f7-161">Exchange 2013</span></span>  <br/> <span data-ttu-id="b81f7-162">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="b81f7-162">Exchange Online</span></span>  <br/> |<span data-ttu-id="b81f7-163">指定可以在就地电子数据展示搜索的邮箱的最大数目而不需要能够查看的统计信息的搜索。</span><span class="sxs-lookup"><span data-stu-id="b81f7-163">Specifies the maximum number of mailboxes you can search in an In-Place eDiscovery search without being able to view the statistics.</span></span>  <br/> |
|<span data-ttu-id="b81f7-164">**DiscoveryPreviewSearchResultsPageSize**</span><span class="sxs-lookup"><span data-stu-id="b81f7-164">**DiscoveryPreviewSearchResultsPageSize**</span></span> <br/> |<span data-ttu-id="b81f7-165">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="b81f7-165">Exchange 2013</span></span>  <br/> <span data-ttu-id="b81f7-166">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="b81f7-166">Exchange Online</span></span>  <br/> |<span data-ttu-id="b81f7-167">指定电子数据展示搜索预览响应中返回的消息的数。</span><span class="sxs-lookup"><span data-stu-id="b81f7-167">Specifies the number of messages returned in a eDiscovery search preview response.</span></span>  <br/> |
|<span data-ttu-id="b81f7-168">**EwsCutoffBalance**</span><span class="sxs-lookup"><span data-stu-id="b81f7-168">**EwsCutoffBalance**</span></span> <br/> |<span data-ttu-id="b81f7-169">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="b81f7-169">Exchange 2013</span></span>  <br/> <span data-ttu-id="b81f7-170">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="b81f7-170">Exchange Online</span></span>  <br/> |<span data-ttu-id="b81f7-171">该用户从特定组件上执行操作完全被阻止之前，请定义 EWS 用户的资源消耗量限制。</span><span class="sxs-lookup"><span data-stu-id="b81f7-171">Defines the resource consumption limits for EWS user before that user is completely blocked from performing operations on a specific component.</span></span>  <br/> |
|<span data-ttu-id="b81f7-172">**EwsMaxBurst**</span><span class="sxs-lookup"><span data-stu-id="b81f7-172">**EwsMaxBurst**</span></span> <br/> |<span data-ttu-id="b81f7-173">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="b81f7-173">Exchange 2013</span></span>  <br/> <span data-ttu-id="b81f7-174">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="b81f7-174">Exchange Online</span></span>  <br/> |<span data-ttu-id="b81f7-175">定义 EWS 用户可以被阻止之前使用提升的资源数量的时间量。</span><span class="sxs-lookup"><span data-stu-id="b81f7-175">Defines the amount of time that an EWS user can consume an elevated amount of resources before being throttled.</span></span> <span data-ttu-id="b81f7-176">这被以毫秒为单位。</span><span class="sxs-lookup"><span data-stu-id="b81f7-176">This is measured in milliseconds.</span></span> <span data-ttu-id="b81f7-177">此值将为每个组件的单独。</span><span class="sxs-lookup"><span data-stu-id="b81f7-177">This value is set separately for each component.</span></span>  <br/> |
|<span data-ttu-id="b81f7-178">**EwsRechargeRate**</span><span class="sxs-lookup"><span data-stu-id="b81f7-178">**EwsRechargeRate**</span></span> <br/> |<span data-ttu-id="b81f7-179">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="b81f7-179">Exchange 2013</span></span>  <br/> <span data-ttu-id="b81f7-180">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="b81f7-180">Exchange Online</span></span>  <br/> |<span data-ttu-id="b81f7-181">定义 EWS 用户的预算再充电频率的速率 （预算增长速率） 在预算时间。</span><span class="sxs-lookup"><span data-stu-id="b81f7-181">Defines the rate at which an EWS user's budget is recharged (budget grows by) during the budget time.</span></span>  <br/> |
|<span data-ttu-id="b81f7-182">**EWSMaxSubscriptions**</span><span class="sxs-lookup"><span data-stu-id="b81f7-182">**EWSMaxSubscriptions**</span></span> <br/> |<span data-ttu-id="b81f7-183">Exchange 2010</span><span class="sxs-lookup"><span data-stu-id="b81f7-183">Exchange 2010</span></span>  <br/> <span data-ttu-id="b81f7-184">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="b81f7-184">Exchange 2013</span></span>  <br/> <span data-ttu-id="b81f7-185">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="b81f7-185">Exchange Online</span></span>  <br/> |<span data-ttu-id="b81f7-186">定义 active 推送、 提取、 和流式处理用户可同时拥有特定客户端访问服务器的通知订阅的最大数目。</span><span class="sxs-lookup"><span data-stu-id="b81f7-186">Defines the maximum number of active push, pull, and streaming notification subscriptions that a user can have on a specific Client Access server at one time.</span></span> <span data-ttu-id="b81f7-187">这是不同的 Exchange 版本不同预算。</span><span class="sxs-lookup"><span data-stu-id="b81f7-187">This is budgeted differently for different Exchange versions.</span></span>  <br/> |
|<span data-ttu-id="b81f7-188">**EWSFastSearchTimeoutInSeconds**</span><span class="sxs-lookup"><span data-stu-id="b81f7-188">**EWSFastSearchTimeoutInSeconds**</span></span> <br/> |<span data-ttu-id="b81f7-189">Exchange 2010</span><span class="sxs-lookup"><span data-stu-id="b81f7-189">Exchange 2010</span></span>  <br/> |<span data-ttu-id="b81f7-190">以秒为单位的 fast 搜索所做的 EWS 中使用 Exchange 搜索继续之前它们超时定义的时间量。Fast 搜索是在[FindItem 操作](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx)中使用高级查询语法 (AQS) 查询字符串进行搜索。</span><span class="sxs-lookup"><span data-stu-id="b81f7-190">Defines the amount of time in seconds that fast searches made by using Exchange Search in EWS continue before they time out. Fast searches are searches made by using an Advanced Query Syntax (AQS) query string in a [FindItem operation](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx).</span></span>  <br/> |
|<span data-ttu-id="b81f7-191">**EWSFindCountLimit**</span><span class="sxs-lookup"><span data-stu-id="b81f7-191">**EWSFindCountLimit**</span></span> <br/> |<span data-ttu-id="b81f7-192">Exchange 2010</span><span class="sxs-lookup"><span data-stu-id="b81f7-192">Exchange 2010</span></span>  <br/> <span data-ttu-id="b81f7-193">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="b81f7-193">Exchange 2013</span></span>  <br/> <span data-ttu-id="b81f7-194">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="b81f7-194">Exchange Online</span></span>  <br/> |<span data-ttu-id="b81f7-195">一次一个用户的客户端访问服务器上的内存中定义从[FindItem 操作](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx)或[FindFolder 操作](http://msdn.microsoft.com/library/7a9855aa-06cc-45ba-ad2a-645c15b7d031%28Office.15%29.aspx)可存在的项的最大数目。</span><span class="sxs-lookup"><span data-stu-id="b81f7-195">Defines the maximum number of items from a [FindItem operation](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx) or [FindFolder operation](http://msdn.microsoft.com/library/7a9855aa-06cc-45ba-ad2a-645c15b7d031%28Office.15%29.aspx) that can exist in memory on the Client Access server at one time for one user.</span></span> <span data-ttu-id="b81f7-196">此属性的默认值为 1000年。</span><span class="sxs-lookup"><span data-stu-id="b81f7-196">The default value for this property is 1000.</span></span> <span data-ttu-id="b81f7-197">此值[回退值](http://technet.microsoft.com/en-us/library/dd297964%28v=exchg.141%29.aspx#fallback)为 1000年。</span><span class="sxs-lookup"><span data-stu-id="b81f7-197">The [fallback value](http://technet.microsoft.com/en-us/library/dd297964%28v=exchg.141%29.aspx#fallback)for this value is 1000.</span></span>  <br/> <span data-ttu-id="b81f7-198">在 Exchange Online 和 Exchange 开头 Exchange 2013 内部部署版本中，不能查询或通过 cmdlet 配置的此限制策略。</span><span class="sxs-lookup"><span data-stu-id="b81f7-198">In Exchange Online and on-premises versions of Exchange starting with Exchange 2013, this throttling policy cannot be queried or configured by a cmdlet.</span></span> <span data-ttu-id="b81f7-199">在 Exchange Online 和本地版本的 Exchange 开头 Exchange 2013、 [AQS](how-to-perform-an-aqs-search-by-using-ews-in-exchange.md)搜索 EWSFindCountLimit 和任何 Exchange 搜索带限制是 250 个结果。</span><span class="sxs-lookup"><span data-stu-id="b81f7-199">In Exchange Online and on-premises versions of Exchange starting with Exchange 2013, the EWSFindCountLimit for [AQS search](how-to-perform-an-aqs-search-by-using-ews-in-exchange.md) and any Exchange search with a restriction is 250 results.</span></span> <span data-ttu-id="b81f7-200">无限制 Exchange 搜索将返回最多 1000年结果。</span><span class="sxs-lookup"><span data-stu-id="b81f7-200">An Exchange search without a restriction will return up to 1000 results.</span></span>  <br/> |
|<span data-ttu-id="b81f7-201">**EWSPercentTimeInAD**</span><span class="sxs-lookup"><span data-stu-id="b81f7-201">**EWSPercentTimeInAD**</span></span> <br/> |<span data-ttu-id="b81f7-202">Exchange 2010</span><span class="sxs-lookup"><span data-stu-id="b81f7-202">Exchange 2010</span></span>  <br/> |<span data-ttu-id="b81f7-203">定义每分钟特定用户可以在此期间执行 Active Directory 请求的时间的百分比。</span><span class="sxs-lookup"><span data-stu-id="b81f7-203">Defines the percentage of time per minute during which a specific user can execute Active Directory requests.</span></span>  <br/> |
|<span data-ttu-id="b81f7-204">**EWSPercentTimeInCAS**</span><span class="sxs-lookup"><span data-stu-id="b81f7-204">**EWSPercentTimeInCAS**</span></span> <br/> |<span data-ttu-id="b81f7-205">Exchange 2010</span><span class="sxs-lookup"><span data-stu-id="b81f7-205">Exchange 2010</span></span>  <br/> |<span data-ttu-id="b81f7-206">定义每分钟的特定用户可以在此期间执行客户端访问服务器代码的时间的百分比。</span><span class="sxs-lookup"><span data-stu-id="b81f7-206">Defines the percentage of time per minute during which a specific user can execute Client Access server code.</span></span>  <br/> |
|<span data-ttu-id="b81f7-207">**EWSPercentTimeInMailboxRPC**</span><span class="sxs-lookup"><span data-stu-id="b81f7-207">**EWSPercentTimeInMailboxRPC**</span></span> <br/> |<span data-ttu-id="b81f7-208">Exchange 2010</span><span class="sxs-lookup"><span data-stu-id="b81f7-208">Exchange 2010</span></span>  <br/> |<span data-ttu-id="b81f7-209">定义每分钟的特定用户可以在此期间执行邮箱 RPC 请求的时间的百分比</span><span class="sxs-lookup"><span data-stu-id="b81f7-209">Defines the percentage of time per minute during which a specific user can execute mailbox RPC requests</span></span>  <br/> |
|<span data-ttu-id="b81f7-210">**EWSMaxConcurrency**</span><span class="sxs-lookup"><span data-stu-id="b81f7-210">**EWSMaxConcurrency**</span></span> <br/> |<span data-ttu-id="b81f7-211">Exchange 2010</span><span class="sxs-lookup"><span data-stu-id="b81f7-211">Exchange 2010</span></span>  <br/> <span data-ttu-id="b81f7-212">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="b81f7-212">Exchange 2013</span></span>  <br/> <span data-ttu-id="b81f7-213">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="b81f7-213">Exchange Online</span></span>  <br/> |<span data-ttu-id="b81f7-214">定义特定用户可以针对一次使用 EWS 的 Exchange server 的并发打开连接的数。</span><span class="sxs-lookup"><span data-stu-id="b81f7-214">Defines the number of concurrent open connections that a specific user can have against an Exchange server that is using EWS at one time.</span></span> <span data-ttu-id="b81f7-215">Exchange 2010 的默认值为 10。</span><span class="sxs-lookup"><span data-stu-id="b81f7-215">The default value for Exchange 2010 is 10.</span></span> <span data-ttu-id="b81f7-216">Exchange 2013 和 Exchange Online 的默认值为 27。</span><span class="sxs-lookup"><span data-stu-id="b81f7-216">The default value for Exchange 2013 and Exchange Online is 27.</span></span>  <br/> <span data-ttu-id="b81f7-217">此策略应用于除流式处理通知的所有操作。</span><span class="sxs-lookup"><span data-stu-id="b81f7-217">This policy applies to all operations except for streaming notifications.</span></span> <span data-ttu-id="b81f7-218">流式通知使用**HangingConnectionLimit**指示打开可用的流式事件连接数。</span><span class="sxs-lookup"><span data-stu-id="b81f7-218">Streaming notifications use the **HangingConnectionLimit** to indicate the number of open streaming event connections that are available.</span></span> <span data-ttu-id="b81f7-219">有关详细信息，请参阅[我需要考虑哪些限制值？](how-to-maintain-affinity-between-group-of-subscriptions-and-mailbox-server.md#bk_throttling)。</span><span class="sxs-lookup"><span data-stu-id="b81f7-219">For more information, see [What throttling values do I need to take into consideration?](how-to-maintain-affinity-between-group-of-subscriptions-and-mailbox-server.md#bk_throttling).</span></span>  <br/> |
|<span data-ttu-id="b81f7-220">**MessageRateLimit**</span><span class="sxs-lookup"><span data-stu-id="b81f7-220">**MessageRateLimit**</span></span> <br/> |<span data-ttu-id="b81f7-221">Exchange 2010</span><span class="sxs-lookup"><span data-stu-id="b81f7-221">Exchange 2010</span></span>  <br/> <span data-ttu-id="b81f7-222">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="b81f7-222">Exchange 2013</span></span>  <br/> <span data-ttu-id="b81f7-223">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="b81f7-223">Exchange Online</span></span>  <br/> |<span data-ttu-id="b81f7-224">定义每分钟可以提交的消息的数。</span><span class="sxs-lookup"><span data-stu-id="b81f7-224">Defines the number of messages per minute that can be submitted.</span></span>  <br/> |
|<span data-ttu-id="b81f7-225">**RecipientRateLimit**</span><span class="sxs-lookup"><span data-stu-id="b81f7-225">**RecipientRateLimit**</span></span> <br/> |<span data-ttu-id="b81f7-226">Exchange 2010</span><span class="sxs-lookup"><span data-stu-id="b81f7-226">Exchange 2010</span></span>  <br/> <span data-ttu-id="b81f7-227">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="b81f7-227">Exchange 2013</span></span>  <br/> <span data-ttu-id="b81f7-228">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="b81f7-228">Exchange Online</span></span>  <br/> |<span data-ttu-id="b81f7-229">定义为用户在 24 小时内可以解决的收件人数的限制。</span><span class="sxs-lookup"><span data-stu-id="b81f7-229">Defines the limit to the number of recipients that a user can address in a 24-hour period.</span></span>  <br/> |
|<span data-ttu-id="b81f7-230">**ForwardeeLimit**</span><span class="sxs-lookup"><span data-stu-id="b81f7-230">**ForwardeeLimit**</span></span> <br/> |<span data-ttu-id="b81f7-231">Exchange 2010</span><span class="sxs-lookup"><span data-stu-id="b81f7-231">Exchange 2010</span></span>  <br/> <span data-ttu-id="b81f7-232">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="b81f7-232">Exchange 2013</span></span>  <br/> <span data-ttu-id="b81f7-233">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="b81f7-233">Exchange Online</span></span>  <br/> |<span data-ttu-id="b81f7-234">定义对收件人的收件箱转接/重定向操作的数量在 24 小时内的限制。</span><span class="sxs-lookup"><span data-stu-id="b81f7-234">Defines the limit to the number of recipients for Inbox forward/redirect actions in a 24-hour period.</span></span>  <br/> |
   
> [!CAUTION]
> <span data-ttu-id="b81f7-235">未设置为**null**限制策略。</span><span class="sxs-lookup"><span data-stu-id="b81f7-235">Do not set throttling polices to **null**.</span></span> <span data-ttu-id="b81f7-236">这将设置等于不受限制，这表明未设置限制策略的策略。</span><span class="sxs-lookup"><span data-stu-id="b81f7-236">This will set the policy to equal unlimited, which indicates that a throttling policy isn't set.</span></span> 
  
## <a name="displaying-the-policies-that-apply-to-exchange-mailboxes"></a><span data-ttu-id="b81f7-237">显示适用于 Exchange 邮箱的策略</span><span class="sxs-lookup"><span data-stu-id="b81f7-237">Displaying the policies that apply to Exchange mailboxes</span></span>
<span data-ttu-id="b81f7-238"><a name="bk_PolicyCmdlets"> </a></span><span class="sxs-lookup"><span data-stu-id="b81f7-238"></span></span>

<span data-ttu-id="b81f7-239">Exchange 内部部署提供了可用于设置和获取限制策略的 Exchange 命令行管理程序 cmdlet。</span><span class="sxs-lookup"><span data-stu-id="b81f7-239">Exchange on-premises provides Exchange Management Shell cmdlets that you can use to set and get throttling policy.</span></span> <span data-ttu-id="b81f7-240">Exchange Online 不提供对的限制策略 cmdlet 的访问。</span><span class="sxs-lookup"><span data-stu-id="b81f7-240">Exchange Online does not provide access to the throttling policy cmdlets.</span></span>
  
<span data-ttu-id="b81f7-241">您可以使用以下 cmdlet 以显示限制策略的内部部署 Exchange Server 部署：</span><span class="sxs-lookup"><span data-stu-id="b81f7-241">You can use the following cmdlets to display throttling polices for an on-premises Exchange Server deployment:</span></span>
  
- <span data-ttu-id="b81f7-242">**Get-throttlingpolicy** — 获取限制设置为一个或多个客户端限制策略。</span><span class="sxs-lookup"><span data-stu-id="b81f7-242">**Get-ThrottlingPolicy** — Gets the client throttling settings for one or more throttling policies.</span></span> <span data-ttu-id="b81f7-243">有关详细信息，请参阅 TechNet 上的[Get-throttlingpolicy](http://technet.microsoft.com/en-us/library/dd351264.aspx) 。</span><span class="sxs-lookup"><span data-stu-id="b81f7-243">For more information, see [Get-ThrottlingPolicy ](http://technet.microsoft.com/en-us/library/dd351264.aspx) on TechNet.</span></span> 
    
- <span data-ttu-id="b81f7-244">**Get ThrottlingPolicyAssociation** — 使您能够查看对象和其关联的限制策略之间的关系。</span><span class="sxs-lookup"><span data-stu-id="b81f7-244">**Get-ThrottlingPolicyAssociation** — Enables you to view the relationship between an object and its associated throttling policies.</span></span> <span data-ttu-id="b81f7-245">该对象可以是具有邮箱的用户、 没有邮箱或联系人的用户。</span><span class="sxs-lookup"><span data-stu-id="b81f7-245">The object can be a user with a mailbox, a user without a mailbox, or a contact.</span></span> <span data-ttu-id="b81f7-246">有关详细信息，请参阅 TechNet 上的[Get ThrottlingPolicyAssociation](http://technet.microsoft.com/en-us/library/ff459241.aspx) 。</span><span class="sxs-lookup"><span data-stu-id="b81f7-246">For more information, see [Get-ThrottlingPolicyAssociation](http://technet.microsoft.com/en-us/library/ff459241.aspx) on TechNet.</span></span> 
    
<span data-ttu-id="b81f7-247">使用以下命令以显示默认限制策略对于 Exchange 2010。</span><span class="sxs-lookup"><span data-stu-id="b81f7-247">Use the following command to show the default throttling policy for Exchange 2010.</span></span>
  
<span data-ttu-id="b81f7-248">**Get-throttlingpolicy |Where-object {$_。IsDefault-eq"True"} |格式列表**</span><span class="sxs-lookup"><span data-stu-id="b81f7-248">**Get-ThrottlingPolicy | Where-Object {$_.IsDefault -eq "True"} | format-list**</span></span>
  
<span data-ttu-id="b81f7-249">使用以下命令以显示 （这相当于默认限制策略在 Exchange 2010） 的全局限制策略在 Exchange 2013。</span><span class="sxs-lookup"><span data-stu-id="b81f7-249">Use the following command to show the global throttling policy (which equates to the default throttling policy in Exchange 2010) in Exchange 2013.</span></span>
  
<span data-ttu-id="b81f7-250">**Get-throttlingpolicy |Where-object {$_。ThrottlingPolicyScope-eq"全局"} |格式列表**</span><span class="sxs-lookup"><span data-stu-id="b81f7-250">**Get-ThrottlingPolicy | Where-Object {$_.ThrottlingPolicyScope -eq "Global"} | format-list**</span></span>
  
<span data-ttu-id="b81f7-251">使用以下命令来显示限制策略与用户关联在 Exchange 2010 或 Exchange 2013。</span><span class="sxs-lookup"><span data-stu-id="b81f7-251">Use the following command to show the throttling policy associated with a user in Exchange 2010 or Exchange 2013.</span></span> <span data-ttu-id="b81f7-252">用户名称 john@contoso.com 替换为您要为其获取限制策略信息的目标用户的用户名。</span><span class="sxs-lookup"><span data-stu-id="b81f7-252">Replace the user name john@contoso.com with the user name of the target user for whom you want to get throttling policy information.</span></span>
  
<span data-ttu-id="b81f7-253">**Get ThrottlingPolicyAssociation john@contoso.com |格式列表**</span><span class="sxs-lookup"><span data-stu-id="b81f7-253">**Get-ThrottlingPolicyAssociation john@contoso.com | format-list**</span></span>
  
<span data-ttu-id="b81f7-254">运行此命令在 Exchange 命令行管理程序将导致类似于以下输出。</span><span class="sxs-lookup"><span data-stu-id="b81f7-254">Running this command in Exchange Management Shell results in an output similar to the following.</span></span>
  
```powershell
PS C:\>Get-ThrottlingPolicyAssociation john@contoso.com
RunspaceId               : 72153d6-9dce-2fae-8dbd-5ca5f760g2df
ObjectId                 : john
ThrottlingPolicyId       :
Name                     : john
Identity                 : FHXB-28178dom.contoso.com/Users/john
IsValid                  : True
NeedsToSuppressPii       : False
ExchangeVersion          : 0.10 (15.0.0.0)
DistinguishedName        : CN=john,CN=Users,DC=FHXB-28178dom,DC=contoso,DC=com
Guid                     : 2c10dab6-de28-1937-ad8g-535832613a08
```

> [!NOTE]
> <span data-ttu-id="b81f7-255">空白**ThrottlingPolicyId**属性时，默认策略应用于邮箱。</span><span class="sxs-lookup"><span data-stu-id="b81f7-255">When the **ThrottlingPolicyId** property is blank, the default policy is applied to the mailbox.</span></span> 
  
<span data-ttu-id="b81f7-256">您可以设置使用[Set-throttlingpolicy](http://technet.microsoft.com/en-us/library/dd298094.aspx)和[设置 ThrottlingPolicyAssociation](http://technet.microsoft.com/en-us/library/ff459231.aspx) cmdlet 限制 Exchange 服务器上的策略。</span><span class="sxs-lookup"><span data-stu-id="b81f7-256">You can set throttling policy on an Exchange server by using the [Set-ThrottlingPolicy](http://technet.microsoft.com/en-us/library/dd298094.aspx) and [Set-ThrottlingPolicyAssociation](http://technet.microsoft.com/en-us/library/ff459231.aspx) cmdlets.</span></span> <span data-ttu-id="b81f7-257">您可以创建和删除非默认限制策略使用[New-throttlingpolicy](http://technet.microsoft.com/en-us/library/dd351045.aspx)和[Remove-throttlingpolicy](http://technet.microsoft.com/en-us/library/dd351178.aspx) cmdlet。</span><span class="sxs-lookup"><span data-stu-id="b81f7-257">You can create and remove nondefault throttling policies by using the [New-ThrottlingPolicy](http://technet.microsoft.com/en-us/library/dd351045.aspx) and [Remove-ThrottlingPolicy](http://technet.microsoft.com/en-us/library/dd351178.aspx) cmdlets.</span></span> 
  
> [!TIP]
> <span data-ttu-id="b81f7-258">我们建议您设计遵守默认限制策略的应用程序。</span><span class="sxs-lookup"><span data-stu-id="b81f7-258">We recommend that you design your applications to adhere to the default throttling policy.</span></span> <span data-ttu-id="b81f7-259">仅对默认限制策略，如果客户端应用程序设计无法容纳默认策略进行更改。</span><span class="sxs-lookup"><span data-stu-id="b81f7-259">Only make changes to default throttling policies if your client application design cannot accommodate the default policy.</span></span> <span data-ttu-id="b81f7-260">注意限制较少的限制策略可能产生负面影响服务可靠性。</span><span class="sxs-lookup"><span data-stu-id="b81f7-260">Be aware that less restrictive throttling policies can negatively affect service reliability.</span></span> 

<span data-ttu-id="b81f7-261"><a name="bk_ThrottlingConsiderations"> </a></span><span class="sxs-lookup"><span data-stu-id="b81f7-261"></span></span>

## <a name="throttling-considerations-for-applications-that-use-ews-impersonation"></a><span data-ttu-id="b81f7-262">限制使用 EWS 模拟的应用程序的注意事项</span><span class="sxs-lookup"><span data-stu-id="b81f7-262">Throttling considerations for applications that use EWS impersonation</span></span>


<span data-ttu-id="b81f7-263">[模拟](impersonation-and-ews-in-exchange.md)是使一个帐户以访问多个帐户的授权方法。</span><span class="sxs-lookup"><span data-stu-id="b81f7-263">[Impersonation](impersonation-and-ews-in-exchange.md) is an authorization method that enables a single account to access many accounts.</span></span> <span data-ttu-id="b81f7-264">时的服务帐户模拟用户，它将充当用户并因此假定已分配给这些用户的权限。</span><span class="sxs-lookup"><span data-stu-id="b81f7-264">When a service account impersonates users, it acts as the users and therefore assumes the rights that are assigned to those users.</span></span> <span data-ttu-id="b81f7-265">日志文件以模拟用户记录访问。</span><span class="sxs-lookup"><span data-stu-id="b81f7-265">Log files record the access as the impersonated user.</span></span> <span data-ttu-id="b81f7-266">管理员使用基于角色的访问控制 (RBAC) 来配置模拟通过 Exchange 命令行管理程序。</span><span class="sxs-lookup"><span data-stu-id="b81f7-266">Administrators use role-based access control (RBAC) to configure impersonation via the Exchange Management Shell.</span></span> 
  
<span data-ttu-id="b81f7-267">使用模拟时，预算的所有限制阈值的 Exchange 版本根据不同的应用。</span><span class="sxs-lookup"><span data-stu-id="b81f7-267">When impersonation is used, the budgets for all the throttling thresholds apply differently depending on the version of Exchange.</span></span> <span data-ttu-id="b81f7-268">预算也模拟的帐户或服务帐户对计算。</span><span class="sxs-lookup"><span data-stu-id="b81f7-268">The budget is either calculated against the account that is impersonated, or the service account.</span></span> <span data-ttu-id="b81f7-269">如果您的应用程序是多线程和使针对多个邮箱的并发请求，则应考虑限制阈值将如何影响应用程序的性能。</span><span class="sxs-lookup"><span data-stu-id="b81f7-269">If your application is multithreaded and makes concurrent requests against multiple mailboxes, you should consider how the throttling threshold will affect your application's performance.</span></span> <span data-ttu-id="b81f7-270">通常，应注意以下限制对服务帐户，创建使用模拟访问所有邮箱的基于服务的应用程序时：</span><span class="sxs-lookup"><span data-stu-id="b81f7-270">In general, be aware of the following limits on service accounts when you create a service-based application that uses impersonation to access all mailboxes:</span></span> 
  
- <span data-ttu-id="b81f7-271">使用模拟时，服务帐户具有一个单独的预算为下列策略参数：</span><span class="sxs-lookup"><span data-stu-id="b81f7-271">When you use Impersonation, the service account has a separate budget for the following policy parameters:</span></span>
    
  - <span data-ttu-id="b81f7-272">**EWSMaxConcurrency**</span><span class="sxs-lookup"><span data-stu-id="b81f7-272">**EWSMaxConcurrency**</span></span>
    
  - <span data-ttu-id="b81f7-273">**EWSPercentTimeInAD**</span><span class="sxs-lookup"><span data-stu-id="b81f7-273">**EWSPercentTimeInAD**</span></span>
    
  - <span data-ttu-id="b81f7-274">**EWSPercentTimeInCAS**</span><span class="sxs-lookup"><span data-stu-id="b81f7-274">**EWSPercentTimeInCAS**</span></span>
    
  - <span data-ttu-id="b81f7-275">**EWSPercentTimeInMailboxRPC**</span><span class="sxs-lookup"><span data-stu-id="b81f7-275">**EWSPercentTimeInMailboxRPC**</span></span>
    
  - <span data-ttu-id="b81f7-276">**EWSMaxSubscriptions**</span><span class="sxs-lookup"><span data-stu-id="b81f7-276">**EWSMaxSubscriptions**</span></span>
    
  - <span data-ttu-id="b81f7-277">**EWSFastSearchTimeoutInSeconds**</span><span class="sxs-lookup"><span data-stu-id="b81f7-277">**EWSFastSearchTimeoutInSeconds**</span></span>
    
  - <span data-ttu-id="b81f7-278">**EWSFindCountLimit**</span><span class="sxs-lookup"><span data-stu-id="b81f7-278">**EWSFindCountLimit**</span></span>
    
- <span data-ttu-id="b81f7-279">**EWSMaxConcurrency**预算共享的服务帐户和帐户被模拟为所有连接的 Exchange 版本早于 Exchange 2010 Service Pack 2 (SP2) 更新汇总 4 (RU4)。</span><span class="sxs-lookup"><span data-stu-id="b81f7-279">The **EWSMaxConcurrency** budget is shared for the service account and the account being impersonated for all connections to versions of Exchange earlier than Exchange 2010 Service Pack 2 (SP2) Update Rollup 4 (RU4).</span></span> <span data-ttu-id="b81f7-280">开始 Exchange 2010 SP2 RU4，并包含 Exchange Online，服务帐户访问使用从用户**EWSMaxConcurrency**预算的一个单独的预算。</span><span class="sxs-lookup"><span data-stu-id="b81f7-280">Starting with Exchange 2010 SP2 RU4, and including Exchange Online, the service account access uses a separate budget from the user **EWSMaxConcurrency** budget.</span></span> <span data-ttu-id="b81f7-281">有关 EWS 的更新 Exchange 并发连接限制策略的详细信息，请参阅[说明的更新汇总 4 的 Exchange Server 2010 Service Pack 2](http://support.microsoft.com/kb/2706690)。</span><span class="sxs-lookup"><span data-stu-id="b81f7-281">For more information about the update to the Exchange concurrent connection throttling policy for EWS, see [Description of Update Rollup 4 for Exchange Server 2010 Service Pack 2](http://support.microsoft.com/kb/2706690).</span></span>
    
    <span data-ttu-id="b81f7-282">流式处理版本的 Exchange 开始 Exchange 2010，并包含 Exchange Online 中的通知的 EWS 具有其他的克隆的**EWSMaxConcurrency**预算从所有其他 EWS 客户端连接。</span><span class="sxs-lookup"><span data-stu-id="b81f7-282">EWS streaming notifications in versions of Exchange starting with Exchange 2010, and including Exchange Online, have an additional cloned **EWSMaxConcurrency** budget from all other EWS client connections.</span></span> <span data-ttu-id="b81f7-283">对所有其他 EWS 操作比单独预算在内流式通知连接。</span><span class="sxs-lookup"><span data-stu-id="b81f7-283">Streaming notification connections are counted against a separate budget than all other EWS operations.</span></span> <span data-ttu-id="b81f7-284">流式通知最大并发预算是实际两个不同预算： 的所有服务帐户，是一个预算，一个预算是正在模拟的帐户。</span><span class="sxs-lookup"><span data-stu-id="b81f7-284">The streaming notification maximum concurrency budget is actually two different budgets: one budget is for all service accounts, and one budget is for the account being impersonated.</span></span> <span data-ttu-id="b81f7-285">流式处理通知在 Exchange Online 和 Exchange 开头 Exchange 2013 版本使用[HangingConnectionLimit](ews-throttling-in-exchange.md#bk_ThrottlingNotifications)限制的连接数。</span><span class="sxs-lookup"><span data-stu-id="b81f7-285">Streaming notifications in Exchange Online and versions of Exchange starting with Exchange 2013 use the [HangingConnectionLimit](ews-throttling-in-exchange.md#bk_ThrottlingNotifications) to limit the number of connections.</span></span> 
    
    <span data-ttu-id="b81f7-286">例如，假定**EWSMaxConcurrency**等于 5。</span><span class="sxs-lookup"><span data-stu-id="b81f7-286">For example, let's assume that **EWSMaxConcurrency** is equal to five.</span></span> <span data-ttu-id="b81f7-287">服务帐户可以五个并发拉通知连接具有对用户的邮箱，同时为用户时，用户可以具有五个 open 拉通知连接。</span><span class="sxs-lookup"><span data-stu-id="b81f7-287">A user can have five open pull notification connections, while an service account can have five concurrent pull notification connections against the user's mailbox at the same time as the user.</span></span> 
    
- <span data-ttu-id="b81f7-288">下表标识**EWSMaxSubscriptions**限制预算之间的服务帐户和帐户模拟的计算方式。</span><span class="sxs-lookup"><span data-stu-id="b81f7-288">The following table identifies how **EWSMaxSubscriptions** throttling budgets are calculated between the service account and the account to impersonate.</span></span> 
    
   <span data-ttu-id="b81f7-289">**表 2: EWSMaxSubscriptions 预算记帐**</span><span class="sxs-lookup"><span data-stu-id="b81f7-289">**Table 2: EWSMaxSubscriptions budget accounting**</span></span>

   |<span data-ttu-id="b81f7-290">**Exchange 版本**</span><span class="sxs-lookup"><span data-stu-id="b81f7-290">**Exchange version**</span></span>|<span data-ttu-id="b81f7-291">**EWSMaxSubscriptions 限制预算记帐**</span><span class="sxs-lookup"><span data-stu-id="b81f7-291">**EWSMaxSubscriptions throttling budget accounting**</span></span>|
   |:-----|:-----|
   |<span data-ttu-id="b81f7-292">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="b81f7-292">Exchange Online</span></span>  <br/> |<span data-ttu-id="b81f7-293">领导针对目标邮箱。</span><span class="sxs-lookup"><span data-stu-id="b81f7-293">Charged against the target mailbox.</span></span>  <br/> |
   |<span data-ttu-id="b81f7-294">Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="b81f7-294">Exchange 2013</span></span>  <br/> |<span data-ttu-id="b81f7-295">领导针对目标邮箱。</span><span class="sxs-lookup"><span data-stu-id="b81f7-295">Charged against the target mailbox.</span></span>  <br/> |
   |<span data-ttu-id="b81f7-296">Exchange 2010 SP3</span><span class="sxs-lookup"><span data-stu-id="b81f7-296">Exchange 2010 SP3</span></span>  <br/> |<span data-ttu-id="b81f7-297">领导针对目标邮箱。</span><span class="sxs-lookup"><span data-stu-id="b81f7-297">Charged against the target mailbox.</span></span>  <br/> |
   |<span data-ttu-id="b81f7-298">Exchange 2010 SP2</span><span class="sxs-lookup"><span data-stu-id="b81f7-298">Exchange 2010 SP2</span></span>  <br/> |<span data-ttu-id="b81f7-299">领导针对调用帐户。</span><span class="sxs-lookup"><span data-stu-id="b81f7-299">Charged against the calling account.</span></span> <span data-ttu-id="b81f7-300">从 Exchange 2010 SP2 RU4 开始，预算负责针对目标邮箱。</span><span class="sxs-lookup"><span data-stu-id="b81f7-300">Starting with Exchange 2010 SP2 RU4, the budget is charged against the target mailbox.</span></span>  <br/> |
   |<span data-ttu-id="b81f7-301">Exchange 2010 SP1</span><span class="sxs-lookup"><span data-stu-id="b81f7-301">Exchange 2010 SP1</span></span>  <br/> |<span data-ttu-id="b81f7-302">领导针对调用帐户。</span><span class="sxs-lookup"><span data-stu-id="b81f7-302">Charged against the calling account.</span></span>  <br/> |
   |<span data-ttu-id="b81f7-303">Exchange 2010</span><span class="sxs-lookup"><span data-stu-id="b81f7-303">Exchange 2010</span></span>  <br/> |<span data-ttu-id="b81f7-304">领导针对调用帐户。</span><span class="sxs-lookup"><span data-stu-id="b81f7-304">Charged against the calling account.</span></span>  <br/> |
   
- <span data-ttu-id="b81f7-305">只要模拟是因为**EWSMaxSubscriptions**限制预算负责对正在模拟的帐户，已连接的邮箱的服务帐户可以订阅和接收，流通知数量没有限制正在使用。</span><span class="sxs-lookup"><span data-stu-id="b81f7-305">Because the **EWSMaxSubscriptions** throttling budget is charged against the account being impersonated, there is no limit on the number of mailboxes a service account can subscribe to and receive streaming notifications for, as long as impersonation is being used.</span></span> <span data-ttu-id="b81f7-306">正在模拟的帐户，您不能超过_n_并发请求每个目标邮箱，其中_n_是**EWSMaxSubscriptions**值。</span><span class="sxs-lookup"><span data-stu-id="b81f7-306">For the account being impersonated, you can't have more than  _n_ concurrent requests per target mailbox, where  _n_ is the **EWSMaxSubscriptions** value.</span></span> <span data-ttu-id="b81f7-307">如果您不使用模拟，相同的服务帐户可能没有超过_n_并发请求总数。</span><span class="sxs-lookup"><span data-stu-id="b81f7-307">If you were not using impersonation, the same service account could not have more than  _n_ concurrent requests total.</span></span> <span data-ttu-id="b81f7-308">因此，主要是，通过使用模拟上的服务帐户，您成倍增加可服务的邮箱数。</span><span class="sxs-lookup"><span data-stu-id="b81f7-308">So, the takeaway is that by using impersonation on a service account, you exponentially increase the number of mailboxes you can service.</span></span> <span data-ttu-id="b81f7-309">有关详细信息，请参阅[在 Exchange 维护一组订阅和邮箱服务器之间的关联](how-to-maintain-affinity-between-group-of-subscriptions-and-mailbox-server.md)。</span><span class="sxs-lookup"><span data-stu-id="b81f7-309">For more information, see [Maintain affinity between a group of subscriptions and the Mailbox server in Exchange](how-to-maintain-affinity-between-group-of-subscriptions-and-mailbox-server.md).</span></span>
    
- <span data-ttu-id="b81f7-310">**EWSPercentTimeInMailboxRPC**、 **EWSPercentTimeInCAS**和**EWSPercentTimeInAD**策略参数引用单个线程执行操作。</span><span class="sxs-lookup"><span data-stu-id="b81f7-310">The **EWSPercentTimeInMailboxRPC**, **EWSPercentTimeInCAS**, and **EWSPercentTimeInAD** policy parameters refer to actions performed by a single thread.</span></span> <span data-ttu-id="b81f7-311">当应用程序执行多个并发操作时，您应负责累积用户资源的预算进行这些操作的效果。</span><span class="sxs-lookup"><span data-stu-id="b81f7-311">When an application performs multiple concurrent operations, you should account for the cumulative effect of these operations on the user resource budget.</span></span> 
    
## <a name="throttling-implications-for-ews-batch-requests"></a><span data-ttu-id="b81f7-312">限制的 EWS 批处理请求的影响</span><span class="sxs-lookup"><span data-stu-id="b81f7-312">Throttling implications for EWS batch requests</span></span>
<span data-ttu-id="b81f7-313"><a name="bk_ThrottlingBatch"> </a></span><span class="sxs-lookup"><span data-stu-id="b81f7-313"></span></span>

<span data-ttu-id="b81f7-314">EWS 使您能够由客户端访问服务器执行单个请求到批处理多个项目请求。</span><span class="sxs-lookup"><span data-stu-id="b81f7-314">EWS enables you to batch multiple item requests into a single request that is executed by the Client Access server.</span></span> <span data-ttu-id="b81f7-315">这样可以更好的效率和性能。</span><span class="sxs-lookup"><span data-stu-id="b81f7-315">This allows for greater efficiency and performance.</span></span> <span data-ttu-id="b81f7-316">当 Exchange 服务器执行批处理的请求时，它会检查用户的预算在批处理中的每个项目的执行后。</span><span class="sxs-lookup"><span data-stu-id="b81f7-316">When an Exchange server executes a batched request, it checks the user's budget after the execution of each item within the batch.</span></span> <span data-ttu-id="b81f7-317">如果超过预算应用程序，直到该用户的预算具有再充电延迟处理的批次中的下一项。</span><span class="sxs-lookup"><span data-stu-id="b81f7-317">If the application is over budget, the processing of the next item in the batch is delayed until the budget for that user has recharged.</span></span> <span data-ttu-id="b81f7-318">若要确保使用批处理操作数的应用程序成功运行，限制可以包括在单一批次，并在多个较小的批次，以提高结果的可靠性之间划分大型批次的项目请求数。</span><span class="sxs-lookup"><span data-stu-id="b81f7-318">To ensure that applications that use batch operations run successfully, limit the number of item requests that can be included in a single batch, and divide large batches across multiple smaller batches to increase the reliability of the results.</span></span> <span data-ttu-id="b81f7-319">批操作对特定限制阈值的效果取决于请求的类型、 项目处理 （例如在**UploadItems**或**ExportItems**操作） 和邮箱内容的大小。</span><span class="sxs-lookup"><span data-stu-id="b81f7-319">The effect that a batch operation has on particular throttling thresholds depends on the type of the request, the size of the items to be processed (for example in **UploadItems** or **ExportItems** operations) and the mailbox content.</span></span> <span data-ttu-id="b81f7-320">限制策略影响需要更长时间的处理的请求，从而批处理操作数。</span><span class="sxs-lookup"><span data-stu-id="b81f7-320">Throttling policies affect batch operations by causing the request to take longer to process.</span></span> <span data-ttu-id="b81f7-321">因此必须呼叫者将再等待响应，然后调用 EWS 限制为一分钟批处理请求的执行时间，因为无法超时。</span><span class="sxs-lookup"><span data-stu-id="b81f7-321">The caller will therefore have to wait longer for the response, and, because EWS limits the execution time of a batch request to one minute, the call could time out.</span></span> 
  
<span data-ttu-id="b81f7-322">若要确定应用程序的最佳批次大小，单位测试使用各种输入执行设置以确保应用程序不会遇到生产环境中的任何错误。</span><span class="sxs-lookup"><span data-stu-id="b81f7-322">To determine the optimum batch size for an application, perform unit testing using various input sets to ensure that the application does not encounter any errors in a production environment.</span></span> 
  
## <a name="throttling-policy-parameters-that-affect-ews-search-operations"></a><span data-ttu-id="b81f7-323">影响 EWS 的限制策略参数搜索操作</span><span class="sxs-lookup"><span data-stu-id="b81f7-323">Throttling policy parameters that affect EWS search operations</span></span>
<span data-ttu-id="b81f7-324"><a name="bk_ThrottlingSearch"> </a></span><span class="sxs-lookup"><span data-stu-id="b81f7-324"></span></span>

<span data-ttu-id="b81f7-325">[EWS 中的搜索操作](search-and-ews-in-exchange.md)可能需要大量的时间和资源，具体取决于搜索的运行方式和请求哪些信息。</span><span class="sxs-lookup"><span data-stu-id="b81f7-325">[Search operations in EWS](search-and-ews-in-exchange.md) can require large amounts of time and resources, depending on how the search is run and what information is requested.</span></span> <span data-ttu-id="b81f7-326">若要控制搜索过程中的资源使用状况，两个策略参数，才会生效： **EWSFastSearchTimeoutInSeconds**和**EWSFindCountLimit**。</span><span class="sxs-lookup"><span data-stu-id="b81f7-326">To control resource usage during searches, two policy parameters take effect: **EWSFastSearchTimeoutInSeconds** and **EWSFindCountLimit**.</span></span> 
  
<span data-ttu-id="b81f7-327">**EWSFastSearchTimeoutInSeconds**策略参数指定的时间，以秒为单位，该 EWS fast 搜索 （也称为内容索引的搜索） 在超时之前运行。快速搜索是通过使用[FindItem 操作](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx)中的高级查询语法 (AQS) 查询字符串进行搜索。</span><span class="sxs-lookup"><span data-stu-id="b81f7-327">The **EWSFastSearchTimeoutInSeconds** policy parameter specifies the amount of time, in seconds, that EWS fast searches (also known as content indexing search) run before they time out. A fast search is a search made by using an Advanced Query Syntax (AQS) query string in a [FindItem operation](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx).</span></span>
  
<span data-ttu-id="b81f7-328">您可以通过以下两种搜索 Exchange 邮箱文件夹：</span><span class="sxs-lookup"><span data-stu-id="b81f7-328">You can search an Exchange mailbox folder in two ways:</span></span>
  
- <span data-ttu-id="b81f7-329">通过使用 Exchange 存储搜索，在目标搜索范围内执行的所有邮件的顺序扫描。</span><span class="sxs-lookup"><span data-stu-id="b81f7-329">By using an Exchange store search, which performs a sequential scan of all messages in the target search scope.</span></span>
    
- <span data-ttu-id="b81f7-330">通过使用 Exchange 搜索服务 （内容索引）。</span><span class="sxs-lookup"><span data-stu-id="b81f7-330">By using the Exchange Search service (content indexing).</span></span>
    
<span data-ttu-id="b81f7-331">这两种类型的搜索会导致超时。</span><span class="sxs-lookup"><span data-stu-id="b81f7-331">Both of these types of searches can result in timeouts.</span></span> <span data-ttu-id="b81f7-332">如果可能，请使用 Exchange 搜索服务，因为这些搜索通常针对邮箱索引，并使用 AQS 查询。</span><span class="sxs-lookup"><span data-stu-id="b81f7-332">When possible, use the Exchange Search service because these searches are often targeted against mailbox indexes and use AQS queries.</span></span> <span data-ttu-id="b81f7-333">下面的示例演示如何使用 EWS 和 Exchange 搜索服务执行收件箱 AQS 搜索。</span><span class="sxs-lookup"><span data-stu-id="b81f7-333">The following example shows how to perform an AQS search of the Inbox by using EWS and the Exchange Search service.</span></span>
  
```cs
ItemView iv = new ItemView(1000);
FindItemsResults<Item> fiitems = service.FindItems(WellKnownFolderName.Inbox, "subject:football", iv);
```

<span data-ttu-id="b81f7-334">如果您不能使用 AQS 搜索，避免使用过于复杂的搜索筛选器。</span><span class="sxs-lookup"><span data-stu-id="b81f7-334">If you can't use an AQS search, avoid using overly complex search filters.</span></span> <span data-ttu-id="b81f7-335">尝试来避免创建基于计算值，如果查询涉及扩展的 MAPI 属性的搜索筛选器。</span><span class="sxs-lookup"><span data-stu-id="b81f7-335">Also try to avoid creating search filters based on computed values if the query involves extended MAPI properties.</span></span> <span data-ttu-id="b81f7-336">AQS 搜索是在 Exchange 2010 中引入的。</span><span class="sxs-lookup"><span data-stu-id="b81f7-336">AQS search was introduced in Exchange 2010.</span></span>
  
> [!NOTE]
> <span data-ttu-id="b81f7-337">首次运行复杂 Exchange 存储搜索查询，它运行速度很慢并可能超时时间。之后，查询将更快地响应。</span><span class="sxs-lookup"><span data-stu-id="b81f7-337">The first time you run a complex Exchange store search query, it runs very slowly and may time out. After that, the query will respond more quickly.</span></span> <span data-ttu-id="b81f7-338">有关 Exchange 的后端的详细信息交换期间发生的服务器进程存储搜索查询，请参阅 TechNet 上的[了解的性能影响的高项目计数和受限的视图](http://technet.microsoft.com/en-us/library/cc535025%28EXCHG.80%29.aspx)。</span><span class="sxs-lookup"><span data-stu-id="b81f7-338">For more information about the backend Exchange server processes that occur during Exchange store search queries, see [Understanding the Performance Impact of High Item Counts and Restricted Views](http://technet.microsoft.com/en-us/library/cc535025%28EXCHG.80%29.aspx) on TechNet.</span></span> <span data-ttu-id="b81f7-339">使用**SearchFilter**创建将来，帮助相似的查询的动态限制，但是这些限制是动态的性质，因为它们不是永久或可靠，并最长三天后删除。</span><span class="sxs-lookup"><span data-stu-id="b81f7-339">Using a **SearchFilter** creates a dynamic restriction that helps similar queries in the future, but because these restrictions are dynamic in nature, they are not permanent or reliable, and are deleted after a maximum of three days.</span></span> 
  
<span data-ttu-id="b81f7-340">**EWSFindCountLimit** policy 参数指定为一个用户同时在客户端访问服务器上的内存**FindItem**或**FindFolder**操作可存在的结果中的项的最大数目。</span><span class="sxs-lookup"><span data-stu-id="b81f7-340">The **EWSFindCountLimit** policy parameter specifies the maximum number of items from the results of a **FindItem** or **FindFolder** operation that can exist in memory on a Client Access server at the same time for one user.</span></span> <span data-ttu-id="b81f7-341">每个项目或 EWS 处理**FindItem**或**FindFolder**请求中的文件夹是根据预算**EWSFindCountLimit**元素中指定计算在内。</span><span class="sxs-lookup"><span data-stu-id="b81f7-341">Every item or folder that EWS processes in a **FindItem** or **FindFolder** request is counted against the budget specified in the **EWSFindCountLimit** element.</span></span> <span data-ttu-id="b81f7-342">当将响应发送回请求者时，当前呼叫查找计数收费被释放。</span><span class="sxs-lookup"><span data-stu-id="b81f7-342">When the response is sent back to the requester, the find count charge for the current call is released.</span></span> <span data-ttu-id="b81f7-343">超过预算时，服务器将返回到请求者的响应基于**RequestServerVersion**元素的值和请求者是否指定分页。</span><span class="sxs-lookup"><span data-stu-id="b81f7-343">The response the server returns to a requester when the budget is exceeded is based on the **RequestServerVersion** element value and whether the requester specified paging.</span></span> <span data-ttu-id="b81f7-344">如果**RequestServerVersion**元素的值表示 Exchange 2010 或更早版本 Exchange，服务器将发送错误代码**ErrorServerBusy**失败响应。</span><span class="sxs-lookup"><span data-stu-id="b81f7-344">When the value of the **RequestServerVersion** element indicates Exchange 2010 or an earlier version of Exchange, the server sends a failure response with error code **ErrorServerBusy**.</span></span> <span data-ttu-id="b81f7-345">如果**RequestServerVersion**元素的值指示版本的 Exchange 开头 Exchange 2010 SP1 或 Exchange Online 和客户端使用分页，EWS 可能返回的部分结果集而不是一个错误。</span><span class="sxs-lookup"><span data-stu-id="b81f7-345">If the value of the **RequestServerVersion** element indicates a version of Exchange starting with Exchange 2010 SP1 or Exchange Online, and the client is using paging, EWS may return a partial result set instead of an error.</span></span> <span data-ttu-id="b81f7-346">您的应用程序应产生预期 EWS 可能不会返回所有项目。</span><span class="sxs-lookup"><span data-stu-id="b81f7-346">Your application should expect that EWS might not return all items.</span></span> <span data-ttu-id="b81f7-347">如果**IncludesLastItemInRange**元素的值为 false，应用程序应使新的偏移量与另一个**FindItem**或**FindFolder**请求，并继续之前**IncludesLastItemInRange**元素，则返回 true。</span><span class="sxs-lookup"><span data-stu-id="b81f7-347">If the value of the **IncludesLastItemInRange** element is false, the application should make another **FindItem** or **FindFolder** request with the new offset and continue until the **IncludesLastItemInRange** element returns true.</span></span> 
  
<span data-ttu-id="b81f7-348">当您使用**FindItem**或**FindFolder**操作时，请务必使用分页。</span><span class="sxs-lookup"><span data-stu-id="b81f7-348">When you use a **FindItem** or **FindFolder** operation, it is important to use paging.</span></span> <span data-ttu-id="b81f7-349">EWS 托管 API 强制使用分页，但如果您使用其他方法，如 EWS 代理对象或原始 SOAP，您需要显式设置分页。</span><span class="sxs-lookup"><span data-stu-id="b81f7-349">The EWS Managed API enforces the use of paging, but if you are using other methods, such as EWS proxy objects or raw SOAP, you need to explicitly set paging.</span></span> <span data-ttu-id="b81f7-350">下面的示例演示如何使用 EWS 托管 API 中的页面。</span><span class="sxs-lookup"><span data-stu-id="b81f7-350">The following example shows how to use paging in the EWS Managed API.</span></span> 
  
```cs
ItemView iv = new ItemView(1000);
FindItemsResults<Item> fiFindItemResults = service.FindItems(WellKnownFolderName.Inbox, iv);
```

> [!NOTE]
> <span data-ttu-id="b81f7-351">Exchange 中的默认策略限制为 1000年项目的页面大小。</span><span class="sxs-lookup"><span data-stu-id="b81f7-351">The default policy in Exchange limits the page size to 1000 items.</span></span> <span data-ttu-id="b81f7-352">将页面大小设置为一个值，超过此号码产生任何实际。</span><span class="sxs-lookup"><span data-stu-id="b81f7-352">Setting the page size to a value that is greater than this number has no practical effect.</span></span> 
  
<span data-ttu-id="b81f7-353">应用程序还应负责这一事实_EWSFindCountLimit_限制参数值可能会导致设置的应用程序的并发请求返回的部分结果。</span><span class="sxs-lookup"><span data-stu-id="b81f7-353">Applications should also account for the fact that the  _EWSFindCountLimit_ throttling parameter value may result in a partial result set being returned for applications that make concurrent requests.</span></span> <span data-ttu-id="b81f7-354">下面的示例演示如何使用 EWS 托管 API 在**MoreAvailable**属性来确保在查询中包含的所有结果。</span><span class="sxs-lookup"><span data-stu-id="b81f7-354">The following example shows how to use the **MoreAvailable** property in the EWS Managed API to ensure that all results are included in a query.</span></span> 
  
```cs
ItemView iv = new ItemView(1000);
service.TraceEnabled = false;
FindItemsResults<Item> fiResults = null;
Do 
{
    fiResults = service.FindItems(WellKnownFolderName.Inbox, iv);
    PropertySet itItemPropSet = new PropertySet(BasePropertySet.IdOnly) { EmailMessageSchema.Body };
    //Process Items in Result Set
    iv.Offset += fiResults.Items.Count;
}
while (fiResults.MoreAvailable == true);
```

## <a name="throttling-policies-and-concurrency"></a><span data-ttu-id="b81f7-355">限制策略和并发</span><span class="sxs-lookup"><span data-stu-id="b81f7-355">Throttling policies and concurrency</span></span>
<span data-ttu-id="b81f7-356"><a name="bk_ThrottlingConcurrency"> </a></span><span class="sxs-lookup"><span data-stu-id="b81f7-356"></span></span>

<span data-ttu-id="b81f7-357">并发指的特定用户的连接数。</span><span class="sxs-lookup"><span data-stu-id="b81f7-357">Concurrency refers to the number of connections from a specific user.</span></span> <span data-ttu-id="b81f7-358">连接保留从开始，直到响应发送给请求者收到的请求。</span><span class="sxs-lookup"><span data-stu-id="b81f7-358">A connection is held from the moment a request is received until a response is sent to the requester.</span></span> <span data-ttu-id="b81f7-359">如果用户尝试进行更多并发请求多于其策略允许，新连接尝试失败。</span><span class="sxs-lookup"><span data-stu-id="b81f7-359">If users try to make more concurrent requests than their policy allows, the new connection attempt fails.</span></span> <span data-ttu-id="b81f7-360">但是，保持有效现有连接。</span><span class="sxs-lookup"><span data-stu-id="b81f7-360">However, the existing connections remain valid.</span></span> <span data-ttu-id="b81f7-361">限制策略可以通过多种不同的方式影响并发。</span><span class="sxs-lookup"><span data-stu-id="b81f7-361">Throttling policies can affect concurrency in a number of different ways.</span></span>
  
<span data-ttu-id="b81f7-362">**EWSMaxConcurrency**限制策略参数可设置特定用户可针对 Exchange 服务器一次拥有的并发连接的数。</span><span class="sxs-lookup"><span data-stu-id="b81f7-362">The **EWSMaxConcurrency** throttling policy parameter sets the number of concurrent connections that a specific user can have against an Exchange server at one time.</span></span> <span data-ttu-id="b81f7-363">若要确定的最大并发连接允许数，请考虑 Outlook 客户端将使用的连接。</span><span class="sxs-lookup"><span data-stu-id="b81f7-363">To determine the maximum number of concurrent connections to allow, consider the connections that Outlook clients will use.</span></span> <span data-ttu-id="b81f7-364">Outlook 2007 和 Outlook 2010 使用 EWS 访问可用性和外出 (OOF) 信息。</span><span class="sxs-lookup"><span data-stu-id="b81f7-364">Outlook 2007 and Outlook 2010 use EWS to access availability and Out of Office (OOF) information.</span></span> <span data-ttu-id="b81f7-365">Mac Outlook 2011 使用 EWS 的所有客户端访问功能。</span><span class="sxs-lookup"><span data-stu-id="b81f7-365">Mac Outlook 2011 uses EWS for all client access functionality.</span></span> <span data-ttu-id="b81f7-366">正在连接到用户邮箱的 Outlook 客户端数，根据用户可用的并发连接数可能会受到限制。</span><span class="sxs-lookup"><span data-stu-id="b81f7-366">Depending on the number of Outlook clients that are actively connecting to a user's mailbox, the number of concurrent connections available for a user might be limited.</span></span> <span data-ttu-id="b81f7-367">此外，如果您的应用程序使用单个的安全性上下文时同时连接到多个邮箱，务必考虑**EWSMaxConcurrency**策略的值。</span><span class="sxs-lookup"><span data-stu-id="b81f7-367">Also, if your application has to connect to multiple mailboxes simultaneously while using a single security context, it is important to take the value of the **EWSMaxConcurrency** policy into account.</span></span> <span data-ttu-id="b81f7-368">有关单一安全环境使用并发连接的详细信息，请参阅上文中的[应用程序使用 EWS 模拟的限制注意事项](#bk_ThrottlingConsiderations)。</span><span class="sxs-lookup"><span data-stu-id="b81f7-368">For more information about using a single security context with concurrent connections, see [Throttling considerations for applications that use EWS impersonation](#bk_ThrottlingConsiderations) earlier in this article.</span></span> 
  
<span data-ttu-id="b81f7-369">同时连接到多个邮箱的应用程序必须能够在客户端跟踪资源使用情况。</span><span class="sxs-lookup"><span data-stu-id="b81f7-369">Applications that concurrently connect to multiple mailboxes have to be able to track resource usage on the client side.</span></span> <span data-ttu-id="b81f7-370">由于 EWS 操作是基于请求/响应，可确保您的应用程序函数也在**EWSMaxConcurrency**阈值内通过跟踪发生的请求和响应时开始之间的连接数收到的、 并且确保不超过 10 打开请求同时发生。</span><span class="sxs-lookup"><span data-stu-id="b81f7-370">Because EWS operations are request/response-based, you can ensure that your applications function well within the **EWSMaxConcurrency** threshold by tracking the number of connections that occur between the start of a request and when the response is received and ensuring that no more than ten open requests occur concurrently.</span></span> 
  
<span data-ttu-id="b81f7-371">**EWSFindCountLimit** policy 参数指定**FindItem**或**FindFolder**操作可用于客户端访问服务器一次一个用户的最大结果大小。</span><span class="sxs-lookup"><span data-stu-id="b81f7-371">The **EWSFindCountLimit** policy parameter specifies the maximum result size a **FindItem** or **FindFolder** operation can use on a Client Access server at the same time for one user.</span></span> <span data-ttu-id="b81f7-372">如果应用程序 （或具有潜在的多个应用程序） 使返回 100 个项目每个特定用户的两个并发 EWS **FindItem**请求，根据特定用户的预算**EWSFindCountLimit**费用将 200。</span><span class="sxs-lookup"><span data-stu-id="b81f7-372">If an application (or potentially multiple applications) makes two concurrent EWS **FindItem** requests that return 100 items each for a specific user, the **EWSFindCountLimit** charge against that specific user's budget will be 200.</span></span> <span data-ttu-id="b81f7-373">返回的第一个请求，预算将降至 100，并为零第二个请求返回时，将预算。</span><span class="sxs-lookup"><span data-stu-id="b81f7-373">When the first request returns, the budget drops to 100, and when the second request returns, the budget drops to zero.</span></span> <span data-ttu-id="b81f7-374">如果同一应用程序已进行 1000年个项的两个并发请求，预算值将为 2000年个项目，其超过**EWSFindCountLimit**值。</span><span class="sxs-lookup"><span data-stu-id="b81f7-374">If the same application were to make two simultaneous requests for 1000 items, the budget value would be 2000 items, which exceeds the **EWSFindCountLimit** value.</span></span> <span data-ttu-id="b81f7-375">如果项目的用户的预算低于零下, 一个请求会导致错误之前用户的预算重新充电到一个或多。</span><span class="sxs-lookup"><span data-stu-id="b81f7-375">If the user's budget for items drops below zero, the next request results in an error until the user's budget recharges to one or more.</span></span> 

<span data-ttu-id="b81f7-376"><a name="bk_ThrottlingNotifications"> </a></span><span class="sxs-lookup"><span data-stu-id="b81f7-376"></span></span>
  
## <a name="throttling-considerations-for-ews-notification-applications"></a><span data-ttu-id="b81f7-377">限制 EWS 通知应用程序的注意事项</span><span class="sxs-lookup"><span data-stu-id="b81f7-377">Throttling considerations for EWS notification applications</span></span>


<span data-ttu-id="b81f7-378">如果您要构建 EWS 通知使用应用程序推送、 拉，或流式处理通知，您应考虑**EWSMaxSubscriptions** **EWSMaxConcurrency**限制策略和**的含义HangingConnectionLimit**。</span><span class="sxs-lookup"><span data-stu-id="b81f7-378">If you are building EWS notification applications that make use of either push, pull, or streaming notifications, you should consider the implications of the **EWSMaxSubscriptions** and the **EWSMaxConcurrency** throttling policies, and the **HangingConnectionLimit**.</span></span> 
  
<span data-ttu-id="b81f7-379">**EWSMaxSubscriptions**策略参数指定活动推送、 提取、 和用户可同时拥有特定客户端访问服务器的流式订阅的最大数量。</span><span class="sxs-lookup"><span data-stu-id="b81f7-379">The **EWSMaxSubscriptions** policy parameter specifies the maximum number of active push, pull, and streaming subscriptions that a user can have on a specific Client Access server at the same time.</span></span> <span data-ttu-id="b81f7-380">不同版本的 Exchange 具有不同的默认值为此参数。</span><span class="sxs-lookup"><span data-stu-id="b81f7-380">Different versions of Exchange have different default values for this parameter.</span></span> <span data-ttu-id="b81f7-381">用户可以订阅邮箱中的所有文件夹使用**SubscribeToAllFolders**属性-此服务使用单个订阅根据**EWSMaxSubscriptions**预算。</span><span class="sxs-lookup"><span data-stu-id="b81f7-381">A user can subscribe to all folders in a mailbox by using the **SubscribeToAllFolders** property - this uses a single subscription against the **EWSMaxSubscriptions** budget.</span></span> <span data-ttu-id="b81f7-382">用户可以订阅单个文件夹，每个文件夹订阅计数达到**EWSMaxSubscriptions**预算，最多限制设置由**EWSMaxSubscriptions**参数的值 （例如，用户可以订阅 20 日历如果**EWSMaxSubscriptions**设为 20 的不同邮箱中文件夹）。</span><span class="sxs-lookup"><span data-stu-id="b81f7-382">Users can subscribe to individual folders, with each folder subscription counting towards the **EWSMaxSubscriptions** budget, up to the limit set by the value of the **EWSMaxSubscriptions** parameter (for example, users can subscribe to 20 calendar folders in different mailboxes if **EWSMaxSubscriptions** is set to 20).</span></span> 
  
<span data-ttu-id="b81f7-383">有关模拟和**EWSMaxSubscriptions**参数的信息，请参阅上文中的[应用程序使用 EWS 模拟的限制注意事项](#bk_ThrottlingConsiderations)。</span><span class="sxs-lookup"><span data-stu-id="b81f7-383">For information about impersonation and the **EWSMaxSubscriptions** parameter, see [Throttling considerations for applications that use EWS impersonation](#bk_ThrottlingConsiderations) earlier in this article.</span></span> 
  
<span data-ttu-id="b81f7-384">**EWSMaxConcurrency** policy 参数也可以是 EWS 通知; 问题例如：</span><span class="sxs-lookup"><span data-stu-id="b81f7-384">The **EWSMaxConcurrency** policy parameter can also be an issue for EWS notifications; for example:</span></span> 
  
- <span data-ttu-id="b81f7-385">当 EWS 递增订阅的所有者的连接数时通知由强制订阅生成。</span><span class="sxs-lookup"><span data-stu-id="b81f7-385">When EWS increments the connection count for the owner of the subscription while the notification is being generated by a push subscription.</span></span>
    
- <span data-ttu-id="b81f7-386">在应用程序旨在收听多个用户的邮箱，并用户会收到一条消息，发送到通讯组列表实例的同时通知。</span><span class="sxs-lookup"><span data-stu-id="b81f7-386">When an application is designed to listen to multiple users' mailboxes, and users receive simultaneous notifications for an instance of a message that is sent to a distribution list.</span></span>
    
<span data-ttu-id="b81f7-387">如果通知应用程序是多线程，并使同时连接请求以获取有关特定消息已接收的用户帐户的详细信息，则可能会超过**EWSMaxConcurrency**策略限制。</span><span class="sxs-lookup"><span data-stu-id="b81f7-387">If the notification application is multithreaded and makes simultaneous connection requests to get more information about a particular message that was received by a user account, the **EWSMaxConcurrency** policy limit can be exceeded.</span></span> <span data-ttu-id="b81f7-388">若要为此帐户，请考虑监控应用程序中的并发连接、 包括那些可能使用该服务器，以及实现请求队列的客户端上。</span><span class="sxs-lookup"><span data-stu-id="b81f7-388">To account for this, consider monitoring the concurrent connections in your application, including those that might be used by the server, and implementing request queuing on the client.</span></span> 
  
<span data-ttu-id="b81f7-389">**HangingConnectionLimit**才适用于流式传输通知。</span><span class="sxs-lookup"><span data-stu-id="b81f7-389">The **HangingConnectionLimit** is only applicable to streaming notifications.</span></span> <span data-ttu-id="b81f7-390">此限制设置在 web.config 文件中，这意味着 Exchange 管理员可以在内部部署 Exchange 服务器上，设置此值，但 Exchange Online 邮箱必须为此限制，这是 3 的 Exchange Online 和 Exchange 2013 中使用的默认值。</span><span class="sxs-lookup"><span data-stu-id="b81f7-390">This limit is set in the web.config file, which means that an Exchange administrator can set this value on an on-premises Exchange server, but Exchange Online mailboxes must use the default value for this limit, which is 3 for both Exchange Online and Exchange 2013.</span></span> <span data-ttu-id="b81f7-391">若要了解详细信息，请参阅[我需要考虑哪些限制值？](how-to-maintain-affinity-between-group-of-subscriptions-and-mailbox-server.md#bk_throttling)。</span><span class="sxs-lookup"><span data-stu-id="b81f7-391">To learn more, see [What throttling values do I need to take into consideration?](how-to-maintain-affinity-between-group-of-subscriptions-and-mailbox-server.md#bk_throttling).</span></span>
  
## <a name="throttling-policy-and-application-performance"></a><span data-ttu-id="b81f7-392">限制策略和应用程序性能</span><span class="sxs-lookup"><span data-stu-id="b81f7-392">Throttling policy and application performance</span></span>
<span data-ttu-id="b81f7-393"><a name="bk_PercentTimeIn"> </a></span><span class="sxs-lookup"><span data-stu-id="b81f7-393"></span></span>

<span data-ttu-id="b81f7-394">限制策略**PercentTimeIn**以下三个参数会影响客户端访问服务器上的 EWS 应用程序可以使用的时间量：</span><span class="sxs-lookup"><span data-stu-id="b81f7-394">The following three parameters of the **PercentTimeIn** throttling policy affect the amount of time an EWS application can consume on a Client Access server:</span></span> 
  
- <span data-ttu-id="b81f7-395">**EWSPercentTimeInAD**</span><span class="sxs-lookup"><span data-stu-id="b81f7-395">**EWSPercentTimeInAD**</span></span>
    
- <span data-ttu-id="b81f7-396">**EWSPercentTimeInCAS**</span><span class="sxs-lookup"><span data-stu-id="b81f7-396">**EWSPercentTimeInCAS**</span></span>
    
- <span data-ttu-id="b81f7-397">**EWSPercentTimeInMailboxRPC**</span><span class="sxs-lookup"><span data-stu-id="b81f7-397">**EWSPercentTimeInMailboxRPC**</span></span>
    
<span data-ttu-id="b81f7-398">**PercentTimeIn**策略参数中指定的值指示分配了一个使一个请求的线程的时间量。</span><span class="sxs-lookup"><span data-stu-id="b81f7-398">The values specified in the **PercentTimeIn** policy parameters indicate the amount of time that one thread making one request is allocated.</span></span> <span data-ttu-id="b81f7-399">该过程假定**EWSPercentTimeInCAS**值为 90，如果一个过程将花费 54 秒的两个并发请求客户端访问服务器上的每个运行代码，例如，使用 108 秒 60 秒窗口。</span><span class="sxs-lookup"><span data-stu-id="b81f7-399">For example, assuming a **EWSPercentTimeInCAS** value of 90, if a process makes two concurrent requests that spend 54 seconds each running code on the Client Access server, the process uses 108 seconds in a 60 second window.</span></span> <span data-ttu-id="b81f7-400">这表示 180% **EWSPercentTimeInCAS**参数值。</span><span class="sxs-lookup"><span data-stu-id="b81f7-400">This represents an **EWSPercentTimeInCAS** parameter value of 180 percent.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="b81f7-401">**EWSPercentTimeInCAS**参数值为**EWSPercentTimeInAD**和**EWSPercentTimeInMailboxRPC**参数的值的重叠超集。</span><span class="sxs-lookup"><span data-stu-id="b81f7-401">The **EWSPercentTimeInCAS** parameter value is an overlapping superset of the **EWSPercentTimeInAD** and **EWSPercentTimeInMailboxRPC** parameter values.</span></span> <span data-ttu-id="b81f7-402">这意味着在客户端访问服务器处理时间支出始终将大于**EWSPercentTimeInAD**和**EWSPercentTimeInMailboxRPC**中的支出。</span><span class="sxs-lookup"><span data-stu-id="b81f7-402">This means that the expenditure in Client Access server processing time will always be larger than the expenditures in **EWSPercentTimeInAD** and **EWSPercentTimeInMailboxRPC**.</span></span> <span data-ttu-id="b81f7-403">这是因为进行 Active Directory 或 RPC 调用的 Exchange 组件，它必须已经在运行客户端访问服务器代码。</span><span class="sxs-lookup"><span data-stu-id="b81f7-403">This is because for the Exchange component to make an Active Directory or RPC call, it must already be running Client Access server code.</span></span> <span data-ttu-id="b81f7-404">此外，在处理时间**EWSPercentTimeInCAS**支出不停止时 LDAP 或进行 RPC 调用。</span><span class="sxs-lookup"><span data-stu-id="b81f7-404">In addition, the expenditure in processing time for **EWSPercentTimeInCAS** doesn't stop while LDAP or RPC calls are being made.</span></span> <span data-ttu-id="b81f7-405">尽管请求可能同步等待来自 Active Directory 域服务 (AD DS) 或 Exchange 存储的响应的进程仍占用的服务器上，线程，因此线程应继续会收取该用法。</span><span class="sxs-lookup"><span data-stu-id="b81f7-405">Although the request might be synchronously waiting for a response from Active Directory Domain Services (AD DS) or the Exchange store, the process is still consuming a thread on the server, and therefore the thread should continue to be charged for that usage.</span></span> 
  
<span data-ttu-id="b81f7-406">应用程序可能需要 60 秒内的 CPU 时间量可能会超过这些节流限制;因此，务必要考虑的数量和类型的正在进行的请求。</span><span class="sxs-lookup"><span data-stu-id="b81f7-406">The amount of CPU time an application may take in a 60-second period might exceed these throttling limits; therefore, it is important to consider the volume and type of requests that are being made.</span></span> <span data-ttu-id="b81f7-407">例如，同时进行的**ResolveNames**操作大批可能会超过**EWSPercentTimeInAD**策略参数值。</span><span class="sxs-lookup"><span data-stu-id="b81f7-407">For example, a large batch of **ResolveNames** operations that are made simultaneously can exceed the **EWSPercentTimeInAD** policy parameter value.</span></span> <span data-ttu-id="b81f7-408">默认限制策略中包含的策略值旨在允许大多数 EWS 应用程序没有问题; 起作用但是，当多线程的高容量应用程序在一个特定的客户端访问服务器上放置大量请求，这可以创建问题。</span><span class="sxs-lookup"><span data-stu-id="b81f7-408">The policy values that are contained in the default throttling policy are designed to allow most EWS applications to function without issue; however, when multithreaded high-volume applications place a large volume of requests on one particular Client Access server, this can create problems.</span></span> <span data-ttu-id="b81f7-409">若要避免此问题，请考虑将打算执行对服务器的批次大小限制。</span><span class="sxs-lookup"><span data-stu-id="b81f7-409">To avoid this, consider limiting the size of batches that are going to execute against the server.</span></span> 
  
## <a name="throttling-policies-and-applications-that-send-a-large-volume-of-email"></a><span data-ttu-id="b81f7-410">限制策略和发送大量的电子邮件应用程序</span><span class="sxs-lookup"><span data-stu-id="b81f7-410">Throttling policies and applications that send a large volume of email</span></span>
<span data-ttu-id="b81f7-411"><a name="bk_RateLimits"> </a></span><span class="sxs-lookup"><span data-stu-id="b81f7-411"></span></span>

<span data-ttu-id="b81f7-412">默认限制策略包含三个速率限制策略参数会影响使用 EWS 发送大量邮件或短时间内中采用大型批次发送消息的应用程序。</span><span class="sxs-lookup"><span data-stu-id="b81f7-412">The default throttling policies include three rate limit policy parameters that can affect applications that use EWS to send a large volume of messages or send messages in large batches in a short period of time.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="b81f7-413">通常情况下，建议您不要使用 EWS 发送批量电子邮件。</span><span class="sxs-lookup"><span data-stu-id="b81f7-413">In general, we recommend that you do not use EWS to send bulk email.</span></span> <span data-ttu-id="b81f7-414">使用从事批量邮件服务，以提交常用大型批量电子邮件的 SMTP 主机。</span><span class="sxs-lookup"><span data-stu-id="b81f7-414">Use an SMTP host that specializes in bulk mail services to submit frequent large bulk email messages.</span></span> 
  
<span data-ttu-id="b81f7-415">**MessageRateLimit**策略参数指定每分钟可以提交任何 Exchange 客户端，包括 EWS 的消息的数。</span><span class="sxs-lookup"><span data-stu-id="b81f7-415">The **MessageRateLimit** policy parameter specifies the number of messages per minute that can be submitted by any Exchange client, including EWS.</span></span> <span data-ttu-id="b81f7-416">默认情况下，此策略设置为每分钟 30 封邮件。</span><span class="sxs-lookup"><span data-stu-id="b81f7-416">By default, this policy is set to 30 messages per minute.</span></span> <span data-ttu-id="b81f7-417">对于一般用户，这通常已足够。</span><span class="sxs-lookup"><span data-stu-id="b81f7-417">For ordinary users, this is generally sufficient.</span></span> <span data-ttu-id="b81f7-418">但是，作为一部分开票程序，例如发送电子邮件的大型批次的应用程序可以遇到问题。</span><span class="sxs-lookup"><span data-stu-id="b81f7-418">However, applications that send large batches of email messages, for example as part of an invoicing program, can run into problems.</span></span> <span data-ttu-id="b81f7-419">当超过此策略限制时，邮箱的邮件传递延迟。</span><span class="sxs-lookup"><span data-stu-id="b81f7-419">When this policy limit is exceeded, message delivery for the mailbox is delayed.</span></span> <span data-ttu-id="b81f7-420">具体而言，邮件发件箱或草稿文件夹中显示的长时间时用户或应用程序提交比**MessageRateLimit**参数指定值的较大邮件数。</span><span class="sxs-lookup"><span data-stu-id="b81f7-420">Specifically, messages will appear in the Outbox or Drafts folder for longer periods of time when a user or application submits a larger number of messages than the value specified by the **MessageRateLimit** parameter.</span></span> <span data-ttu-id="b81f7-421">请务必考虑这一点尤其在您的应用程序使用的用户通过 Outlook 连接到邮箱开发跟踪系统，传递时。</span><span class="sxs-lookup"><span data-stu-id="b81f7-421">Be sure to consider this when you are developing a delivery tracking system, especially if your application uses a mailbox that users connect to via Outlook.</span></span> <span data-ttu-id="b81f7-422">当延迟的项目存储在发件箱或草稿文件夹中时，用户可能将的解释为错误。</span><span class="sxs-lookup"><span data-stu-id="b81f7-422">When deferred items are stored in the Outbox or drafts folder, users might interpret that as an error.</span></span> 
  
<span data-ttu-id="b81f7-423">**RecipientRateLimit** policy 参数指定用户在 24 小时内可以解决的收件人数的限制。</span><span class="sxs-lookup"><span data-stu-id="b81f7-423">The **RecipientRateLimit** policy parameter specifies the limit on the number of recipients that a user can address in a 24-hour period.</span></span> <span data-ttu-id="b81f7-424">例如，如果此值设置为 500，则表示一个 Exchange 邮箱帐户可以发送到不多于 500 个收件人天的邮件。</span><span class="sxs-lookup"><span data-stu-id="b81f7-424">For example, if this value is set to 500, it means that a single Exchange mailbox account can send messages to no more than 500 recipients each day.</span></span> <span data-ttu-id="b81f7-425">此限制适用于发送给组织内部和外部的收件人的邮件。</span><span class="sxs-lookup"><span data-stu-id="b81f7-425">This limit applies to messages to recipients that are inside and outside the organization.</span></span> <span data-ttu-id="b81f7-426">此默认限制可能会导致的一些业务线应用程序的执行结束的月份发票运行，需要将邮件发送到此收件人数超过的问题。</span><span class="sxs-lookup"><span data-stu-id="b81f7-426">This default limit might cause problems for some line-of-business applications that do end-of-month invoice runs and need to send messages to more than this number of recipients.</span></span> <span data-ttu-id="b81f7-427">您可以使用启用批处理消息或单独的内部部署出站中继解决方案，以解决此限制的外部服务。</span><span class="sxs-lookup"><span data-stu-id="b81f7-427">You can use external services that enable batch processing of messages or separate on-premises outbound relay solutions to work around this limitation.</span></span> 
  
<span data-ttu-id="b81f7-428">**ForwardeeLimit**策略参数指定的最大收件人可以转发或重定向到通过收件箱规则的邮件数。</span><span class="sxs-lookup"><span data-stu-id="b81f7-428">The **ForwardeeLimit** policy parameter specifies the maximum number of recipients that messages can be forwarded or redirected to by means of Inbox rules.</span></span> <span data-ttu-id="b81f7-429">此参数不限制可转发或重定向到收件人的邮件数。</span><span class="sxs-lookup"><span data-stu-id="b81f7-429">This parameter doesn't limit the number of messages that can be forwarded or redirected to the recipients.</span></span> 
  
## <a name="errors-generated-when-throttling-limits-are-exceeded"></a><span data-ttu-id="b81f7-430">为在超出节流限制时生成的错误</span><span class="sxs-lookup"><span data-stu-id="b81f7-430">Errors generated when throttling limits are exceeded</span></span>
<span data-ttu-id="b81f7-431"><a name="bk_ThrottlingErrors"> </a></span><span class="sxs-lookup"><span data-stu-id="b81f7-431"></span></span>

<span data-ttu-id="b81f7-432">超过了限制策略时，EWS 将生成下表中列出的错误之一。</span><span class="sxs-lookup"><span data-stu-id="b81f7-432">When throttling polices are exceeded, EWS generates one of the errors listed in the following table.</span></span>
  
<span data-ttu-id="b81f7-433">**表 3： 限制限制错误**</span><span class="sxs-lookup"><span data-stu-id="b81f7-433">**Table 3: Throttling limit errors**</span></span>

|<span data-ttu-id="b81f7-434">**Error**</span><span class="sxs-lookup"><span data-stu-id="b81f7-434">**Error**</span></span>|<span data-ttu-id="b81f7-435">**限制策略参数**</span><span class="sxs-lookup"><span data-stu-id="b81f7-435">**Throttling policy parameter**</span></span>|<span data-ttu-id="b81f7-436">**说明**</span><span class="sxs-lookup"><span data-stu-id="b81f7-436">**Description**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="b81f7-437">ErrorExceededConnectionCount</span><span class="sxs-lookup"><span data-stu-id="b81f7-437">ErrorExceededConnectionCount</span></span>  <br/> |<span data-ttu-id="b81f7-438">**EWSMaxConcurrency**</span><span class="sxs-lookup"><span data-stu-id="b81f7-438">**EWSMaxConcurrency**</span></span> <br/> |<span data-ttu-id="b81f7-439">指示根据服务器所允许的用户策略的更多并发请求。</span><span class="sxs-lookup"><span data-stu-id="b81f7-439">Indicates that there are more concurrent requests against the server than are allowed by a user's policy.</span></span>  <br/> |
|<span data-ttu-id="b81f7-440">ErrorExceededSubscriptionCount</span><span class="sxs-lookup"><span data-stu-id="b81f7-440">ErrorExceededSubscriptionCount</span></span>  <br/> |<span data-ttu-id="b81f7-441">**EWSMaxSubscriptions**</span><span class="sxs-lookup"><span data-stu-id="b81f7-441">**EWSMaxSubscriptions**</span></span> <br/> |<span data-ttu-id="b81f7-442">指示用户的限制的策略已超出最大订阅计数。</span><span class="sxs-lookup"><span data-stu-id="b81f7-442">Indicates that a user's throttling policy maximum subscription count has been exceeded.</span></span>  <br/> |
|<span data-ttu-id="b81f7-443">ErrorExceededFindCountLimit</span><span class="sxs-lookup"><span data-stu-id="b81f7-443">ErrorExceededFindCountLimit</span></span>  <br/> |<span data-ttu-id="b81f7-444">**EWSFindCountLimit**</span><span class="sxs-lookup"><span data-stu-id="b81f7-444">**EWSFindCountLimit**</span></span> <br/> |<span data-ttu-id="b81f7-445">指示搜索操作调用超过的可返回的项目总数。</span><span class="sxs-lookup"><span data-stu-id="b81f7-445">Indicates that a search operation call has exceeded the total number of items that can be returned.</span></span>  <br/> |
|<span data-ttu-id="b81f7-446">ErrorServerBusy</span><span class="sxs-lookup"><span data-stu-id="b81f7-446">ErrorServerBusy</span></span>  <br/> |<span data-ttu-id="b81f7-447">**EWSPercentTimeInMailboxRPC**         **EWSPercentTimeInCAS**         **EWSPercentTimeInAD**</span><span class="sxs-lookup"><span data-stu-id="b81f7-447">**EWSPercentTimeInMailboxRPC**         **EWSPercentTimeInCAS**         **EWSPercentTimeInAD**</span></span> <br/> |<span data-ttu-id="b81f7-448">服务器正忙时发生。</span><span class="sxs-lookup"><span data-stu-id="b81f7-448">Occurs when the server is busy.</span></span> <span data-ttu-id="b81f7-449">返回与 ErrorServerBusy 错误的 BackOffMilliseconds 值指示客户端它应等待，直到它应重新提交请求的导致响应返回此错误代码的时间量。</span><span class="sxs-lookup"><span data-stu-id="b81f7-449">The BackOffMilliseconds value returned with ErrorServerBusy errors indicates to the client the amount of time it should wait until it should resubmit the request that caused the response that returned this error code.</span></span>  <br/> |
   
<span data-ttu-id="b81f7-450">下表列出了由限制错误返回的 HTTP 状态代码。</span><span class="sxs-lookup"><span data-stu-id="b81f7-450">The following table lists the HTTP status codes that are returned by throttling errors.</span></span>
  
<span data-ttu-id="b81f7-451">**返回的限制错误的表 4: HTTP 状态代码**</span><span class="sxs-lookup"><span data-stu-id="b81f7-451">**Table 4: HTTP status codes returned by throttling errors**</span></span>

|<span data-ttu-id="b81f7-452">**HTTP 状态代码**</span><span class="sxs-lookup"><span data-stu-id="b81f7-452">**HTTP status code**</span></span>|<span data-ttu-id="b81f7-453">**说明**</span><span class="sxs-lookup"><span data-stu-id="b81f7-453">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="b81f7-454">HTTP 503</span><span class="sxs-lookup"><span data-stu-id="b81f7-454">HTTP 503</span></span>  <br/> |<span data-ttu-id="b81f7-455">指示 EWS 请求队列 iis。</span><span class="sxs-lookup"><span data-stu-id="b81f7-455">Indicates that EWS requests are queuing with IIS.</span></span> <span data-ttu-id="b81f7-456">客户端应推迟到以后发送其他请求。</span><span class="sxs-lookup"><span data-stu-id="b81f7-456">The client should delay sending additional requests until a later time.</span></span>  <br/> |
|<span data-ttu-id="b81f7-457">HTTP 500</span><span class="sxs-lookup"><span data-stu-id="b81f7-457">HTTP 500</span></span>  <br/> |<span data-ttu-id="b81f7-458">指示内部服务器错误 ErrorServerBusy 错误代码。</span><span class="sxs-lookup"><span data-stu-id="b81f7-458">Indicates an internal server error with the ErrorServerBusy error code.</span></span> <span data-ttu-id="b81f7-459">这指示客户端应延迟发送到以后的其他请求。</span><span class="sxs-lookup"><span data-stu-id="b81f7-459">This indicates that the client should delay sending additional requests until a later time.</span></span> <span data-ttu-id="b81f7-460">响应可能包含后退调用 BackOffMilliseconds 的提示。</span><span class="sxs-lookup"><span data-stu-id="b81f7-460">The response may contain a back off hint called BackOffMilliseconds.</span></span> <span data-ttu-id="b81f7-461">如果存在此参数，则 BackOffMilliseconds 的值应用作直到客户端重新提交请求的持续时间。</span><span class="sxs-lookup"><span data-stu-id="b81f7-461">If present, the value of BackOffMilliseconds should be used as the duration until the client resubmits a request.</span></span>  <br/> |
|<span data-ttu-id="b81f7-462">HTTP 200</span><span class="sxs-lookup"><span data-stu-id="b81f7-462">HTTP 200</span></span>  <br/> |<span data-ttu-id="b81f7-463">包含与 ErrorInternalServerError 错误代码 EWS 基于架构的错误响应。</span><span class="sxs-lookup"><span data-stu-id="b81f7-463">Contains an EWS schema-based error response with an ErrorInternalServerError error code.</span></span> <span data-ttu-id="b81f7-464">可能存在内部 ErrorServerBusy 错误代码。</span><span class="sxs-lookup"><span data-stu-id="b81f7-464">An inner ErrorServerBusy error code may be present.</span></span> <span data-ttu-id="b81f7-465">这指示客户端应延迟发送到以后的其他请求。</span><span class="sxs-lookup"><span data-stu-id="b81f7-465">This indicates that the client should delay sending additional requests until a later time.</span></span>  <br/> |
   
## <a name="see-also"></a><span data-ttu-id="b81f7-466">另请参阅</span><span class="sxs-lookup"><span data-stu-id="b81f7-466">See also</span></span>

- [<span data-ttu-id="b81f7-467">Exchange 工作负载管理</span><span class="sxs-lookup"><span data-stu-id="b81f7-467">Exchange Workload Management</span></span>](http://technet.microsoft.com/en-us/library/jj150503.aspx)
- [<span data-ttu-id="b81f7-468">新 ThrottlingPolicy cmdlet</span><span class="sxs-lookup"><span data-stu-id="b81f7-468">New-ThrottlingPolicy cmdlet</span></span>](http://technet.microsoft.com/en-us/library/dd351045.aspx)
- [<span data-ttu-id="b81f7-469">了解客户端限制策略</span><span class="sxs-lookup"><span data-stu-id="b81f7-469">Understanding Client Throttling Policies</span></span>](http://technet.microsoft.com/en-us/library/dd297964.aspx)
- [<span data-ttu-id="b81f7-470">ThrottlingPolicy 类</span><span class="sxs-lookup"><span data-stu-id="b81f7-470">ThrottlingPolicy Class</span></span>](http://msdn.microsoft.com/en-us/library/ff342496%28v=EXCHG.140%29.aspx)
- [<span data-ttu-id="b81f7-471">限制策略和 EWSFindCountLimit</span><span class="sxs-lookup"><span data-stu-id="b81f7-471">Throttling Policies and the EWSFindCountLimit</span></span>](http://blogs.msdn.com/b/exchangedev/archive/2010/03/12/throttling-policies-and-the-ewsfindcountlimit.aspx)
- [<span data-ttu-id="b81f7-472">在 IIS 日志预算快照</span><span class="sxs-lookup"><span data-stu-id="b81f7-472">Budget Snapshots in the IIS Logs</span></span>](http://blogs.msdn.com/b/exchangedev/archive/2010/03/10/budget-snapshots-in-the-iis-logs.aspx)
- [<span data-ttu-id="b81f7-473">限制在 Exchange 2010 SP1 中的部署的影响</span><span class="sxs-lookup"><span data-stu-id="b81f7-473">Effects of Throttling on Your Deployment in Exchange 2010 SP1</span></span>](http://msexchangeteam.com/archive/2010/08/27/456040.aspx)
- [<span data-ttu-id="b81f7-474">Exchange 2010 SP1 中的限制策略关联</span><span class="sxs-lookup"><span data-stu-id="b81f7-474">Throttling Policy Associations in Exchange 2010 SP1</span></span>](http://msexchangeteam.com/archive/2010/08/02/455707.aspx)
- [<span data-ttu-id="b81f7-475">限制策略和 CPUStartPercent</span><span class="sxs-lookup"><span data-stu-id="b81f7-475">Throttling Policies and CPUStartPercent</span></span>](http://blogs.msdn.com/b/exchangedev/archive/2010/03/11/throttling-policies-and-cpustartpercent.aspx)
- [<span data-ttu-id="b81f7-476">Impersonation and EWS in Exchange</span><span class="sxs-lookup"><span data-stu-id="b81f7-476">Impersonation and EWS in Exchange</span></span>](impersonation-and-ews-in-exchange.md)
    

