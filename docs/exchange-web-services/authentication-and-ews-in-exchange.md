---
title: 在 Exchange 中的身份验证和 EWS
manager: sethgros
ms.date: 03/9/2015
ms.audience: Developer
ms.assetid: 9a83df96-aca0-42b3-b8f5-2b414f0363f1
description: 查找更多信息，帮助你为面向 Exchange 的 EWS 应用程序选择正确的身份验证标准。
localization_priority: Priority
ms.openlocfilehash: 0b35921f33b935f9a5a490e15d4e76d1a3e3c9dc
ms.sourcegitcommit: 843a2e030a94b12aec70c553ca4e06e39ac02d82
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/09/2020
ms.locfileid: "49603832"
---
# <a name="authentication-and-ews-in-exchange"></a><span data-ttu-id="d5340-103">在 Exchange 中的身份验证和 EWS</span><span class="sxs-lookup"><span data-stu-id="d5340-103">Authentication and EWS in Exchange</span></span>

<span data-ttu-id="d5340-104">查找更多信息，帮助你为面向 Exchange 的 EWS 应用程序选择正确的身份验证标准。</span><span class="sxs-lookup"><span data-stu-id="d5340-104">Find information to help you choose the right authentication standard for your EWS application that targets Exchange.</span></span>
  
<span data-ttu-id="d5340-105">身份验证是 Exchange Web 服务 (EWS) 应用程序中的一个关键部分。</span><span class="sxs-lookup"><span data-stu-id="d5340-105">Authentication is a key part of your Exchange Web Services (EWS) application.</span></span> <span data-ttu-id="d5340-106">Exchange Online、Exchange Online 作为 Office 365 的一部分以及从 Exchange Server 2013 开始的本地版 Exchange 支持标准版 Web 身份验证 协议，以帮助保护应用和 Exchange Server 之间的通讯。</span><span class="sxs-lookup"><span data-stu-id="d5340-106">Exchange Online, Exchange Online as part of Office 365, and on-premises versions of Exchange starting with Exchange Server 2013 support standard web authentication protocols to help secure the communication between your application and the Exchange server.</span></span>
  
<span data-ttu-id="d5340-107">如果你面向 Exchange Online，那么你选择的身份验证方法必须使用 HTTPS 加密应用发出的请求和响应。</span><span class="sxs-lookup"><span data-stu-id="d5340-107">If you're targeting Exchange Online, the authentication method that you choose must use HTTPS to encrypt the requests and responses that your application sends.</span></span> <span data-ttu-id="d5340-108">即使你可以在 Exchange 本地服务器上使用HTTP，我们建议你使用 HTTPS 加密任何应用发送到 EWS 终结点的请求，以帮助保护应用和 Exchange Server 之间的通讯。</span><span class="sxs-lookup"><span data-stu-id="d5340-108">Although you can use HTTP with Exchange on-premises servers, we recommend that you use HTTPS for any request that your application sends to an EWS endpoint to help secure communication between your application and an Exchange server.</span></span>
  
<span data-ttu-id="d5340-109">Exchange 提供下列身份验证选项供你选择：</span><span class="sxs-lookup"><span data-stu-id="d5340-109">Exchange provides the following authentication options for you to choose from:</span></span> 
  
- <span data-ttu-id="d5340-110">OAuth 2.0 （仅Exchange Online）</span><span class="sxs-lookup"><span data-stu-id="d5340-110">OAuth 2.0 (Exchange Online only)</span></span>
    
- <span data-ttu-id="d5340-111">NTLM （仅本地 Exchange）</span><span class="sxs-lookup"><span data-stu-id="d5340-111">NTLM (Exchange on-premises only)</span></span>
    
- <span data-ttu-id="d5340-112">基本（不在推荐）</span><span class="sxs-lookup"><span data-stu-id="d5340-112">Basic (no longer recommended)</span></span>
    
<span data-ttu-id="d5340-113">你选择的身份验证方法取决于你组织的安全要求，取决于你在使用 Exchange Online 还是本地 Exchange，以及你是否有权限访问可以提供 OAuth 令牌的第三方提供商。</span><span class="sxs-lookup"><span data-stu-id="d5340-113">The authentication method that you choose depends on the security requirements of your organization, whether you are using Exchange Online or Exchange on-premises, and whether you have access to a third-party provider that can issue OAuth tokens.</span></span> <span data-ttu-id="d5340-114">这篇文章提供相关信息，帮助你选择适合你应用的身份验证标准。</span><span class="sxs-lookup"><span data-stu-id="d5340-114">This article provides information that will help you select the authentication standard that's right for your application.</span></span>
  
## <a name="oauth-authentication"></a><span data-ttu-id="d5340-115">OAuth 身份验证</span><span class="sxs-lookup"><span data-stu-id="d5340-115">OAuth authentication</span></span>

<span data-ttu-id="d5340-116">我们推荐所有新应用使用 OAuth 标准连接 Exchange Online 服务。</span><span class="sxs-lookup"><span data-stu-id="d5340-116">We recommend that all new applications use the OAuth standard to connect to Exchange Online services.</span></span> <span data-ttu-id="d5340-117">它在安全性方面优于基本身份验证，所以值得花额外的必需精力将 OAuth 应用到你的应用。</span><span class="sxs-lookup"><span data-stu-id="d5340-117">The advantage in security over basic authentication is worth the additional work required to implement OAuth in your application.</span></span> <span data-ttu-id="d5340-118">但是，郑重声明，这也存在一些你需要注意的缺点。</span><span class="sxs-lookup"><span data-stu-id="d5340-118">For the record, however, there are also some disadvantages that you should be aware of.</span></span>
  
<span data-ttu-id="d5340-119">**表 1. 使用 OAuth 的优缺点**</span><span class="sxs-lookup"><span data-stu-id="d5340-119">**Table 1. Advantages and disadvantages of using OAuth**</span></span>

|<span data-ttu-id="d5340-120">**优点**</span><span class="sxs-lookup"><span data-stu-id="d5340-120">**Advantages**</span></span>|<span data-ttu-id="d5340-121">**缺点**</span><span class="sxs-lookup"><span data-stu-id="d5340-121">**Disadvantages**</span></span>|
|:-----|:-----|
| <span data-ttu-id="d5340-122">OAuth 是行业标准的身份验证协议。</span><span class="sxs-lookup"><span data-stu-id="d5340-122">OAuth is an industry-standard authentication protocol.</span></span><br/><br/><span data-ttu-id="d5340-123">身份验证由第三方提供商管理。</span><span class="sxs-lookup"><span data-stu-id="d5340-123">Authentication is managed by a third-party provider.</span></span> <span data-ttu-id="d5340-124">你的应用程序不需要收集和存储 Exchange 凭据。</span><span class="sxs-lookup"><span data-stu-id="d5340-124">Your application does not have to collect and store the Exchange credentials.</span></span><br/><br/><span data-ttu-id="d5340-125">你的烦恼减少了，因为你的应用只会从身份验证提供商处收到一个不透明的令牌，因此，你的应用中的安全漏洞只会暴露此令牌，而不是用户的 Exchange 凭据。</span><span class="sxs-lookup"><span data-stu-id="d5340-125">Fewer worries for you, because your application only receives an opaque token from the authentication provider; therefore, a security breach in your application can only expose the token, not the user's Exchange credentials.</span></span>  <br/> | <span data-ttu-id="d5340-126">OAuth 依赖第三方身份验证提供商。</span><span class="sxs-lookup"><span data-stu-id="d5340-126">OAuth relies on a third-party authentication provider.</span></span> <span data-ttu-id="d5340-127">这会增加你组织或客户的成本。</span><span class="sxs-lookup"><span data-stu-id="d5340-127">This can impose additional costs on your organization or your customers.</span></span><br/><br/><span data-ttu-id="d5340-128">OAuth 标准比基本身份验证更难实施。</span><span class="sxs-lookup"><span data-stu-id="d5340-128">The OAuth standard is more difficult to implement than basic authentication.</span></span><br/><br/><span data-ttu-id="d5340-129">要实施 OAuth，你需要将你的应用与身份验证提供商和 Exchange 服务器进行整合。</span><span class="sxs-lookup"><span data-stu-id="d5340-129">To implement OAuth, you need to integrate your application with both the authentication provider and the Exchange server.</span></span>  <br/> |
   
<span data-ttu-id="d5340-130">为帮助最小化缺点，你可以使用 [Azure AD 身份验证库](https://docs.microsoft.com/azure/active-directory/develop/active-directory-authentication-libraries) (ADAL) 来在云或本地验证用户使用 Active Directory 域服务 (AD DS)，然后获取到 Exchange 服务器的保护通话的访问令牌。</span><span class="sxs-lookup"><span data-stu-id="d5340-130">To help minimize the disadvantages, you can use the [Microsoft Azure AD Authentication Library](https://docs.microsoft.com/azure/active-directory/develop/active-directory-authentication-libraries) (ADAL) to authenticate users to Active Directory Domain Services (AD DS) in the cloud or on-premises and then obtain access tokens for securing calls to an Exchange server.</span></span> <span data-ttu-id="d5340-131">Exchange Online 要求 Microsoft Azure Active Directory 服务颁发的令牌，该令牌由 ADAL 支持。但是，你也可以使用任何第三方库。</span><span class="sxs-lookup"><span data-stu-id="d5340-131">Exchange Online requires tokens issued by the Azure Active Directory service, which is supported by the ADAL; however, you can use any third-party library.</span></span> 
  
<span data-ttu-id="d5340-132">了解更多关于如何在你的 EWS 应用中使用 OAuth 身份验证的信息，参与以下资源：</span><span class="sxs-lookup"><span data-stu-id="d5340-132">To learn more about using OAuth authentication in your EWS application, see the following resources:</span></span>
  
- <span data-ttu-id="d5340-133">[Office 365 试用版](https://docs.microsoft.com/office/developer-program/office-365-developer-program)，设置 Exchange 服务器来使用测试你的客户端应用程序。</span><span class="sxs-lookup"><span data-stu-id="d5340-133">[Office 365 trial](https://docs.microsoft.com/office/developer-program/office-365-developer-program), to set up an Exchange server to use to test your client application.</span></span>
    
- [<span data-ttu-id="d5340-134">适用于 .NET 的 Azure AD 身份验证库</span><span class="sxs-lookup"><span data-stu-id="d5340-134">Azure AD Authentication Library for .NET</span></span>](https://docs.microsoft.com/azure/active-directory/develop/active-directory-authentication-libraries)
    
- <span data-ttu-id="d5340-135">[配置 Azure Active Directory](https://msdn.microsoft.com/library/055e1155-2d4d-4c85-b44e-d406872ba595%28Office.15%29.aspx)，让你的应用可以使用 OAuth 令牌进行身份验证。</span><span class="sxs-lookup"><span data-stu-id="d5340-135">[Configure Azure Active Directory](https://msdn.microsoft.com/library/055e1155-2d4d-4c85-b44e-d406872ba595%28Office.15%29.aspx), to enable your application to use OAuth tokens for authentication.</span></span>
    
- <span data-ttu-id="d5340-136">在“[使用 OAuth 验证 EWS 应用](how-to-authenticate-an-ews-application-by-using-oauth.md)”中使用 OAuth 检查示例代码，比如你可以 研究的代码。</span><span class="sxs-lookup"><span data-stu-id="d5340-136">Review the sample code in [Authenticate an EWS application by using OAuth](how-to-authenticate-an-ews-application-by-using-oauth.md) for example code that you can study.</span></span> 
    
## <a name="ntlm-authentication"></a><span data-ttu-id="d5340-137">NTLM 身份验证</span><span class="sxs-lookup"><span data-stu-id="d5340-137">NTLM authentication</span></span>

<span data-ttu-id="d5340-138">NTLM 身份验证仅对 Exchange 本地服务器可用。</span><span class="sxs-lookup"><span data-stu-id="d5340-138">NTLM authentication is only available for Exchange on-premises servers.</span></span> <span data-ttu-id="d5340-139">对用在公司防火墙内运行的应用，NTLM 身份验证和 .NET Framework 的结合可以通过内嵌的方式验证你的应用。</span><span class="sxs-lookup"><span data-stu-id="d5340-139">For applications that run inside the corporate firewall, integration between NTLM authentication and the .NET Framework provides a built-in means to authenticate your application.</span></span> 
  
<span data-ttu-id="d5340-140">**表 2. 使用 NTLM 身份验证的优缺点**</span><span class="sxs-lookup"><span data-stu-id="d5340-140">**Table 2. Advantages and disadvantages of using NTLM authentication**</span></span>

|<span data-ttu-id="d5340-141">**优点**</span><span class="sxs-lookup"><span data-stu-id="d5340-141">**Advantages**</span></span>|<span data-ttu-id="d5340-142">**缺点**</span><span class="sxs-lookup"><span data-stu-id="d5340-142">**Disadvantages**</span></span>|
|:-----|:-----|
| <span data-ttu-id="d5340-143">以创新方法在你的 Exchange 服务器上工作。</span><span class="sxs-lookup"><span data-stu-id="d5340-143">Works "out of the box" with your Exchange server.</span></span> <span data-ttu-id="d5340-144">你可以通过使用[Exchange 命令行管理程序 cmdlet](how-to-control-access-to-ews-in-exchange.md)配置对 Exchange 服务的访问。</span><span class="sxs-lookup"><span data-stu-id="d5340-144">You can configure access to Exchange services by using an [Exchange Management Shell cmdlet](how-to-control-access-to-ews-in-exchange.md).</span></span><br/><br/><span data-ttu-id="d5340-145">使用 .NET Framework [CredentialCache](https://msdn2.microsoft.com/library/615e0wsd) 对象自动获取用户的凭据。</span><span class="sxs-lookup"><span data-stu-id="d5340-145">Uses the .NET Framework [CredentialCache](https://msdn2.microsoft.com/library/615e0wsd) object to automatically get the user's credentials.</span></span><br/><br/><span data-ttu-id="d5340-146">[代码示例可用](https://code.msdn.microsoft.com/office/Exchange-2013-101-Code-3c38582c)，使用登陆用户的凭据验证到本地 Exchange 服务器。</span><span class="sxs-lookup"><span data-stu-id="d5340-146">[Code samples are available](https://code.msdn.microsoft.com/office/Exchange-2013-101-Code-3c38582c) that use the logged on user's credentials for authentication to an on-premises Exchange server.</span></span>  <br/> | <span data-ttu-id="d5340-147">用户必须登陆到域来使用 NTLM 身份验证。</span><span class="sxs-lookup"><span data-stu-id="d5340-147">Users must be logged on to a domain to use NTLM authentication.</span></span><br/><br/><span data-ttu-id="d5340-148">要访问和用户的域账号不关联的电子邮件账号可能会很困难。</span><span class="sxs-lookup"><span data-stu-id="d5340-148">It can be difficult to access email accounts that are not associated with the user's domain account.</span></span><br/><br/><span data-ttu-id="d5340-149">服务应用程序必须有域账号来利用 NTLM 身份验证的优势。</span><span class="sxs-lookup"><span data-stu-id="d5340-149">Service applications must have a domain account to take advantage of NTLM authentication.</span></span>  <br/> |

   
## <a name="basic-authentication"></a><span data-ttu-id="d5340-150">基本身份验证</span><span class="sxs-lookup"><span data-stu-id="d5340-150">Basic authentication</span></span>

<span data-ttu-id="d5340-151">基本身份验证提供了你的客户端应用程序基本的安全性。</span><span class="sxs-lookup"><span data-stu-id="d5340-151">Basic authentication provides a, well, basic level of security for your client application.</span></span> <span data-ttu-id="d5340-152">我们建议所有新应用使用 NTLM 或 OAuth 协议进行身份验证，但是基本身份验证也在某些情况下可行。</span><span class="sxs-lookup"><span data-stu-id="d5340-152">We do recommend that all new applications use either NTLM or the OAuth protocol for authentication; however, basic authentication can be the correct choice for your application in some circumstances.</span></span>
  
<span data-ttu-id="d5340-153">**表 3. 使用基本身份验证的优缺点**</span><span class="sxs-lookup"><span data-stu-id="d5340-153">**Table 3. Advantages and disadvantages of using basic authentication**</span></span>

|<span data-ttu-id="d5340-154">**优点**</span><span class="sxs-lookup"><span data-stu-id="d5340-154">**Advantages**</span></span>|<span data-ttu-id="d5340-155">**缺点**</span><span class="sxs-lookup"><span data-stu-id="d5340-155">**Disadvantages**</span></span>|
|:-----|:-----|
| <span data-ttu-id="d5340-156">以创新方法在你的 Exchange 服务器上工作。</span><span class="sxs-lookup"><span data-stu-id="d5340-156">Works "out of the box" with your Exchange server.</span></span> <span data-ttu-id="d5340-157">你可以通过使用[Exchange 命令行管理程序 cmdlet](how-to-control-access-to-ews-in-exchange.md)配置对 Exchange 服务的访问。</span><span class="sxs-lookup"><span data-stu-id="d5340-157">You can configure access to Exchange services by using an [Exchange Management Shell cmdlet](how-to-control-access-to-ews-in-exchange.md).</span></span><br/><br/><span data-ttu-id="d5340-158">Windows 应用可以使用登陆用户的默认凭据。</span><span class="sxs-lookup"><span data-stu-id="d5340-158">Windows applications can use the logged on user's default credentials.</span></span><br/><br/><span data-ttu-id="d5340-159">很多 [代码示例可用](https://code.msdn.microsoft.com/office/Exchange-2013-101-Code-3c38582c)，它们向你展示如何用基本身份验证调用 EWS。</span><span class="sxs-lookup"><span data-stu-id="d5340-159">Many [code samples are available](https://code.msdn.microsoft.com/office/Exchange-2013-101-Code-3c38582c) that show you how to call EWS using basic authentication.</span></span>  <br/> | <span data-ttu-id="d5340-160">需要你的应用收集和存储用户的凭据。</span><span class="sxs-lookup"><span data-stu-id="d5340-160">Requires your application to collect and store the user's credentials.</span></span><br/><br/><span data-ttu-id="d5340-161">如果你想要强制所有用户使用基本身份验证，你必须关闭 NTLM 身份验证。</span><span class="sxs-lookup"><span data-stu-id="d5340-161">You have to turn off NTLM authentication if you want to force all users to use basic authentication.</span></span><br/><br/><span data-ttu-id="d5340-162">如果你的应用出现安全漏洞，你的用户的电子邮件地址和密码可能会暴露给入侵者。</span><span class="sxs-lookup"><span data-stu-id="d5340-162">If a security breach occurs in your application, it can expose the user's email address and password to the attacker.</span></span>  <br/> |
   
<span data-ttu-id="d5340-163">你需要决定基本身份验证是否满足你的组织和用户的要求。</span><span class="sxs-lookup"><span data-stu-id="d5340-163">You need to decide if basic authentication meets the security requirements of your organization and customers.</span></span> <span data-ttu-id="d5340-164">如果你想避免过多的设置，比如示例测试或演示应用，基本身份验证是合适的选择。</span><span class="sxs-lookup"><span data-stu-id="d5340-164">Basic authentication can be the right choice if you want to avoid extensive setup tasks, for example for simple test or demonstration applications.</span></span>

> [!NOTE]
> <span data-ttu-id="d5340-165">基本身份验证不在受 EWS 支持，无法连接 Exchange Online。</span><span class="sxs-lookup"><span data-stu-id="d5340-165">Basic authentication is no longer supported for EWS to connect to Exchange Online.</span></span> <span data-ttu-id="d5340-166">在你的新的或现有的 EWS 应用上使用 OAuth 身份验证来连接Exchange Online。</span><span class="sxs-lookup"><span data-stu-id="d5340-166">Use OAuth authentication in all your new or existing EWS applications to connect to Exchange Online.</span></span> <span data-ttu-id="d5340-167">对 EWS 的 OAuth 身份验证仅在作为 Microsoft 365 一部分的 Exchange Online 中可用。</span><span class="sxs-lookup"><span data-stu-id="d5340-167">OAuth authentication for EWS is only available in Exchange Online as part of Microsoft 365.</span></span> <span data-ttu-id="d5340-168">使用 OAuth 的 EWS 应用程序必须先通过 Azure Active Directory 注册。</span><span class="sxs-lookup"><span data-stu-id="d5340-168">EWS applications that use OAuth must be registered with Azure Active Directory first.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="d5340-169">另请参阅</span><span class="sxs-lookup"><span data-stu-id="d5340-169">See also</span></span>
- [<span data-ttu-id="d5340-170">使用 OAuth 对 EWS 应用程序进行身份验证</span><span class="sxs-lookup"><span data-stu-id="d5340-170">Authenticate an EWS application by using OAuth</span></span>](how-to-authenticate-an-ews-application-by-using-oauth.md)
- [<span data-ttu-id="d5340-171">开始使用 Exchange 中的 Web 服务</span><span class="sxs-lookup"><span data-stu-id="d5340-171">Start using web services in Exchange</span></span>](start-using-web-services-in-exchange.md)   
- [<span data-ttu-id="d5340-172">使用 Microsoft Azure AD 添加到你的 Web 应用的登陆</span><span class="sxs-lookup"><span data-stu-id="d5340-172">Adding Sign-On to Your Web Application Using Microsoft Azure AD</span></span>](https://msdn.microsoft.com/library/055e1155-2d4d-4c85-b44e-d406872ba595%28Office.15%29.aspx)    
- [<span data-ttu-id="d5340-173">在 Exchange 中控制对 EWS 的访问</span><span class="sxs-lookup"><span data-stu-id="d5340-173">Control access to EWS in Exchange</span></span>](how-to-control-access-to-ews-in-exchange.md)    
- [<span data-ttu-id="d5340-174">在 Exchange 中控制客户端应用对 EWS 的访问</span><span class="sxs-lookup"><span data-stu-id="d5340-174">Controlling client application access to EWS in Exchange</span></span>](controlling-client-application-access-to-ews-in-exchange.md)   
- [<span data-ttu-id="d5340-175">支持的令牌和声明类型</span><span class="sxs-lookup"><span data-stu-id="d5340-175">Supported token and claim types</span></span>](https://msdn.microsoft.com/library/9d35e4bc-7b72-49d1-b723-5464eee6be2c%28Office.15%29.aspx)
 
