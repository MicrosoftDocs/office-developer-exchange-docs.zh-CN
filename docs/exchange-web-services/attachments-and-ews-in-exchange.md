---
title: 附件和 EWS Exchange 中
manager: sethgros
ms.date: 7/11/2016
ms.audience: Developer
ms.assetid: 8e4289a4-ec9d-4502-9854-c593c95d5f98
description: 了解附件以及你的 EWS 托管 API 或 Exchange 客户端中的 EWS 如何表示这些附件。
localization_priority: Priority
ms.openlocfilehash: d37fef9ea14a3b42a0eed0240724fe69c8531c93
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/03/2020
ms.locfileid: "44528487"
---
# <a name="attachments-and-ews-in-exchange"></a><span data-ttu-id="fc57d-103">附件和 EWS Exchange 中</span><span class="sxs-lookup"><span data-stu-id="fc57d-103">Attachments and EWS in Exchange</span></span>

<span data-ttu-id="fc57d-104">了解附件以及你的 EWS 托管 API 或 Exchange 客户端中的 EWS 如何表示这些附件。</span><span class="sxs-lookup"><span data-stu-id="fc57d-104">Learn about attachments and how your EWS Managed API or EWS in Exchange client represents them.</span></span>
  
<span data-ttu-id="fc57d-105">通常情况下，附件与电子邮件项目相关联，但实际上，所有 EWS 项目（电子邮件、日历项目、联系人、任务）都可以包含附件。</span><span class="sxs-lookup"><span data-stu-id="fc57d-105">Usually, attachments are associated with email items, but in fact, all EWS items — email messages, calendar items, contacts, tasks — can include attachments.</span></span>
  
## <a name="types-of-attachments"></a><span data-ttu-id="fc57d-106">附件类型</span><span class="sxs-lookup"><span data-stu-id="fc57d-106">Types of attachments</span></span>

<span data-ttu-id="fc57d-107">EWS 将附件分类为两个组：文件附件和项目附件。</span><span class="sxs-lookup"><span data-stu-id="fc57d-107">EWS categorizes attachments into two groups: file attachments and item attachments.</span></span>
  
- <span data-ttu-id="fc57d-108">**项目附件：** 附加到另一个强类型 EWS 项的强类型[ews 项](folders-and-items-in-ews-in-exchange.md)，如电子邮件和日历项。</span><span class="sxs-lookup"><span data-stu-id="fc57d-108">**Item attachments:** Strongly-typed [EWS items](folders-and-items-in-ews-in-exchange.md), such as email messages and calendar items, that are attached to another strongly-typed EWS item.</span></span> <span data-ttu-id="fc57d-109">可以使用 EWS 托管 API 或 EWS 创建的任何强类型项目都可用作项目附件。</span><span class="sxs-lookup"><span data-stu-id="fc57d-109">Any strongly-typed item that can be created by using the EWS Managed API or EWS can be used as an item attachment.</span></span> <span data-ttu-id="fc57d-110">项目附件的内容是强类型的项目，它提供了对其所有属性的轻松访问。</span><span class="sxs-lookup"><span data-stu-id="fc57d-110">The content of an item attachment is the strongly-typed item, which provides easy access to all its properties.</span></span> <span data-ttu-id="fc57d-111">项目附件可以拥有自己的项目附件，因此可能会有项目附件（或附件的嵌套）的层次结构。</span><span class="sxs-lookup"><span data-stu-id="fc57d-111">Item attachments can have their own item attachments, so a hierarchy of item attachments (or nesting of attachments) is possible.</span></span>
    
- <span data-ttu-id="fc57d-112">**文件附件：** 任何文件，如 .txt、.jpg、.zip、.pdf，甚至是 .msg 文件。</span><span class="sxs-lookup"><span data-stu-id="fc57d-112">**File attachments:** Any file, such as a .txt, .jpg, .zip, .pdf, or even a .msg file.</span></span> <span data-ttu-id="fc57d-113">文件附件仅具有几个属性，其中一个属性是文件的以64为基础的编码内容。</span><span class="sxs-lookup"><span data-stu-id="fc57d-113">A file attachment only has a few properties, one of which is the base-64 encoded content of the file.</span></span> 
    
- <span data-ttu-id="fc57d-114">**引用附件：** 由文件提供程序引用的任何附件，如位于云中的文件。</span><span class="sxs-lookup"><span data-stu-id="fc57d-114">**Reference attachments:** Any attachment that is referenced by a file provider, such as a file located in the cloud.</span></span> <span data-ttu-id="fc57d-115">附件可以来自多个提供程序。</span><span class="sxs-lookup"><span data-stu-id="fc57d-115">An attachment can be from multiple providers.</span></span> 
    
<span data-ttu-id="fc57d-116">当您在项目中添加或检索附件时，您将根据它是文件附件还是项目附件以不同的方式执行此操作。</span><span class="sxs-lookup"><span data-stu-id="fc57d-116">When you add or retrieve attachments from an item, you'll do it differently depending on whether it's a file attachment or an item attachment.</span></span> <span data-ttu-id="fc57d-117">例如，若要将文件附件添加到项目中，只需传入文件的位置即可。</span><span class="sxs-lookup"><span data-stu-id="fc57d-117">For example, to add a file attachment to an item, you can just pass in the location of the file.</span></span> <span data-ttu-id="fc57d-118">若要将现有项目添加为项目附件，您必须将现有项目的属性或 MIME 内容复制到新项目附件中。您不能只绑定到现有项。</span><span class="sxs-lookup"><span data-stu-id="fc57d-118">To add an existing item as an item attachment, you actually have to copy the properties or the MIME content of the existing item to a new item attachment; you can't just bind to the existing item.</span></span> <span data-ttu-id="fc57d-119">因此，区分这两种类型的附件非常重要。</span><span class="sxs-lookup"><span data-stu-id="fc57d-119">So distinguishing between the two types of attachments is important.</span></span> <span data-ttu-id="fc57d-120">[本节中](#bk_inthissection)的文章讨论了有关项目附件和文件附件之间的差异的更多详细信息。</span><span class="sxs-lookup"><span data-stu-id="fc57d-120">More details about the differences between item attachments and file attachments are discussed in the articles [In this section](#bk_inthissection).</span></span>
  
## <a name="how-are-attachments-represented-programmatically"></a><span data-ttu-id="fc57d-121">附件是如何以编程方式表示的？</span><span class="sxs-lookup"><span data-stu-id="fc57d-121">How are attachments represented programmatically?</span></span>

<span data-ttu-id="fc57d-122">附件存储在 EWS 项的集合中。</span><span class="sxs-lookup"><span data-stu-id="fc57d-122">Attachments are stored in a collection on the EWS item.</span></span> <span data-ttu-id="fc57d-123">附件集合由文件附件和/或项目附件组成。</span><span class="sxs-lookup"><span data-stu-id="fc57d-123">The attachments collection is made up of file attachments and/or item attachments.</span></span> <span data-ttu-id="fc57d-124">使用 EWS 托管 API Item 获取项目时，将提供有关附件集合的元数据[。 Bind](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx)方法或 EWS [GetItem](https://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx)操作，但需要进行额外的调用以实际检索附件的内容。</span><span class="sxs-lookup"><span data-stu-id="fc57d-124">Metadata about the attachment collection is available when you get an item by using the EWS Managed API [Item.Bind](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) method or the EWS [GetItem](https://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) operation, but additional calls are required to actually retrieve the contents of the attachments.</span></span> 
  
<span data-ttu-id="fc57d-125">**表1。有关附件的项元数据**</span><span class="sxs-lookup"><span data-stu-id="fc57d-125">**Table 1. Item metadata about attachments**</span></span>

|<span data-ttu-id="fc57d-126">**元数据实体**</span><span class="sxs-lookup"><span data-stu-id="fc57d-126">**Metadata entity**</span></span>|<span data-ttu-id="fc57d-127">**EWS 托管 API 属性**</span><span class="sxs-lookup"><span data-stu-id="fc57d-127">**EWS Managed API property**</span></span>|<span data-ttu-id="fc57d-128">**EWS 元素**</span><span class="sxs-lookup"><span data-stu-id="fc57d-128">**EWS element**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="fc57d-129">附件指示器（不标记内嵌附件）</span><span class="sxs-lookup"><span data-stu-id="fc57d-129">Attachment indicator (does not flag inline attachments)</span></span>  <br/> |[<span data-ttu-id="fc57d-130">HasAttachments</span><span class="sxs-lookup"><span data-stu-id="fc57d-130">Item.HasAttachments</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.hasattachments%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="fc57d-131">HasAttachments</span><span class="sxs-lookup"><span data-stu-id="fc57d-131">HasAttachments</span></span>](https://msdn.microsoft.com/library/538b7a85-11d7-4daa-8458-09b540760e8b%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="fc57d-132">附件集合</span><span class="sxs-lookup"><span data-stu-id="fc57d-132">Attachment collection</span></span>  <br/> |[<span data-ttu-id="fc57d-133">项附件</span><span class="sxs-lookup"><span data-stu-id="fc57d-133">Item.Attachments</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.attachments%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="fc57d-134">附件</span><span class="sxs-lookup"><span data-stu-id="fc57d-134">Attachments</span></span>](https://msdn.microsoft.com/library/b470e614-34bb-44f0-8790-7ddbdcbbd29d%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="fc57d-135">附件 ID</span><span class="sxs-lookup"><span data-stu-id="fc57d-135">Attachment ID</span></span>  <br/> |[<span data-ttu-id="fc57d-136">Attachment.Id</span><span class="sxs-lookup"><span data-stu-id="fc57d-136">Attachment.Id</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.attachment.id%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="fc57d-137">AttachmentId</span><span class="sxs-lookup"><span data-stu-id="fc57d-137">AttachmentId</span></span>](https://msdn.microsoft.com/library/55a5fd77-60d1-40fa-8144-770600cedc6a%28Office.15%29.aspx) <br/> |
   
<span data-ttu-id="fc57d-138">**表2。附件实体**</span><span class="sxs-lookup"><span data-stu-id="fc57d-138">**Table 2. Attachment entities**</span></span>

|<span data-ttu-id="fc57d-139">**附件类型**</span><span class="sxs-lookup"><span data-stu-id="fc57d-139">**Attachment type**</span></span>|<span data-ttu-id="fc57d-140">**EWS 托管 API 类**</span><span class="sxs-lookup"><span data-stu-id="fc57d-140">**EWS Managed API class**</span></span>|<span data-ttu-id="fc57d-141">**EWS 元素**</span><span class="sxs-lookup"><span data-stu-id="fc57d-141">**EWS element**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="fc57d-142">文件附件</span><span class="sxs-lookup"><span data-stu-id="fc57d-142">File attachment</span></span>  <br/> |[<span data-ttu-id="fc57d-143">FileAttachment</span><span class="sxs-lookup"><span data-stu-id="fc57d-143">FileAttachment</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.fileattachment%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="fc57d-144">FileAttachment</span><span class="sxs-lookup"><span data-stu-id="fc57d-144">FileAttachment</span></span>](https://msdn.microsoft.com/library/3ecea174-73d1-47fd-8917-6065cef1d565%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="fc57d-145">项目附件</span><span class="sxs-lookup"><span data-stu-id="fc57d-145">Item attachment</span></span>  <br/> |[<span data-ttu-id="fc57d-146">ItemAttachment</span><span class="sxs-lookup"><span data-stu-id="fc57d-146">ItemAttachment</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.itemattachment%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="fc57d-147">ItemAttachment\<TItem\></span><span class="sxs-lookup"><span data-stu-id="fc57d-147">ItemAttachment\<TItem\></span></span>](https://msdn.microsoft.com/library/dd635165%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="fc57d-148">ItemAttachment</span><span class="sxs-lookup"><span data-stu-id="fc57d-148">ItemAttachment</span></span>](https://msdn.microsoft.com/library/089ee599-f45e-46f5-a18a-5cfb3d2851ff%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="fc57d-149">参考附件</span><span class="sxs-lookup"><span data-stu-id="fc57d-149">Reference attachment</span></span>  <br/> |[<span data-ttu-id="fc57d-150">ReferenceAttachmentType 复杂类型（EWS）</span><span class="sxs-lookup"><span data-stu-id="fc57d-150">ReferenceAttachmentType complexType (EWS)</span></span>](https://msdn.microsoft.com/library/18bfa012-e903-d7f3-528a-31ccceb65463%28Office.15%29.aspx) <br/> |[<span data-ttu-id="fc57d-151">ReferenceAttachment</span><span class="sxs-lookup"><span data-stu-id="fc57d-151">ReferenceAttachment</span></span>](https://msdn.microsoft.com/library/b9bde862-6b75-4a81-8033-00a47be4dc2f%28Office.15%29.aspx) <br/> |
   
## <a name="inline-attachments"></a><span data-ttu-id="fc57d-152">内嵌附件</span><span class="sxs-lookup"><span data-stu-id="fc57d-152">Inline attachments</span></span>

<span data-ttu-id="fc57d-153">内嵌附件是一种特殊的附件。</span><span class="sxs-lookup"><span data-stu-id="fc57d-153">Inline attachments are a special breed of attachment.</span></span> <span data-ttu-id="fc57d-154">文件附件和项目附件都可以是内嵌附件。</span><span class="sxs-lookup"><span data-stu-id="fc57d-154">Both file attachments and item attachments can be inline attachments.</span></span> <span data-ttu-id="fc57d-155">内联附件显示为正文内容的一部分，并保持其相对于项目中其余内容的位置。</span><span class="sxs-lookup"><span data-stu-id="fc57d-155">An inline attachment appears as part of the body content and retains its position relative to the rest of the content in the item.</span></span> 
  
<span data-ttu-id="fc57d-156">如果 EWS Managed API [IsInline](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx)属性或 ews [IsInline](https://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx)元素设置为 true，则附件是内嵌附件。</span><span class="sxs-lookup"><span data-stu-id="fc57d-156">An attachment is an inline attachment if the EWS Managed API [IsInline](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx) property or the EWS [IsInline](https://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx) element is set to true.</span></span> <span data-ttu-id="fc57d-157">内联附件使用以下可选属性和元素来标识内嵌附件的位置：</span><span class="sxs-lookup"><span data-stu-id="fc57d-157">Inline attachments use the following optional properties and elements to identify the location of an inline attachment:</span></span> 
  
- <span data-ttu-id="fc57d-158">EWS 托管 API — [ContentId](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.attachment.contentid%28v=exchg.80%29.aspx)或[ContentLocation](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.attachment.contentlocation%28v=exchg.80%29.aspx)属性。</span><span class="sxs-lookup"><span data-stu-id="fc57d-158">EWS Managed API — [ContentId](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.attachment.contentid%28v=exchg.80%29.aspx) or [ContentLocation](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.attachment.contentlocation%28v=exchg.80%29.aspx) properties.</span></span> 
    
- <span data-ttu-id="fc57d-159">EWS — [ContentId](https://msdn.microsoft.com/library/bc59100d-6079-414b-a6e0-7c15feaa3184%28Office.15%29.aspx)或[ContentLocation](https://msdn.microsoft.com/library/d91cf587-24e3-4c13-8784-5ca29787cca7%28Office.15%29.aspx)元素。</span><span class="sxs-lookup"><span data-stu-id="fc57d-159">EWS — [ContentId](https://msdn.microsoft.com/library/bc59100d-6079-414b-a6e0-7c15feaa3184%28Office.15%29.aspx) or [ContentLocation](https://msdn.microsoft.com/library/d91cf587-24e3-4c13-8784-5ca29787cca7%28Office.15%29.aspx) element.</span></span> 
    
<span data-ttu-id="fc57d-160">请注意，EWS Managed API [HasAttachments](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.hasattachments%28v=exchg.80%29.aspx)属性和 ews [HasAttachments](https://msdn.microsoft.com/library/538b7a85-11d7-4daa-8458-09b540760e8b%28Office.15%29.aspx)元素不反映内联附件的存在，这就是为什么嵌入式附件也称为隐藏附件的原因所在。</span><span class="sxs-lookup"><span data-stu-id="fc57d-160">Note that the EWS Managed API [HasAttachments](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.hasattachments%28v=exchg.80%29.aspx) property and the EWS [HasAttachments](https://msdn.microsoft.com/library/538b7a85-11d7-4daa-8458-09b540760e8b%28Office.15%29.aspx) element do not reflect the existence of inline attachments, and that's why inline attachments are also called hidden attachments.</span></span> <span data-ttu-id="fc57d-161">因此，如果您将 EWS Managed API [IsInline](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx)属性或 ews [IsInline](https://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx)元素设置为 true，并且该项目没有其他附件，则**HasAttachments**将设置为 false。</span><span class="sxs-lookup"><span data-stu-id="fc57d-161">So if you set the EWS Managed API [IsInline](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx) property or the EWS [IsInline](https://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx) element to true, and the item has no other attachments, **HasAttachments** will be set to false.</span></span> <span data-ttu-id="fc57d-162">如果您的客户端使用**HasAttachments**填充电子邮件上的附件指示器或图标，请注意，带有内嵌附件的电子邮件不会显示该图标。</span><span class="sxs-lookup"><span data-stu-id="fc57d-162">If your client uses **HasAttachments** to populate an attachment indicator or icon on an email, be aware that the icon will not appear for emails with inline attachments.</span></span> 
  
## <a name="in-this-section"></a><span data-ttu-id="fc57d-163">本节内容</span><span class="sxs-lookup"><span data-stu-id="fc57d-163">In this section</span></span>
<span data-ttu-id="fc57d-164"><a name="bk_inthissection"> </a></span><span class="sxs-lookup"><span data-stu-id="fc57d-164"><a name="bk_inthissection"> </a></span></span>

- [<span data-ttu-id="fc57d-165">使用 Exchange 中的 EWS 添加附件</span><span class="sxs-lookup"><span data-stu-id="fc57d-165">Add attachments by using EWS in Exchange</span></span>](how-to-add-attachments-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="fc57d-166">使用 Exchange 中的 EWS 获取附件</span><span class="sxs-lookup"><span data-stu-id="fc57d-166">Get attachments by using EWS in Exchange</span></span>](how-to-get-attachments-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="fc57d-167">使用 Exchange 中的 EWS 删除附件</span><span class="sxs-lookup"><span data-stu-id="fc57d-167">Delete attachments by using EWS in Exchange</span></span>](how-to-delete-attachments-by-using-ews-in-exchange.md)
    
## <a name="see-also"></a><span data-ttu-id="fc57d-168">另请参阅</span><span class="sxs-lookup"><span data-stu-id="fc57d-168">See also</span></span>
<span data-ttu-id="fc57d-169"><a name="bk_additionalresources"> </a></span><span class="sxs-lookup"><span data-stu-id="fc57d-169"><a name="bk_additionalresources"> </a></span></span>

- [<span data-ttu-id="fc57d-170">开发 Exchange Web 服务客户端</span><span class="sxs-lookup"><span data-stu-id="fc57d-170">Develop web service clients for Exchange</span></span>](develop-web-service-clients-for-exchange.md)
    
- [<span data-ttu-id="fc57d-171">文件夹和交换中的 EWS 中的项目</span><span class="sxs-lookup"><span data-stu-id="fc57d-171">Folders and items in EWS in Exchange</span></span>](folders-and-items-in-ews-in-exchange.md)
    
- [<span data-ttu-id="fc57d-172">电子邮件和 Exchange 中的 EWS</span><span class="sxs-lookup"><span data-stu-id="fc57d-172">Email and EWS in Exchange</span></span>](email-and-ews-in-exchange.md)
    

