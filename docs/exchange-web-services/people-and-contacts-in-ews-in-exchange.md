---
title: 人员和 Exchange 中的 EWS 中的联系人
manager: sethgros
ms.date: 03/9/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 043c33be-a0d1-4bad-a840-85715eda4813
description: 了解角色、 统一联系人存储库，以及如何通过在 Exchange 使用 EWS 的 EWS 托管 API 来处理联系人。
ms.openlocfilehash: fe11c6247cade8e78610d953088f6d593bdb560c
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/25/2018
ms.locfileid: "19753002"
---
# <a name="people-and-contacts-in-ews-in-exchange"></a><span data-ttu-id="a14b1-103">人员和 Exchange 中的 EWS 中的联系人</span><span class="sxs-lookup"><span data-stu-id="a14b1-103">People and contacts in EWS in Exchange</span></span>

<span data-ttu-id="a14b1-104">了解角色、 统一联系人存储库，以及如何通过在 Exchange 使用 EWS 的 EWS 托管 API 来处理联系人。</span><span class="sxs-lookup"><span data-stu-id="a14b1-104">Learn about personas, the Unified Contact Store, and how to work with contacts by using the EWS Managed API or EWS in Exchange.</span></span> 
  
<span data-ttu-id="a14b1-105">联系人是 Exchange 存储个人信息、 组或组织中的项。</span><span class="sxs-lookup"><span data-stu-id="a14b1-105">Contacts are items in Exchange that store information about an individual, group, or organization.</span></span> <span data-ttu-id="a14b1-106">联系人可以包括名称和电子邮件地址和其他信息，包括 IM 地址、 物理地址、 生日、 家族信息和照片或代表该联系人的图像。</span><span class="sxs-lookup"><span data-stu-id="a14b1-106">Contacts can include names and email addresses, and other information, including IM addresses, physical addresses, birthdays, family information, and a photo or image that represents the contact.</span></span>
  
<span data-ttu-id="a14b1-107">联系人信息都存储在两个位置之一：</span><span class="sxs-lookup"><span data-stu-id="a14b1-107">Contact information is stored in one of two places:</span></span>
  
- <span data-ttu-id="a14b1-108">Active Directory 域服务 (AD DS)，如果联系人在组织内。</span><span class="sxs-lookup"><span data-stu-id="a14b1-108">Active Directory Domain Services (AD DS), if the contact is within the organization.</span></span>
    
- <span data-ttu-id="a14b1-109">联系人文件夹或另一个文件夹中用户的邮箱，如果是组织外部的联系人。</span><span class="sxs-lookup"><span data-stu-id="a14b1-109">The Contacts folder or another folder in a user's mailbox, if the contact is outside the organization.</span></span>
    
<span data-ttu-id="a14b1-110">多个联系人项可以表示一个人。</span><span class="sxs-lookup"><span data-stu-id="a14b1-110">Multiple contact items can represent a single individual.</span></span> <span data-ttu-id="a14b1-111">Exchange 使用角色以帮助将这些不同的联系人项目组合在一起。</span><span class="sxs-lookup"><span data-stu-id="a14b1-111">Exchange uses personas to help bring these different contact items together.</span></span> <span data-ttu-id="a14b1-112">*角色*是来自不同源的同一个人的联系人信息的聚合。</span><span class="sxs-lookup"><span data-stu-id="a14b1-112">A  *persona*  is an aggregation of contact information for the same individual from different sources.</span></span> <span data-ttu-id="a14b1-113">另外在 Exchange 联系人信息，角色可以还聚合的收件人缓存的邮箱，调用 QuickContacts，IM 联系人隐藏的文件夹中的信息以及从第三方数据源。</span><span class="sxs-lookup"><span data-stu-id="a14b1-113">In addition to contact information in Exchange, personas can also be aggregated from information in the recipient cache for the mailbox, a hidden folder for IM contacts called QuickContacts, and from third-party data sources.</span></span> <span data-ttu-id="a14b1-114">Exchange 中统一联系人存储库启用 IM 客户端使用此聚合;唯一的区别是统一联系人存储库不聚合信息从 AD DS，如图 1 中所示。</span><span class="sxs-lookup"><span data-stu-id="a14b1-114">The Unified Contact Store in Exchange enables IM clients to use this aggregation; the only difference is that the Unified Contact Store does not aggregate information from AD DS, as shown in Figure 1.</span></span> 
  
<span data-ttu-id="a14b1-115">**图 1。角色和统一联系人存储库的联系信息源**</span><span class="sxs-lookup"><span data-stu-id="a14b1-115">**Figure 1. Contact information sources for personas and for the Unified Contact Store**</span></span>

![显示聚合到角色的源与包含在统一联系人存储中的源的图片。统一联系人存储不会聚合目录服务中的联系人信息。](media/EX15_PersonaOverview.png)
  
<span data-ttu-id="a14b1-118">**表 1。EWS 托管 API 方法和使用联系人的 EWS 操作**</span><span class="sxs-lookup"><span data-stu-id="a14b1-118">**Table 1. EWS Managed API methods and EWS operations for working with contacts**</span></span>

|<span data-ttu-id="a14b1-119">**如果您希望...**</span><span class="sxs-lookup"><span data-stu-id="a14b1-119">**If you want to…**</span></span>|<span data-ttu-id="a14b1-120">**使用此 EWS 托管 API 方法**</span><span class="sxs-lookup"><span data-stu-id="a14b1-120">**Use this EWS Managed API method**</span></span>|<span data-ttu-id="a14b1-121">**使用此 EWS 操作**</span><span class="sxs-lookup"><span data-stu-id="a14b1-121">**Use this EWS operation**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="a14b1-122">创建新的联系人</span><span class="sxs-lookup"><span data-stu-id="a14b1-122">Create a new contact</span></span>  <br/> |<span data-ttu-id="a14b1-123">实例化一个新的[联系](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.contact%28v=exchg.80%29.aspx)对象，并使用[Contact.Save](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.contact.save%28v=exchg.80%29.aspx)</span><span class="sxs-lookup"><span data-stu-id="a14b1-123">Instantiate a new [Contact](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.contact%28v=exchg.80%29.aspx) object, and use [Contact.Save](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.contact.save%28v=exchg.80%29.aspx)</span></span> <br/> |[<span data-ttu-id="a14b1-124">CreateItem</span><span class="sxs-lookup"><span data-stu-id="a14b1-124">CreateItem</span></span>](http://msdn.microsoft.com/library/417e994b-0a17-4c24-9527-04796b80b029%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="a14b1-125">将联系人复制</span><span class="sxs-lookup"><span data-stu-id="a14b1-125">Copy a contact</span></span>  <br/> |[<span data-ttu-id="a14b1-126">Contact.Copy</span><span class="sxs-lookup"><span data-stu-id="a14b1-126">Contact.Copy</span></span>](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.contact.copy%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="a14b1-127">CopyItem</span><span class="sxs-lookup"><span data-stu-id="a14b1-127">CopyItem</span></span>](http://msdn.microsoft.com/library/bcc68f9e-d511-4c29-bba6-ed535524624a%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="a14b1-128">将联系人移动</span><span class="sxs-lookup"><span data-stu-id="a14b1-128">Move a contact</span></span>  <br/> |[<span data-ttu-id="a14b1-129">Contact.Move</span><span class="sxs-lookup"><span data-stu-id="a14b1-129">Contact.Move</span></span>](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.contact.move%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="a14b1-130">MoveItem</span><span class="sxs-lookup"><span data-stu-id="a14b1-130">MoveItem</span></span>](http://msdn.microsoft.com/library/dcf40fa7-7796-4a5c-bf5b-7a509a18d208%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="a14b1-131">更新现有联系人</span><span class="sxs-lookup"><span data-stu-id="a14b1-131">Update an existing contact</span></span>  <br/> |<span data-ttu-id="a14b1-132">[Contact.Bind](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx)和[Contact.Update](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.contact.update%28v=exchg.80%29.aspx)</span><span class="sxs-lookup"><span data-stu-id="a14b1-132">[Contact.Bind](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx) and [Contact.Update](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.contact.update%28v=exchg.80%29.aspx)</span></span> <br/> |[<span data-ttu-id="a14b1-133">UpdateItem</span><span class="sxs-lookup"><span data-stu-id="a14b1-133">UpdateItem</span></span>](http://msdn.microsoft.com/library/298fdd71-a83d-4407-9728-4f0a8e2d857c%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="a14b1-134">删除联系人</span><span class="sxs-lookup"><span data-stu-id="a14b1-134">Delete a contact</span></span>  <br/> |<span data-ttu-id="a14b1-135">[Contact.Bind](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx)和[Contact.Delete](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.contact.delete%28v=exchg.80%29.aspx)</span><span class="sxs-lookup"><span data-stu-id="a14b1-135">[Contact.Bind](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx) and [Contact.Delete](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.contact.delete%28v=exchg.80%29.aspx)</span></span> <br/> |[<span data-ttu-id="a14b1-136">删除项</span><span class="sxs-lookup"><span data-stu-id="a14b1-136">DeleteItem</span></span>](http://msdn.microsoft.com/library/3e26c416-fa12-476e-bfd2-5c1f4bb7b348%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="a14b1-137">搜索联系人</span><span class="sxs-lookup"><span data-stu-id="a14b1-137">Search for a contact</span></span>  <br/> |[<span data-ttu-id="a14b1-138">ExchangeService.FindItems</span><span class="sxs-lookup"><span data-stu-id="a14b1-138">ExchangeService.FindItems</span></span>](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="a14b1-139">FindItem</span><span class="sxs-lookup"><span data-stu-id="a14b1-139">FindItem</span></span>](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="a14b1-140">人员搜索</span><span class="sxs-lookup"><span data-stu-id="a14b1-140">Search for people</span></span>  <br/> |<span data-ttu-id="a14b1-141">N/A</span><span class="sxs-lookup"><span data-stu-id="a14b1-141">N/A</span></span>  <br/> |[<span data-ttu-id="a14b1-142">FindPeople</span><span class="sxs-lookup"><span data-stu-id="a14b1-142">FindPeople</span></span>](http://msdn.microsoft.com/library/446106b7-ff2d-4107-90c1-29f4d38ba128%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="a14b1-143">展开通讯组</span><span class="sxs-lookup"><span data-stu-id="a14b1-143">Expand a distribution group</span></span>  <br/> |[<span data-ttu-id="a14b1-144">ExchangeService.ExpandGroup</span><span class="sxs-lookup"><span data-stu-id="a14b1-144">ExchangeService.ExpandGroup</span></span>](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.exchangeservice.expandgroup%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="a14b1-145">ExpandDL</span><span class="sxs-lookup"><span data-stu-id="a14b1-145">ExpandDL</span></span>](http://msdn.microsoft.com/library/1f7837e7-9eff-4e10-9577-c40f7ed6af94%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="a14b1-146">模糊名称解析</span><span class="sxs-lookup"><span data-stu-id="a14b1-146">Resolve an ambiguous name</span></span>  <br/> |[<span data-ttu-id="a14b1-147">ExchangeService.ResolveName</span><span class="sxs-lookup"><span data-stu-id="a14b1-147">ExchangeService.ResolveName</span></span>](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.exchangeservice.resolvename%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="a14b1-148">ResolveNames</span><span class="sxs-lookup"><span data-stu-id="a14b1-148">ResolveNames</span></span>](http://msdn.microsoft.com/library/6b4eb4b3-9ad6-4804-a09f-7e20cfea4dbb%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="a14b1-149">获取一个角色</span><span class="sxs-lookup"><span data-stu-id="a14b1-149">Get a persona</span></span>  <br/> |<span data-ttu-id="a14b1-150">N/A</span><span class="sxs-lookup"><span data-stu-id="a14b1-150">N/A</span></span>  <br/> |[<span data-ttu-id="a14b1-151">GetPersona</span><span class="sxs-lookup"><span data-stu-id="a14b1-151">GetPersona</span></span>](http://msdn.microsoft.com/library/e2146df0-53d0-4caf-9758-b600bbc14b6a%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="a14b1-152">使用联系人照片</span><span class="sxs-lookup"><span data-stu-id="a14b1-152">Work with contact photos</span></span>  <br/> |<span data-ttu-id="a14b1-153">[Contact.SetContactPicture](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.contact.setcontactpicture%28v=exchg.80%29.aspx)、 [Contact.GetContactPictureAttachment](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.contact.getcontactpictureattachment%28v=exchg.80%29.aspx)或[Contact.RemoveContactPicture](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.contact.setcontactpicture%28v=exchg.80%29.aspx)</span><span class="sxs-lookup"><span data-stu-id="a14b1-153">[Contact.SetContactPicture](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.contact.setcontactpicture%28v=exchg.80%29.aspx), [Contact.GetContactPictureAttachment](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.contact.getcontactpictureattachment%28v=exchg.80%29.aspx), or [Contact.RemoveContactPicture](http://msdn.microsoft.com/en-us/library/office/microsoft.exchange.webservices.data.contact.setcontactpicture%28v=exchg.80%29.aspx)</span></span> <br/> |<span data-ttu-id="a14b1-154">[GetUserPhoto](http://msdn.microsoft.com/library/f6e8143d-4235-428e-8f9c-ab6e9b1cfa6e%28Office.15%29.aspx)或[GetAttachment](http://msdn.microsoft.com/library/24d10a15-b942-415e-9024-a6375708f326%28Office.15%29.aspx)</span><span class="sxs-lookup"><span data-stu-id="a14b1-154">[GetUserPhoto](http://msdn.microsoft.com/library/f6e8143d-4235-428e-8f9c-ab6e9b1cfa6e%28Office.15%29.aspx) or [GetAttachment](http://msdn.microsoft.com/library/24d10a15-b942-415e-9024-a6375708f326%28Office.15%29.aspx)</span></span> <br/> |
   
## <a name="personas"></a><span data-ttu-id="a14b1-155">角色</span><span class="sxs-lookup"><span data-stu-id="a14b1-155">Personas</span></span>
<span data-ttu-id="a14b1-156"><a name="PEOPLESEARCH"> </a></span><span class="sxs-lookup"><span data-stu-id="a14b1-156"></span></span>

<span data-ttu-id="a14b1-157">直到最近，联系人已将通常存储在一个位置 — 通常情况下，电子邮件客户端上。</span><span class="sxs-lookup"><span data-stu-id="a14b1-157">Until recently, contacts were commonly stored in a single location — typically, on an email client.</span></span> <span data-ttu-id="a14b1-158">如今，变得更为常见存储联系人在许多不同的位置，如在电话上，在 Exchange 邮箱，或在组织的目录服务中的联系人文件夹中的社交网络网站上。</span><span class="sxs-lookup"><span data-stu-id="a14b1-158">Today, it is becoming more common to store contacts in many different locations, such as on a phone, on a social networking site, in a Contacts folder in an Exchange mailbox, or in an organization's directory service.</span></span> <span data-ttu-id="a14b1-159">与联系人信息的扩散打开了，则可能表示同一个人的多个联系人包含不同的信息;例如，一个联系人可能包括商务电话号码，另一个个人电话号码或联系人存储在联系人文件夹中可能不同于存储在您的电话的同一个人的联系人的名称。</span><span class="sxs-lookup"><span data-stu-id="a14b1-159">With the proliferation of contact information, it's possible that multiple contacts that represent the same person contain different information; for example, one contact might include a business phone number and another a personal phone number, or a contact stored in a Contacts folder might have a different name than the contact for the same person that is stored on your phone.</span></span>
  
<span data-ttu-id="a14b1-160">在 Exchange Online 中，Exchange Online 作为 Office 365 和 Exchange 开头 Exchange 2013 的本地版本的一部分来自不同源表示同一个人联系人都与另一，类似于电子邮件的方式是聚合到对话，通过一个常见链接 id。</span><span class="sxs-lookup"><span data-stu-id="a14b1-160">In Exchange Online, Exchange Online as part of Office 365, and on-premises versions of Exchange starting with Exchange 2013, contacts from different sources that represent the same person are associated with one another, similar to the way that email messages are aggregated into conversations, by means of a common link ID.</span></span> <span data-ttu-id="a14b1-161">由 Exchange 服务器返回聚合的联系信息时，它包括一组属性的每个联系人，如源文件夹、 显示名称、 ID 和源 id。</span><span class="sxs-lookup"><span data-stu-id="a14b1-161">When aggregated contact information is returned by an Exchange server, it includes a set of attributes for each contact, such as a source folder, a display name, an ID, and a source ID.</span></span> <span data-ttu-id="a14b1-162">属性和属性返回的总和称为角色时，并返回的属性集被称为[角色的形状](http://msdn.microsoft.com/library/61d87cd5-3270-40d1-bab7-d0d5bf938607%28Office.15%29.aspx)。</span><span class="sxs-lookup"><span data-stu-id="a14b1-162">The sum of the properties and attributes returned is known as a persona, and the set of properties returned is referred to as the [persona's shape](http://msdn.microsoft.com/library/61d87cd5-3270-40d1-bab7-d0d5bf938607%28Office.15%29.aspx).</span></span>
  
<span data-ttu-id="a14b1-163">因为构成个人信息不存储在一个位置，而且这些信息可随时更改，仅当对 Exchange 服务器发出请求时创建角色。</span><span class="sxs-lookup"><span data-stu-id="a14b1-163">Because the information that makes up a persona is not stored in a single location, and because that information can change at any time, a persona is created only when you make a request to an Exchange server.</span></span> <span data-ttu-id="a14b1-164">使用[FindPeople](http://msdn.microsoft.com/library/446106b7-ff2d-4107-90c1-29f4d38ba128%28Office.15%29.aspx) EWS 操作来发出个人搜索请求。</span><span class="sxs-lookup"><span data-stu-id="a14b1-164">You use the [FindPeople](http://msdn.microsoft.com/library/446106b7-ff2d-4107-90c1-29f4d38ba128%28Office.15%29.aspx) EWS operation to make a persona search request.</span></span> <span data-ttu-id="a14b1-165">您的请求可以包括排序顺序，并可以根据查询字符串以帮助您找到正确的角色排序和筛选结果进行筛选。</span><span class="sxs-lookup"><span data-stu-id="a14b1-165">Your request can include a sort order, and can be filtered according to a query string to help you find the correct persona by ordering and filtering the results.</span></span> <span data-ttu-id="a14b1-166">例如，您可以检索的显示名称和一套与特定联系人从联系人文件夹、 Hotmail 帐户、 的 LinkedIn 帐户和公司的目录服务相关联的所有电子邮件地址或者可以检索一的所有角色的具有 IM 地址。</span><span class="sxs-lookup"><span data-stu-id="a14b1-166">For example, you can retrieve the display name and a set of all email addresses that are associated with a specific contact from the Contacts folder, a Hotmail account, a LinkedIn account, and a company's directory service, or you can retrieve a set of all personas that have IM addresses.</span></span> <span data-ttu-id="a14b1-167">联系人链接到角色是自动根据识别存储在各种设备上的联系人之间的关系的算法。</span><span class="sxs-lookup"><span data-stu-id="a14b1-167">The linking of contacts into personas is automatic based on an algorithm that recognizes a relationship between contacts stored on various devices.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="a14b1-168">EWS 托管 API 无法实现此功能。</span><span class="sxs-lookup"><span data-stu-id="a14b1-168">The EWS Managed API does not implement this functionality.</span></span> 
  
<span data-ttu-id="a14b1-169">**表 2。使用角色的 EWS 操作**</span><span class="sxs-lookup"><span data-stu-id="a14b1-169">**Table 2. EWS operations for working with personas**</span></span>

|<span data-ttu-id="a14b1-170">**操作名称**</span><span class="sxs-lookup"><span data-stu-id="a14b1-170">**Operation name**</span></span>|<span data-ttu-id="a14b1-171">**说明**</span><span class="sxs-lookup"><span data-stu-id="a14b1-171">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="a14b1-172">FindPeople</span><span class="sxs-lookup"><span data-stu-id="a14b1-172">FindPeople</span></span>](http://msdn.microsoft.com/library/446106b7-ff2d-4107-90c1-29f4d38ba128%28Office.15%29.aspx) <br/> |<span data-ttu-id="a14b1-173">从指定的联系人文件夹中返回所有可用的角色或检索与指定的查询字符串匹配的联系人。</span><span class="sxs-lookup"><span data-stu-id="a14b1-173">Returns all available personas from a specified contacts folder or retrieves contacts that match a specified query string.</span></span>  <br/> |
|[<span data-ttu-id="a14b1-174">GetPersona</span><span class="sxs-lookup"><span data-stu-id="a14b1-174">GetPersona</span></span>](http://msdn.microsoft.com/library/e2146df0-53d0-4caf-9758-b600bbc14b6a%28Office.15%29.aspx) <br/> |<span data-ttu-id="a14b1-175">返回一组与特定的角色，如所有 IM 地址或显示名称指定的个人 id 属性</span><span class="sxs-lookup"><span data-stu-id="a14b1-175">Returns a set of properties associated with a specific persona, such as all the IM addresses or display names for a specified persona ID.</span></span>  <br/> |
   
<span data-ttu-id="a14b1-176">您可以使用的**GetPersona**和**FindPeople**操作高效地来自多个源检索联系信息。</span><span class="sxs-lookup"><span data-stu-id="a14b1-176">You can use the **GetPersona** and **FindPeople** operations to efficiently retrieve contact information from multiple sources.</span></span> <span data-ttu-id="a14b1-177">与角色相关的所有项目都都具有链接 ID 相关联，因为您可以使用多种使用联系人数据的应用程序中的这些操作。</span><span class="sxs-lookup"><span data-stu-id="a14b1-177">Because all items related to a persona are associated with a link ID, you can use these operations in a wide variety of applications that use contact data.</span></span> <span data-ttu-id="a14b1-178">以下是一些示例：</span><span class="sxs-lookup"><span data-stu-id="a14b1-178">The following are some examples:</span></span> 
  
- <span data-ttu-id="a14b1-179">当用户呼叫联系人，然后提供其他电话号码，如果没有人应答呼叫时使用**GetPersona**操作的移动电话应用程序。</span><span class="sxs-lookup"><span data-stu-id="a14b1-179">A mobile phone app that uses the **GetPersona** operation when a user calls a contact, and then offers additional phone numbers to call if no one answers.</span></span> 
    
- <span data-ttu-id="a14b1-180">使用**FindPeople**操作要扫描电子邮件地址，以确定是否找到这些现有角色中的收件箱邮件应用程序。</span><span class="sxs-lookup"><span data-stu-id="a14b1-180">An application that uses the **FindPeople** operation to scan Inbox messages for email addresses to determine whether they are found in an existing persona.</span></span> <span data-ttu-id="a14b1-181">用于创建销售商机或列表最近的所有通信与由该角色的用户尚不与角色相关联的地址。</span><span class="sxs-lookup"><span data-stu-id="a14b1-181">Addresses that are not already associated with a persona can be used to create sales leads or list all recent communications with the person represented by that persona.</span></span> 
    
- <span data-ttu-id="a14b1-182">[Outlook 邮件应用程序](mail-apps-for-outlook-and-ews-in-exchange.md)提供基于信件是否正式或非正式的不同称呼。</span><span class="sxs-lookup"><span data-stu-id="a14b1-182">[A mail app for Outlook](mail-apps-for-outlook-and-ews-in-exchange.md) that offers different salutations based on whether correspondence is formal or informal.</span></span> <span data-ttu-id="a14b1-183">正式称呼由从目录服务的显示名称和非正式称呼来自是社交网络联系人的显示名称。</span><span class="sxs-lookup"><span data-stu-id="a14b1-183">Formal salutations are supplied by the display names from the directory service and informal salutations come from the display name that originates in social network contacts.</span></span> 
    
## <a name="unified-contact-store"></a><span data-ttu-id="a14b1-184">统一的联系人存储库</span><span class="sxs-lookup"><span data-stu-id="a14b1-184">Unified Contact Store</span></span>
<span data-ttu-id="a14b1-185"><a name="PEOPLESEARCH"> </a></span><span class="sxs-lookup"><span data-stu-id="a14b1-185"></span></span>

<span data-ttu-id="a14b1-186">角色不仅限于电子邮件客户端。</span><span class="sxs-lookup"><span data-stu-id="a14b1-186">Personas aren't just limited to an email client.</span></span> <span data-ttu-id="a14b1-187">如果您正在开发的 IM 客户端，您可能会让您自己任意或全部操作：</span><span class="sxs-lookup"><span data-stu-id="a14b1-187">If you're developing an IM client, you might ask yourself any or all of the following:</span></span>
  
- <span data-ttu-id="a14b1-188">如何设置与一组默认的 IM 联系人项目的 Lync 客户端应用程序？</span><span class="sxs-lookup"><span data-stu-id="a14b1-188">How can I provision Lync client applications with a default set of IM contact items?</span></span>
    
- <span data-ttu-id="a14b1-189">如何管理 IM 联系人和组列表？</span><span class="sxs-lookup"><span data-stu-id="a14b1-189">How do I manage IM contact and group lists?</span></span>
    
- <span data-ttu-id="a14b1-190">如何管理自定义 Lync 客户端访问 IM 联系人和 IM 组？</span><span class="sxs-lookup"><span data-stu-id="a14b1-190">How do I manage custom Lync client access to IM contacts and IM groups?</span></span>
    
<span data-ttu-id="a14b1-191">统一联系人存储库在后台运行在 Exchange 聚合联系人数据从 Exchange 和其他源到单个实体或角色。</span><span class="sxs-lookup"><span data-stu-id="a14b1-191">The Unified Contact Store works behind the scenes in Exchange to aggregate contact data from Exchange and other sources into a single entity, or persona.</span></span> <span data-ttu-id="a14b1-192">虽然用于访问统一联系人存储库的 EWS 操作是特定于 IM 联系人，您可以使用统一联系人存储库在 Exchange 以与所有类型的应用程序中的角色。</span><span class="sxs-lookup"><span data-stu-id="a14b1-192">Although the EWS operations that you use to access the Unified Contact Store are specific to IM contacts, You can use the Unified Contact Store in Exchange to work with personas in all types of applications.</span></span> <span data-ttu-id="a14b1-193">请记住统一联系人存储库无法访问联系人数据 AD DS。</span><span class="sxs-lookup"><span data-stu-id="a14b1-193">Keep in mind that the Unified Contact Store cannot access contact data AD DS.</span></span>
  
<span data-ttu-id="a14b1-194">IM 联系人存储在名为 QuickContacts 的隐藏文件夹中。</span><span class="sxs-lookup"><span data-stu-id="a14b1-194">IM contacts are stored in a hidden folder called QuickContacts.</span></span> <span data-ttu-id="a14b1-195">您可以使用的**AddNewImContactToGroup**和**AddImContactToGroup**操作将联系人添加到此隐藏的文件夹中存储的组。</span><span class="sxs-lookup"><span data-stu-id="a14b1-195">You can use the **AddNewImContactToGroup** and **AddImContactToGroup** operations to add contacts to groups that are stored in this hidden folder.</span></span> <span data-ttu-id="a14b1-196">因为您可以使用 IM 联系人进行分组到统一联系人存储库，可以访问和更轻松地更新联系人的组。</span><span class="sxs-lookup"><span data-stu-id="a14b1-196">And because you can use the Unified Contact Store to group IM contacts, you can access and update groups of contacts more easily.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="a14b1-197">EWS 托管 API 无法实现此功能。</span><span class="sxs-lookup"><span data-stu-id="a14b1-197">The EWS Managed API does not implement this functionality.</span></span> 
  
<span data-ttu-id="a14b1-198">**表 3。用于访问统一联系人存储库的 EWS 操作**</span><span class="sxs-lookup"><span data-stu-id="a14b1-198">**Table 3. EWS operations for accessing the Unified Contact Store**</span></span>

|<span data-ttu-id="a14b1-199">**操作名称**</span><span class="sxs-lookup"><span data-stu-id="a14b1-199">**Operation name**</span></span>|<span data-ttu-id="a14b1-200">**说明**</span><span class="sxs-lookup"><span data-stu-id="a14b1-200">**Description**</span></span>|
|:-----|:-----|
|[<span data-ttu-id="a14b1-201">AddNewImContactToGroup</span><span class="sxs-lookup"><span data-stu-id="a14b1-201">AddNewImContactToGroup</span></span>](http://msdn.microsoft.com/library/0cb5525f-faa3-48f1-9551-df55ffc26f46%28Office.15%29.aspx) <br/> |<span data-ttu-id="a14b1-202">将新的 IM 联系人添加到 IM 组中，最多 1000年联系人。</span><span class="sxs-lookup"><span data-stu-id="a14b1-202">Adds a new IM contact to an IM group, up to a maximum of 1000 contacts.</span></span>  <br/> |
|[<span data-ttu-id="a14b1-203">AddImContactToGroup</span><span class="sxs-lookup"><span data-stu-id="a14b1-203">AddImContactToGroup</span></span>](http://msdn.microsoft.com/library/376acc42-2684-4596-aca1-82a4a10865c9%28Office.15%29.aspx) <br/> |<span data-ttu-id="a14b1-204">将现有的即时消息联系人添加到 IM 组中，最多 1000年联系人。</span><span class="sxs-lookup"><span data-stu-id="a14b1-204">Adds an existing IM contact to an IM group, up to a maximum of 1000 contacts.</span></span>  <br/> |
|[<span data-ttu-id="a14b1-205">AddImGroup</span><span class="sxs-lookup"><span data-stu-id="a14b1-205">AddImGroup</span></span>](http://msdn.microsoft.com/library/6df6e504-b7c8-4773-b10f-ffa5defac229%28Office.15%29.aspx) <br/> |<span data-ttu-id="a14b1-206">添加一个新的 IM 组，64 组最多。</span><span class="sxs-lookup"><span data-stu-id="a14b1-206">Adds a new IM group, up to a maximum of 64 groups.</span></span>  <br/> |
|[<span data-ttu-id="a14b1-207">AddDistributionGroupToImList</span><span class="sxs-lookup"><span data-stu-id="a14b1-207">AddDistributionGroupToImList</span></span>](http://msdn.microsoft.com/library/5aa9bec8-71cf-4a6e-8ec8-b4965b40fd4a%28Office.15%29.aspx) <br/> |<span data-ttu-id="a14b1-208">将新的通讯组添加到 IM 组中，64 组最多。</span><span class="sxs-lookup"><span data-stu-id="a14b1-208">Adds a new distribution group to an IM group, up to a maximum of 64 groups.</span></span>  <br/> |
|[<span data-ttu-id="a14b1-209">GetImItemList</span><span class="sxs-lookup"><span data-stu-id="a14b1-209">GetImItemList</span></span>](http://msdn.microsoft.com/library/e31d14e1-0c1f-4b69-98b7-157d59c13698%28Office.15%29.aspx) <br/> |<span data-ttu-id="a14b1-210">检索 IM 组和 IM 联系人角色的列表。</span><span class="sxs-lookup"><span data-stu-id="a14b1-210">Retrieves a list of IM groups and IM contact personas.</span></span>  <br/> |
|[<span data-ttu-id="a14b1-211">GetImItems</span><span class="sxs-lookup"><span data-stu-id="a14b1-211">GetImItems</span></span>](http://msdn.microsoft.com/library/51186691-46d2-4d5c-b8bc-4ee2bb20fbe7%28Office.15%29.aspx) <br/> |<span data-ttu-id="a14b1-212">检索有关特定 IM 组和 IM 联系人角色的信息。</span><span class="sxs-lookup"><span data-stu-id="a14b1-212">Retrieves information about specific IM groups and IM contact personas.</span></span>  <br/> |
|[<span data-ttu-id="a14b1-213">RemoveContactFromImList</span><span class="sxs-lookup"><span data-stu-id="a14b1-213">RemoveContactFromImList</span></span>](http://msdn.microsoft.com/library/28ec96c3-45af-48ff-9f17-718a527dc0ad%28Office.15%29.aspx) <br/> |<span data-ttu-id="a14b1-214">从 IM 组中删除联系人。</span><span class="sxs-lookup"><span data-stu-id="a14b1-214">Removes a contact from an IM group.</span></span>  <br/> |
|[<span data-ttu-id="a14b1-215">RemoveImContactFromGroup</span><span class="sxs-lookup"><span data-stu-id="a14b1-215">RemoveImContactFromGroup</span></span>](http://msdn.microsoft.com/library/a190bbec-c71b-4e6a-880b-55854c724d8c%28Office.15%29.aspx) <br/> |<span data-ttu-id="a14b1-216">从 IM 组中删除 IM 联系人。</span><span class="sxs-lookup"><span data-stu-id="a14b1-216">Removes an IM contact from an IM group.</span></span>  <br/> |
|[<span data-ttu-id="a14b1-217">RemoveDistributionGroupFromImList</span><span class="sxs-lookup"><span data-stu-id="a14b1-217">RemoveDistributionGroupFromImList</span></span>](http://msdn.microsoft.com/library/252bddf2-98b6-4824-b548-2fba2bda5384%28Office.15%29.aspx) <br/> |<span data-ttu-id="a14b1-218">从 IM 组中删除通讯组。</span><span class="sxs-lookup"><span data-stu-id="a14b1-218">Removes a distribution group from an IM group.</span></span>  <br/> |
|[<span data-ttu-id="a14b1-219">RemoveImGroup</span><span class="sxs-lookup"><span data-stu-id="a14b1-219">RemoveImGroup</span></span>](http://msdn.microsoft.com/library/5e788016-68e0-4a3f-9243-03f6b6c6b389%28Office.15%29.aspx) <br/> |<span data-ttu-id="a14b1-220">删除 IM 组。</span><span class="sxs-lookup"><span data-stu-id="a14b1-220">Removes an IM group.</span></span>  <br/> |
|[<span data-ttu-id="a14b1-221">SetImGroup</span><span class="sxs-lookup"><span data-stu-id="a14b1-221">SetImGroup</span></span>](http://msdn.microsoft.com/library/2d48aa07-8152-4c3d-a519-061253e80174%28Office.15%29.aspx) <br/> |<span data-ttu-id="a14b1-222">更改 IM 组的显示名称。</span><span class="sxs-lookup"><span data-stu-id="a14b1-222">Changes the display name of an IM group.</span></span>  <br/> |
   
## <a name="in-this-section"></a><span data-ttu-id="a14b1-223">本节内容</span><span class="sxs-lookup"><span data-stu-id="a14b1-223">In this section</span></span>
<span data-ttu-id="a14b1-224"><a name="PEOPLESEARCH"> </a></span><span class="sxs-lookup"><span data-stu-id="a14b1-224"></span></span>

- [<span data-ttu-id="a14b1-225">在 Exchange 使用 EWS 的批次中的过程联系人</span><span class="sxs-lookup"><span data-stu-id="a14b1-225">Process contacts in batches by using EWS in Exchange</span></span>](how-to-process-contacts-in-batches-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="a14b1-226">模糊名称解析使用 EWS 在 Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="a14b1-226">Resolve ambiguous names by using EWS in Exchange 2013</span></span>](how-to-resolve-ambiguous-names-by-using-ews-in-exchange-2013.md)
    
- [<span data-ttu-id="a14b1-227">要在 Exchange 使用 EWS 获取用户照片</span><span class="sxs-lookup"><span data-stu-id="a14b1-227">Get user photos by using EWS in Exchange</span></span>](how-to-get-user-photos-by-using-ews-in-exchange.md)
    
## <a name="see-also"></a><span data-ttu-id="a14b1-228">另请参阅</span><span class="sxs-lookup"><span data-stu-id="a14b1-228">See also</span></span>
<span data-ttu-id="a14b1-229"><a name="PEOPLESEARCH"> </a></span><span class="sxs-lookup"><span data-stu-id="a14b1-229"></span></span>

- [<span data-ttu-id="a14b1-230">开发 Exchange Web 服务客户端</span><span class="sxs-lookup"><span data-stu-id="a14b1-230">Develop web service clients for Exchange</span></span>](develop-web-service-clients-for-exchange.md)
    
- [<span data-ttu-id="a14b1-231">Start using web services in Exchange</span><span class="sxs-lookup"><span data-stu-id="a14b1-231">Start using web services in Exchange</span></span>](start-using-web-services-in-exchange.md)
    
- [<span data-ttu-id="a14b1-232">Exchange 的 EWS 客户端设计概述</span><span class="sxs-lookup"><span data-stu-id="a14b1-232">EWS client design overview for Exchange</span></span>](ews-client-design-overview-for-exchange.md)
    

