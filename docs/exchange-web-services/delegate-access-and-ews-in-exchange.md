---
title: 代理访问和 Exchange 中的 EWS
manager: sethgros
ms.date: 03/9/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 240d1776-7adc-46cd-9099-88ffeba0a8aa
description: 了解如何使用 EWS 托管 API 和 EWS 在 Exchange 提供对用户邮箱的代理访问。
ms.openlocfilehash: 0416ed1889a7c235a35cb49290d39d3ccfc28c49
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/25/2018
ms.locfileid: "19752722"
---
# <a name="delegate-access-and-ews-in-exchange"></a><span data-ttu-id="d271a-103">代理访问和 Exchange 中的 EWS</span><span class="sxs-lookup"><span data-stu-id="d271a-103">Delegate access and EWS in Exchange</span></span>

<span data-ttu-id="d271a-104">了解如何使用 EWS 托管 API 和 EWS 在 Exchange 提供对用户邮箱的代理访问。</span><span class="sxs-lookup"><span data-stu-id="d271a-104">Find out how to use the EWS Managed API and EWS in Exchange to provide delegate access to users' mailboxes.</span></span>
  
<span data-ttu-id="d271a-105">您可以让用户能够访问其他用户的邮箱的三种方式之一：</span><span class="sxs-lookup"><span data-stu-id="d271a-105">You can enable users to access other users' mailboxes in one of three ways:</span></span> 
  
- <span data-ttu-id="d271a-106">添加代理人，并指定每个代理人的权限。</span><span class="sxs-lookup"><span data-stu-id="d271a-106">By adding delegates and specifying permissions for each delegate.</span></span>
    
- <span data-ttu-id="d271a-107">通过直接修改文件夹权限。</span><span class="sxs-lookup"><span data-stu-id="d271a-107">By modifying folder permissions directly.</span></span>
    
- <span data-ttu-id="d271a-108">使用模拟。</span><span class="sxs-lookup"><span data-stu-id="d271a-108">By using impersonation.</span></span>
    
<span data-ttu-id="d271a-109">委派和文件夹权限是最佳时要仅对少数用户授权访问因为您需要为每个邮箱单独添加权限。</span><span class="sxs-lookup"><span data-stu-id="d271a-109">Delegation and folder permissions are best when you're only granting access to a few users, because you have to add permissions individually to each mailbox.</span></span> <span data-ttu-id="d271a-110">模拟是最佳选择当您处理的数量的邮箱，因为您可以轻松地启用一个服务帐户以访问数据库中的每个邮箱。</span><span class="sxs-lookup"><span data-stu-id="d271a-110">Impersonation is the best choice when you're dealing with quantities of mailboxes, because you can easily enable one service account to access every mailbox in a database.</span></span> <span data-ttu-id="d271a-111">图 1 显示了一些每种类型的访问之间的差异。</span><span class="sxs-lookup"><span data-stu-id="d271a-111">Figure 1 shows some of the differences between each type of access.</span></span>
  
<span data-ttu-id="d271a-112">**图 1。方式访问其他用户的邮箱**</span><span class="sxs-lookup"><span data-stu-id="d271a-112">**Figure 1. Ways to access other users' mailboxes**</span></span>

![显示邮箱访问类型、邮箱所有者与每种类型的委派之间的关系以及权限类型的图表。代表委派权限和/或文件夹权限发送。用于模拟的发送身份权限。](media/Ex15_Delegate_Overview.png)
  
<span data-ttu-id="d271a-116">当谈到发送邮件或安排会议时，代理人可授予"代表发送"权限，因此收件人的电子邮件或会议要求已发送的代理人将看到"代表*邮箱所有者*的*委派*"时其接收e 在 Outlook 中的电子邮件或会议请求。</span><span class="sxs-lookup"><span data-stu-id="d271a-116">When it comes to sending mail or scheduling meetings, delegates can be given "send on behalf of" permissions, so the recipient of an email or a meeting request that was sent by a delegate will see " *delegate*  on behalf of  *mailbox owner*  " when they receive the email or meeting request in Outlook.</span></span> <span data-ttu-id="d271a-117">包括"代表发送"文本是客户端实现的详细信息的并且可以创建使用"从"和"发件人"值。</span><span class="sxs-lookup"><span data-stu-id="d271a-117">Including the "send on behalf of" text is a client implementation detail - and can be created by using the "from" and "sender" values.</span></span> <span data-ttu-id="d271a-118">将"从"值指示邮箱所有者，并"发件人"值指示已发送邮件的代理人。</span><span class="sxs-lookup"><span data-stu-id="d271a-118">The "from" value indicates the mailbox owner, and the "sender" value indicates the delegate that sent the mail.</span></span> <span data-ttu-id="d271a-119">如果模拟用户的服务帐户发送电子邮件，或为邮箱所有者安排会议，"发送邮件作为"邮箱所有者。</span><span class="sxs-lookup"><span data-stu-id="d271a-119">If a service account impersonating a user sends an email or schedules a meeting for the mailbox owner, the message is "sent as" the mailbox owner.</span></span> <span data-ttu-id="d271a-120">没有要了解的服务帐户已发送邮件的收件人方法。</span><span class="sxs-lookup"><span data-stu-id="d271a-120">There is no way for the recipient to know the mail was sent by the service account.</span></span> <span data-ttu-id="d271a-121">授予文件夹权限以及不委派访问权限的用户将不能以"代理发送"或"代表发送"的邮箱所有者。</span><span class="sxs-lookup"><span data-stu-id="d271a-121">Users who are granted folder permissions and not delegate access are not able to "send as" or "send on behalf of" of a mailbox owner.</span></span> <span data-ttu-id="d271a-122">他们有权访问邮箱文件夹，并可能能够在文件夹中创建项目，但他们不能发送项目。</span><span class="sxs-lookup"><span data-stu-id="d271a-122">They have access to the mailbox folders, and might be able to create items in the folders, but they cannot send the items.</span></span> 
  
<span data-ttu-id="d271a-123">时，适合直接修改文件夹权限？</span><span class="sxs-lookup"><span data-stu-id="d271a-123">When is it appropriate to modify folder permissions directly?</span></span> <span data-ttu-id="d271a-124">一般情况下，您想要提供用户访问的文件夹，但不是想授予用户权限要求未映射到[DelegateFolderPermissionLevel](http://msdn.microsoft.com/zh-cn/library/microsoft.exchange.webservices.data.delegatefolderpermissionlevel%28v=exchg.80%29.aspx) EWS 托管 API 枚举值时"代表发送"权限，或[PermissionLevel](http://msdn.microsoft.com/library/87978600-3523-451e-a725-ef092c543e2a%28Office.15%29.aspx)EWS 元素的值，或当您想要提供对一个自定义文件夹的用户访问。</span><span class="sxs-lookup"><span data-stu-id="d271a-124">Generally, when you want to provide a user access to a folder, but do not want to grant the user "send on behalf of" permissions, when your permissions requirements do not map to the [DelegateFolderPermissionLevel](http://msdn.microsoft.com/zh-cn/library/microsoft.exchange.webservices.data.delegatefolderpermissionlevel%28v=exchg.80%29.aspx) EWS Managed API enumeration values or the [PermissionLevel](http://msdn.microsoft.com/library/87978600-3523-451e-a725-ef092c543e2a%28Office.15%29.aspx) EWS element values, or when you want to provide a user access to a single custom folder.</span></span> 
  
<span data-ttu-id="d271a-125">如果您只需修改文件夹权限，以实现您的目标，并不需要添加代理 （即，不需要"代表发送"权限），请参阅[设置文件夹在 Exchange 使用 EWS 的另一个用户的权限](how-to-set-folder-permissions-for-another-user-by-using-ews-in-exchange.md)。</span><span class="sxs-lookup"><span data-stu-id="d271a-125">If you only need to modify folder permissions to achieve your goal, and do not need to add a delegate (that is, you don't need "send on behalf of" permissions), see [Set folder permissions for another user by using EWS in Exchange](how-to-set-folder-permissions-for-another-user-by-using-ews-in-exchange.md).</span></span> 
  
<span data-ttu-id="d271a-126">请注意，您可以还使用[Outlook](http://office.microsoft.com/en-us/outlook-help/allow-someone-else-to-manage-your-mail-and-calendar-HA102749417.aspx)或[Exchange Server PowerShell (Exchange Management Shell)](https://docs.microsoft.com/zh-cn/powershell/exchange/exchange-server/exchange-management-shell?view=exchange-ps)设置代理访问权限。</span><span class="sxs-lookup"><span data-stu-id="d271a-126">Note that you can also use [Outlook](http://office.microsoft.com/en-us/outlook-help/allow-someone-else-to-manage-your-mail-and-calendar-HA102749417.aspx) or the [Exchange Server PowerShell (Exchange Management Shell)](https://docs.microsoft.com/zh-cn/powershell/exchange/exchange-server/exchange-management-shell?view=exchange-ps) to set up delegate access.</span></span> 
  
## <a name="how-does-delegate-access-work"></a><span data-ttu-id="d271a-127">如何执行委派访问工作？</span><span class="sxs-lookup"><span data-stu-id="d271a-127">How does delegate access work?</span></span>

<span data-ttu-id="d271a-128">代理访问使用户能够访问邮箱所有者的文件夹的部分或全部和代表邮箱所有者操作。</span><span class="sxs-lookup"><span data-stu-id="d271a-128">Delegate access enables users to access some or all of the mailbox owner's folders and act on behalf of the mailbox owner.</span></span> <span data-ttu-id="d271a-129">邮箱所有者可以是用户或资源，如会议室。</span><span class="sxs-lookup"><span data-stu-id="d271a-129">The mailbox owner can be a user, or a resource, like a conference room.</span></span> <span data-ttu-id="d271a-130">例如，前台接待员可授予对会议室的日历文件夹的委派权限以处理预定请求。</span><span class="sxs-lookup"><span data-stu-id="d271a-130">For example, a receptionist can be granted delegate permissions to a conference room's calendar folder, to handle booking requests.</span></span> <span data-ttu-id="d271a-131">您可以使用 EWS 托管 API 或 EWS 允许邮箱所有者或管理员添加代理时，指定哪些代理人可以访问，请然后指定该文件夹的权限的文件夹。</span><span class="sxs-lookup"><span data-stu-id="d271a-131">You can use the EWS Managed API or EWS to enable the mailbox owner or an administrator to add a delegate, specify what folders the delegate can access, and then specify permissions for that folder.</span></span> <span data-ttu-id="d271a-132">代理人可以被授予访问权限的以下文件夹：</span><span class="sxs-lookup"><span data-stu-id="d271a-132">Delegates can be granted access to the following folders:</span></span> 
  
- <span data-ttu-id="d271a-133">日历</span><span class="sxs-lookup"><span data-stu-id="d271a-133">Calendar</span></span>
    
- <span data-ttu-id="d271a-134">任务</span><span class="sxs-lookup"><span data-stu-id="d271a-134">Tasks</span></span>
    
- <span data-ttu-id="d271a-135">Inbox</span><span class="sxs-lookup"><span data-stu-id="d271a-135">Inbox</span></span>
    
- <span data-ttu-id="d271a-136">联系人</span><span class="sxs-lookup"><span data-stu-id="d271a-136">Contacts</span></span>
    
- <span data-ttu-id="d271a-137">笔记</span><span class="sxs-lookup"><span data-stu-id="d271a-137">Notes</span></span>
    
- <span data-ttu-id="d271a-138">日记</span><span class="sxs-lookup"><span data-stu-id="d271a-138">Journal</span></span>
    
<span data-ttu-id="d271a-139">当用户具有代理访问到一个或多个这些文件夹时，他们可以创建、 获取、 更新、 删除、 复制和搜索项目中的文件夹和所有子文件夹，根据文件夹上设置的[权限](#bk_delegateperms)。</span><span class="sxs-lookup"><span data-stu-id="d271a-139">When a user has delegate access to one or more of these folders, they can create, get, update, delete, copy, and search for items in that folder and any child folders, depending on the [permissions](#bk_delegateperms) set on the folder.</span></span> <span data-ttu-id="d271a-140">应用程序中执行这些操作的方式取决于是否需要[显式](#bk_explicit)或[隐式](#bk_implicit)访问。</span><span class="sxs-lookup"><span data-stu-id="d271a-140">The way in which the application performs these actions depends on whether [explicit](#bk_explicit) or [implicit](#bk_implicit) access is required.</span></span> 
  
## <a name="delegate-permissions"></a><span data-ttu-id="d271a-141">委派权限</span><span class="sxs-lookup"><span data-stu-id="d271a-141">Delegate permissions</span></span>
<span data-ttu-id="d271a-142"><a name="bk_delegateperms"> </a></span><span class="sxs-lookup"><span data-stu-id="d271a-142"></span></span>

<span data-ttu-id="d271a-143">当管理员或邮箱所有者代理人添加到邮箱时，他们还可以设置为一个或多个文件夹的权限级别。</span><span class="sxs-lookup"><span data-stu-id="d271a-143">When an administrator or mailbox owner adds a delegate to a mailbox, they can also set the permission level for one or more folders.</span></span> <span data-ttu-id="d271a-144">如果未设置文件夹的权限级别，权限值默认为无。</span><span class="sxs-lookup"><span data-stu-id="d271a-144">If a permission level is not set for a folder, the permission value defaults to None.</span></span> <span data-ttu-id="d271a-145">多个用户可以对文件夹中，具有相同权限级别和用户可以具有不同权限级别的不同的文件夹。</span><span class="sxs-lookup"><span data-stu-id="d271a-145">Multiple users can have the same permission level on a folder, and users can have different permission levels for different folders.</span></span> <span data-ttu-id="d271a-146">如果您正在使用 EWS 托管 API，您将使用[DelegateUser.Permissions](http://msdn.microsoft.com/zh-cn/library/microsoft.exchange.webservices.data.delegateuser.permissions%28v=exchg.80%29.aspx)属性，其中包含每个文件夹[DelegateFolderPermissionLevel](http://msdn.microsoft.com/zh-cn/library/microsoft.exchange.webservices.data.delegatefolderpermissionlevel%28v=exchg.80%29.aspx)枚举值之一，文件夹上设置委派权限。</span><span class="sxs-lookup"><span data-stu-id="d271a-146">If you're using the EWS Managed API, you use the [DelegateUser.Permissions](http://msdn.microsoft.com/zh-cn/library/microsoft.exchange.webservices.data.delegateuser.permissions%28v=exchg.80%29.aspx) property, which contains one of the [DelegateFolderPermissionLevel](http://msdn.microsoft.com/zh-cn/library/microsoft.exchange.webservices.data.delegatefolderpermissionlevel%28v=exchg.80%29.aspx) enumeration values for each folder, to set delegate permissions on folders.</span></span> <span data-ttu-id="d271a-147">如果您正在使用 EWS，使用设置委派权限[DelegatePermissions](http://msdn.microsoft.com/library/292badc7-bab3-4368-9d7c-9a8b7edb279b%28Office.15%29.aspx)元素和[PermissionLevel](http://msdn.microsoft.com/library/87978600-3523-451e-a725-ef092c543e2a%28Office.15%29.aspx)元素来定义权限级别。</span><span class="sxs-lookup"><span data-stu-id="d271a-147">If you're using EWS, you use the [DelegatePermissions](http://msdn.microsoft.com/library/292badc7-bab3-4368-9d7c-9a8b7edb279b%28Office.15%29.aspx) element to set delegate permissions, and the [PermissionLevel](http://msdn.microsoft.com/library/87978600-3523-451e-a725-ef092c543e2a%28Office.15%29.aspx) element to define the permission level.</span></span> 
  
<span data-ttu-id="d271a-148">**表 2。委派权限级别**</span><span class="sxs-lookup"><span data-stu-id="d271a-148">**Table 2. Delegate permission levels**</span></span>

|<span data-ttu-id="d271a-149">**权限级别**</span><span class="sxs-lookup"><span data-stu-id="d271a-149">**Permission level**</span></span>|<span data-ttu-id="d271a-150">**说明**</span><span class="sxs-lookup"><span data-stu-id="d271a-150">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="d271a-151">无</span><span class="sxs-lookup"><span data-stu-id="d271a-151">None</span></span>  <br/> |<span data-ttu-id="d271a-152">这是所有文件夹的默认值。</span><span class="sxs-lookup"><span data-stu-id="d271a-152">This is the default value for all folders.</span></span>  <br/> |
|<span data-ttu-id="d271a-153">作者</span><span class="sxs-lookup"><span data-stu-id="d271a-153">Author</span></span>  <br/> |<span data-ttu-id="d271a-154">代理人可以读取和创建项目，并修改和删除他们创建的项目。</span><span class="sxs-lookup"><span data-stu-id="d271a-154">A delegate can read and create items, and modify and delete items they create.</span></span> <span data-ttu-id="d271a-155">例如，代理人可以直接在邮箱所有者的任务或日历文件夹中创建任务请求和会议请求，然后邮箱所有者的代表发送任何一项。</span><span class="sxs-lookup"><span data-stu-id="d271a-155">For example, a delegate can create task requests and meeting requests directly in the mailbox owner's Task or Calendar folder, and then send either item on the mailbox owner's behalf.</span></span>  <br/> |
|<span data-ttu-id="d271a-156">Editor</span><span class="sxs-lookup"><span data-stu-id="d271a-156">Editor</span></span>  <br/> |<span data-ttu-id="d271a-157">代理人可以执行所有内容作者可以执行操作，并修改和删除邮箱所有者创建的项目。</span><span class="sxs-lookup"><span data-stu-id="d271a-157">A delegate can do everything an Author can do, and also modify and delete the items the mailbox owner created.</span></span>  <br/> |
|<span data-ttu-id="d271a-158">Reviewer</span><span class="sxs-lookup"><span data-stu-id="d271a-158">Reviewer</span></span>  <br/> |<span data-ttu-id="d271a-159">代理人可以阅读项目;例如具有审阅者权限代理人可以读取其他人的收件箱中的邮件。</span><span class="sxs-lookup"><span data-stu-id="d271a-159">A delegate can read items; for example a delegate with Reviewer permission can read messages in another person's Inbox.</span></span>  <br/> |
|<span data-ttu-id="d271a-160">自定义</span><span class="sxs-lookup"><span data-stu-id="d271a-160">Custom</span></span>  <br/> |<span data-ttu-id="d271a-161">邮箱所有者授予权限的组自定义委托。</span><span class="sxs-lookup"><span data-stu-id="d271a-161">The mailbox owner has granted a custom set of permissions to the delegate.</span></span>  <br/> |
   
<span data-ttu-id="d271a-162">[DelgateUser.ViewPrivateItems](http://msdn.microsoft.com/zh-cn/library/microsoft.exchange.webservices.data.delegateuser.viewprivateitems%28v=exchg.80%29.aspx) EWS 托管 API 属性和[ViewPrivateItems](http://msdn.microsoft.com/library/80b949ac-440c-4a01-b428-ebafb5b1b802%28Office.15%29.aspx) EWS 元素是影响邮箱所有者的所有文件夹，包括所有邮件、 联系人、 日历、 任务、 注释和日记文件夹的全局设置。</span><span class="sxs-lookup"><span data-stu-id="d271a-162">The [DelgateUser.ViewPrivateItems](http://msdn.microsoft.com/zh-cn/library/microsoft.exchange.webservices.data.delegateuser.viewprivateitems%28v=exchg.80%29.aspx) EWS Managed API property and the [ViewPrivateItems](http://msdn.microsoft.com/library/80b949ac-440c-4a01-b428-ebafb5b1b802%28Office.15%29.aspx) EWS element is a global setting that affects all the mailbox owner's folders, including all Mail, Contacts, Calendar, Tasks, Notes, and Journal folders.</span></span> <span data-ttu-id="d271a-163">您不能允许访问私有只有一个文件夹中的项目。</span><span class="sxs-lookup"><span data-stu-id="d271a-163">You cannot allow access to private items in only one folder.</span></span> 
  
## <a name="explicit-access"></a><span data-ttu-id="d271a-164">显式访问</span><span class="sxs-lookup"><span data-stu-id="d271a-164">Explicit access</span></span>
<span data-ttu-id="d271a-165"><a name="bk_explicit"> </a></span><span class="sxs-lookup"><span data-stu-id="d271a-165"></span></span>

<span data-ttu-id="d271a-166">只需 put、 显式访问是代理人邮箱所有者的文件夹或项目上执行操作的条目的方式。</span><span class="sxs-lookup"><span data-stu-id="d271a-166">Simply put, explicit access is the entry way for delegates to perform actions on a mailbox owner's folders or items.</span></span> <span data-ttu-id="d271a-167">显式访问权限授予代理人到服务器的请求中包含邮箱所有者的 SMTP 地址以及邮箱所有者的文件夹的已知文件夹名称。</span><span class="sxs-lookup"><span data-stu-id="d271a-167">Explicit access is granted to a delegate when they include the well-known folder name for a mailbox owner's folder along with the mailbox owner's SMTP address in a request to the server.</span></span> <span data-ttu-id="d271a-168">因为代理的请求明确说明方法或操作的上下文是邮箱所有者的邮箱，并不代理邮箱访问显式。</span><span class="sxs-lookup"><span data-stu-id="d271a-168">The access is explicit because the delegate's request explicitly states that the context for the method or operation is the mailbox owner's mailbox, and not the delegate's mailbox.</span></span>
  
<span data-ttu-id="d271a-169">显式访问定义的所有方法或文件夹或项目向前移动执行的操作的上下文。</span><span class="sxs-lookup"><span data-stu-id="d271a-169">Explicit access defines the context for all methods or operations performed on the folders or items moving forward.</span></span> <span data-ttu-id="d271a-170">唯一设置显式访问时返回的所有项目和文件夹 Id 都标识自身为属于邮箱所有者 （但不在任何可读格式）。</span><span class="sxs-lookup"><span data-stu-id="d271a-170">All item and folder IDs returned when the explicit access is set uniquely identify themselves as belonging to the mailbox owner (although not in any human readable format).</span></span> <span data-ttu-id="d271a-171">这种方式，应用程序不需要指定邮箱所有者的 SMTP 地址反复;identifiers 中隐藏上下文。</span><span class="sxs-lookup"><span data-stu-id="d271a-171">This way, the application doesn't need to specify the mailbox owner's SMTP address again and again; the context is hidden in the identifiers.</span></span> <span data-ttu-id="d271a-172">标识项目或文件夹后，代理人实际使用[隐式访问](#bk_implicit)修改项。</span><span class="sxs-lookup"><span data-stu-id="d271a-172">After an item or folder is identified, a delegate actually uses [implicit access](#bk_implicit) to modify the item.</span></span> <span data-ttu-id="d271a-173">下图显示显式和隐式访问的过程。</span><span class="sxs-lookup"><span data-stu-id="d271a-173">The following figure shows the process of getting explicit and implicit access.</span></span> 
  
<span data-ttu-id="d271a-174">**图 2。请求显式和隐式访问项目或文件夹**</span><span class="sxs-lookup"><span data-stu-id="d271a-174">**Figure 2. Requesting explicit and implicit access to an item or folder**</span></span>

![显示应用程序发送显式访问请求并从服务器获得响应，然后发送隐式访问请求并从服务器获得响应的图表。](media/Ex15_Delegate_ExplictImplicit.png)
  
<span data-ttu-id="d271a-176">您可以在许多不同的情况下设置显式访问。</span><span class="sxs-lookup"><span data-stu-id="d271a-176">You can set explicit access in many different scenarios.</span></span> <span data-ttu-id="d271a-177">实际上，的随时您发送文件夹 ID 中的方法或操作，您可以设置显式访问。</span><span class="sxs-lookup"><span data-stu-id="d271a-177">Essentially, any time you're sending a folder ID in a method or operation, you can set explicit access.</span></span> <span data-ttu-id="d271a-178">这可以包括查找文件夹，查找约会，获取项目，查找对话，等等。</span><span class="sxs-lookup"><span data-stu-id="d271a-178">This can include finding folders, finding appointments, getting items, finding conversations, and so on.</span></span>
  
### <a name="explicit-access-and-the-ews-managed-api"></a><span data-ttu-id="d271a-179">显式访问和 EWS 托管 API</span><span class="sxs-lookup"><span data-stu-id="d271a-179">Explicit access and the EWS Managed API</span></span>
<span data-ttu-id="d271a-180"><a name="bk_explicitewsma"> </a></span><span class="sxs-lookup"><span data-stu-id="d271a-180"></span></span>

<span data-ttu-id="d271a-181">您可以通过使用下面的重载方法采取[文件夹 Id](http://msdn.microsoft.com/zh-cn/library/microsoft.exchange.webservices.data.folderid%28v=exchg.80%29.aspx)输入的参数标识的目标文件夹的任一发起显式代理访问：</span><span class="sxs-lookup"><span data-stu-id="d271a-181">You can initiate explicit delegate access by using any of the following overloaded methods that take a [FolderId](http://msdn.microsoft.com/zh-cn/library/microsoft.exchange.webservices.data.folderid%28v=exchg.80%29.aspx) input parameter to identify the target folder:</span></span> 
  
- [<span data-ttu-id="d271a-182">Folder.Bind</span><span class="sxs-lookup"><span data-stu-id="d271a-182">Folder.Bind</span></span>](http://msdn.microsoft.com/zh-cn/library/microsoft.exchange.webservices.data.folder.bind%28v=exchg.80%29.aspx)
    
- [<span data-ttu-id="d271a-183">ExchangeService.FindItems</span><span class="sxs-lookup"><span data-stu-id="d271a-183">ExchangeService.FindItems</span></span>](http://msdn.microsoft.com/zh-cn/library/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx)
    
- [<span data-ttu-id="d271a-184">ExchangeService.FindAppointments</span><span class="sxs-lookup"><span data-stu-id="d271a-184">ExchangeService.FindAppointments</span></span>](http://msdn.microsoft.com/zh-cn/library/microsoft.exchange.webservices.data.exchangeservice.findappointments%28v=exchg.80%29.aspx)
    
- [<span data-ttu-id="d271a-185">ExchangeService.FindFolders</span><span class="sxs-lookup"><span data-stu-id="d271a-185">ExchangeService.FindFolders</span></span>](http://msdn.microsoft.com/zh-cn/library/microsoft.exchange.webservices.data.exchangeservice.findfolders%28v=exchg.80%29.aspx)
    
- <span data-ttu-id="d271a-186">更多 ！</span><span class="sxs-lookup"><span data-stu-id="d271a-186">And more!</span></span>
    
<span data-ttu-id="d271a-187">可以在每个这些方法使用**文件夹 Id**参数来标识邮箱所有者的目标文件夹，如下所示。</span><span class="sxs-lookup"><span data-stu-id="d271a-187">You can use the **FolderId** parameter in each of these methods to identify the mailbox owner's target folder, as follows.</span></span> 
  
```cs
new FolderId(WellKnownFolderName.Calendar, "primary@contoso.com");
```

<span data-ttu-id="d271a-188">例如，要绑定到日历文件夹，在此**绑定**方法**文件夹 Id**指定已知文件夹名称和邮箱所有者的 SMTP 地址。</span><span class="sxs-lookup"><span data-stu-id="d271a-188">For example, to bind to the Calendar folder, the **FolderId** in this **Bind** method specifies the well-known folder name, and the mailbox owner's SMTP address.</span></span> 
  
```cs
CalendarFolder calendar = CalendarFolder.Bind(service, new FolderId(WellKnownFolderName.Calendar, "primary@contoso.com"), new PropertySet());
```

<span data-ttu-id="d271a-189">通过指定的已知文件夹名称和 SMTP 地址，代理人可以绑定到邮箱所有者的日历文件夹，从而获得对文件夹显式访问权限。</span><span class="sxs-lookup"><span data-stu-id="d271a-189">By specifying the well-known folder name and the SMTP address, the delegate can bind to the mailbox owner's Calendar folder — thereby gaining explicit access to the folder.</span></span> <span data-ttu-id="d271a-190">[隐式访问](#bk_implicit)文件夹中的项目的所有后续请求然后依赖于的上下文 Id 和文件夹 Id 返回在项目中。</span><span class="sxs-lookup"><span data-stu-id="d271a-190">All subsequent requests for [implicit access](#bk_implicit) to items in the folder then rely on the context returned in the item IDs and folder IDs.</span></span> <span data-ttu-id="d271a-191">实际上，标识符包含暗示的委派访问呼叫的上下文。</span><span class="sxs-lookup"><span data-stu-id="d271a-191">Essentially, the identifiers contain the context for the implied delegate access calls.</span></span> <span data-ttu-id="d271a-192">或者，若要检索满足特定条件的项目的项 ID，请使用以下。</span><span class="sxs-lookup"><span data-stu-id="d271a-192">Or, to retrieve the item ID of an item that meets specific criteria, use the following.</span></span> 
  
```cs
FindItemsResults<Item> results = service.FindItems(new FolderId(WellKnownFolderName.Calendar, "primary@contoso.com"), filter, view);
```

<span data-ttu-id="d271a-193">在这种情况下返回的项 ID，然后委托然后可以使用隐式访问对项目进行更改，使用项目 id。</span><span class="sxs-lookup"><span data-stu-id="d271a-193">In this case the item ID is returned, and then the delegate can then use implicit access to make changes to the item by using the item ID.</span></span>
  
<span data-ttu-id="d271a-194">您不必再次启动显式访问，直到您需要项目 ID 或未访问通过现有的显式访问文件夹 ID。</span><span class="sxs-lookup"><span data-stu-id="d271a-194">You don't have to initiate explicit access again until you require an item ID or a folder ID that you didn't access via the existing explicit access.</span></span> 
  
### <a name="explicit-access-and-ews"></a><span data-ttu-id="d271a-195">显式访问和 EWS</span><span class="sxs-lookup"><span data-stu-id="d271a-195">Explicit access and EWS</span></span>
<span data-ttu-id="d271a-196"><a name="bk_explicitewsma"> </a></span><span class="sxs-lookup"><span data-stu-id="d271a-196"></span></span>

<span data-ttu-id="d271a-197">您可以通过使用[GetFolder](http://msdn.microsoft.com/library/355bcf93-dc71-4493-b177-622afac5fdb9%28Office.15%29.aspx)、 [FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx)或[FindFolder](http://msdn.microsoft.com/library/7a9855aa-06cc-45ba-ad2a-645c15b7d031%28Office.15%29.aspx)操作启动显式访问。</span><span class="sxs-lookup"><span data-stu-id="d271a-197">You can initiate explicit access by using the [GetFolder](http://msdn.microsoft.com/library/355bcf93-dc71-4493-b177-622afac5fdb9%28Office.15%29.aspx), [FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx), or [FindFolder](http://msdn.microsoft.com/library/7a9855aa-06cc-45ba-ad2a-645c15b7d031%28Office.15%29.aspx) operations.</span></span> <span data-ttu-id="d271a-198">这些操作提供[DistinguishedFolderId](http://msdn.microsoft.com/library/50018162-2941-4227-8a5b-d6b4686bb32f%28Office.15%29.aspx)元素用于标识目标文件夹的选项。</span><span class="sxs-lookup"><span data-stu-id="d271a-198">These operations provide the option to use the [DistinguishedFolderId](http://msdn.microsoft.com/library/50018162-2941-4227-8a5b-d6b4686bb32f%28Office.15%29.aspx) element to identify the target folder.</span></span> <span data-ttu-id="d271a-199">**DistinguishedFolderId**元素都有一个可选子元素，[邮箱](http://msdn.microsoft.com/library/befc70fd-51cb-4258-884c-80c9050f0e82%28Office.15%29.aspx)元素。</span><span class="sxs-lookup"><span data-stu-id="d271a-199">The **DistinguishedFolderId** element has a single optional child element, the [Mailbox](http://msdn.microsoft.com/library/befc70fd-51cb-4258-884c-80c9050f0e82%28Office.15%29.aspx) element.</span></span> <span data-ttu-id="d271a-200">**邮箱**元素，用作**DistinguishedFolderId**元素的子时指定的代理访问的邮箱。</span><span class="sxs-lookup"><span data-stu-id="d271a-200">The **Mailbox** element, when used as a child of the **DistinguishedFolderId** element, specifies the mailbox for the delegate to access.</span></span> <span data-ttu-id="d271a-201">如果呼叫用户有权访问邮箱所有者的文件夹，响应将包含对该邮箱中的文件夹或项目的标识符的集合。</span><span class="sxs-lookup"><span data-stu-id="d271a-201">If the calling user has permission to access the mailbox owner's folder, the response will contain a collection of identifiers to items or folders in that mailbox.</span></span> <span data-ttu-id="d271a-202">响应中返回的项和文件夹标识符可用于隐式代理访问。</span><span class="sxs-lookup"><span data-stu-id="d271a-202">The item and folder identifiers that are returned in the response can be used for implicit delegate access.</span></span> 
  
## <a name="implicit-access"></a><span data-ttu-id="d271a-203">隐式访问</span><span class="sxs-lookup"><span data-stu-id="d271a-203">Implicit access</span></span>
<span data-ttu-id="d271a-204"><a name="bk_implicit"> </a></span><span class="sxs-lookup"><span data-stu-id="d271a-204"></span></span>

<span data-ttu-id="d271a-205">代理人已检索到一个项目或邮箱所有者的邮箱文件夹中的 ID 和委托想要更新、 删除或复制项后，将使用隐式访问权限。</span><span class="sxs-lookup"><span data-stu-id="d271a-205">Implicit access is used after a delegate has retrieved the ID for an item or folder in the mailbox owner's mailbox and the delegate wants to update, delete, or copy the item.</span></span> <span data-ttu-id="d271a-206">如果代理请求中使用该项目或文件夹的 ID，对邮箱所有者的邮箱中的项目进行更改。</span><span class="sxs-lookup"><span data-stu-id="d271a-206">When the delegate uses that item or folder ID in a request, the changes are made to the item in the mailbox owner's mailbox.</span></span> <span data-ttu-id="d271a-207">该委托不需要包含邮箱所有者的 SMTP 地址。</span><span class="sxs-lookup"><span data-stu-id="d271a-207">The delegate does not have to include the mailbox owner's SMTP address.</span></span> 
  
<span data-ttu-id="d271a-208">例如，当代理人具有一个邮箱所有者的文件夹的 ID，代理可以通过使用文件夹 ID，而显式标识邮箱所有者的邮箱执行该文件夹**FindItem**操作。</span><span class="sxs-lookup"><span data-stu-id="d271a-208">For example, when a delegate has the ID of one of the mailbox owner's folders, the delegate can perform a **FindItem** operation on that folder by using the folder ID, without explicitly identifying the mailbox owner's mailbox.</span></span> <span data-ttu-id="d271a-209">此时，代理人可以执行操作邮箱所有者的文件夹使用在响应中返回的 Id。</span><span class="sxs-lookup"><span data-stu-id="d271a-209">At that point, the delegate can perform actions on the mailbox owner's folder by using the IDs that are returned in the responses.</span></span> 
  
### <a name="implicit-access-and-the-ews-managed-api"></a><span data-ttu-id="d271a-210">隐式访问和 EWS 托管 API</span><span class="sxs-lookup"><span data-stu-id="d271a-210">Implicit access and the EWS Managed API</span></span>

<span data-ttu-id="d271a-211">如果项目 ID 检索到[FindItems](http://msdn.microsoft.com/zh-cn/library/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx)方法，该项目 ID 可用于在后续[Item.Bind](http://msdn.microsoft.com/zh-cn/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx)方法调用绑定到项。</span><span class="sxs-lookup"><span data-stu-id="d271a-211">If an item ID was retrieved by the [FindItems](http://msdn.microsoft.com/zh-cn/library/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx) method, that item ID can be used in a subsequent [Item.Bind](http://msdn.microsoft.com/zh-cn/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) method call to bind to the item.</span></span> <span data-ttu-id="d271a-212">然后，您可以调用[Item.Update](http://msdn.microsoft.com/zh-cn/library/office/microsoft.exchange.webservices.data.item.update%28v=exchg.80%29.aspx)、 [Item.Delete](http://msdn.microsoft.com/zh-cn/library/office/microsoft.exchange.webservices.data.item.delete%28v=exchg.80%29.aspx)或[Item.Copy](http://msdn.microsoft.com/zh-cn/library/office/microsoft.exchange.webservices.data.item.copy%28v=exchg.80%29.aspx)方法 — 或需要项目 ID 的任何方法调用 — 根据需要完成您的任务。</span><span class="sxs-lookup"><span data-stu-id="d271a-212">You can then call the [Item.Update](http://msdn.microsoft.com/zh-cn/library/office/microsoft.exchange.webservices.data.item.update%28v=exchg.80%29.aspx), [Item.Delete](http://msdn.microsoft.com/zh-cn/library/office/microsoft.exchange.webservices.data.item.delete%28v=exchg.80%29.aspx), or [Item.Copy](http://msdn.microsoft.com/zh-cn/library/office/microsoft.exchange.webservices.data.item.copy%28v=exchg.80%29.aspx) method — or any method call that requires an item ID — as needed to complete your task.</span></span> <span data-ttu-id="d271a-213">只要委派到的文件夹包含的项目具有适当的权限 （和，如果适用，文件夹项目将移至），代理人可以根据其权限级别进行更改。</span><span class="sxs-lookup"><span data-stu-id="d271a-213">As long as the delegate has appropriate permissions to the folder that contains the item (and, if applicable, the folder the item is moving to), the delegate can make changes according to their permission levels.</span></span> 
  
### <a name="implicit-access-and-ews"></a><span data-ttu-id="d271a-214">隐式访问和 EWS</span><span class="sxs-lookup"><span data-stu-id="d271a-214">Implicit access and EWS</span></span>

<span data-ttu-id="d271a-215">如果项目 ID 检索到[FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx)操作，该项目 ID 可用于在后续[GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx)操作中绑定到项。</span><span class="sxs-lookup"><span data-stu-id="d271a-215">If an item ID was retrieved by the [FindItem](http://msdn.microsoft.com/library/ebad6aae-16e7-44de-ae63-a95b24539729%28Office.15%29.aspx) operation, that item ID can be used in subsequent [GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) operations to bind to the item.</span></span> <span data-ttu-id="d271a-216">然后，您可以调用[UpdateItem](http://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx)、[删除项](http://msdn.microsoft.com/library/3e26c416-fa12-476e-bfd2-5c1f4bb7b348%28Office.15%29.aspx)或[CopyItem](http://msdn.microsoft.com/library/bcc68f9e-d511-4c29-bba6-ed535524624a%28Office.15%29.aspx)操作 — 或需要项目 ID 的任何操作，根据需要完成您的任务。</span><span class="sxs-lookup"><span data-stu-id="d271a-216">You can then call the [UpdateItem](http://msdn.microsoft.com/library/5d027523-e0bc-4da2-b60b-0cb9fc1fdfe4%28Office.15%29.aspx), [DeleteItem](http://msdn.microsoft.com/library/3e26c416-fa12-476e-bfd2-5c1f4bb7b348%28Office.15%29.aspx), or [CopyItem](http://msdn.microsoft.com/library/bcc68f9e-d511-4c29-bba6-ed535524624a%28Office.15%29.aspx) operation — or any operation that requires an item ID — as needed to complete your task.</span></span> <span data-ttu-id="d271a-217">只要委派到的文件夹包含的项目具有适当的权限 （和，如果适用，文件夹项目将移至），代理人可以根据其权限级别进行更改。</span><span class="sxs-lookup"><span data-stu-id="d271a-217">As long as the delegate has appropriate permissions to the folder that contains the item (and, if applicable, the folder the item is moving to), the delegate can make changes according to their permission levels.</span></span> 
  
## <a name="in-this-section"></a><span data-ttu-id="d271a-218">本节内容</span><span class="sxs-lookup"><span data-stu-id="d271a-218">In this section</span></span>
<span data-ttu-id="d271a-219"><a name="bk_implicit"> </a></span><span class="sxs-lookup"><span data-stu-id="d271a-219"></span></span>

- [<span data-ttu-id="d271a-220">添加和删除代理人，在 Exchange 使用 EWS</span><span class="sxs-lookup"><span data-stu-id="d271a-220">Add and remove delegates by using EWS in Exchange</span></span>](how-to-add-and-remove-delegates-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="d271a-221">在 Exchange 中使用 EWS 作为代理人访问日历</span><span class="sxs-lookup"><span data-stu-id="d271a-221">Access a calendar as a delegate by using EWS in Exchange</span></span>](how-to-access-a-calendar-as-a-delegate-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="d271a-222">作为代理人在 Exchange 使用 EWS 访问联系人</span><span class="sxs-lookup"><span data-stu-id="d271a-222">Access contacts as a delegate by using EWS in Exchange</span></span>](how-to-access-contacts-as-a-delegate-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="d271a-223">作为 Exchange 中使用 EWS 代理人的访问电子邮件</span><span class="sxs-lookup"><span data-stu-id="d271a-223">Access email as a delegate by using EWS in Exchange</span></span>](how-to-access-email-as-a-delegate-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="d271a-224">在 Exchange 使用 EWS 设置另一个用户的文件夹权限</span><span class="sxs-lookup"><span data-stu-id="d271a-224">Set folder permissions for another user by using EWS in Exchange</span></span>](how-to-set-folder-permissions-for-another-user-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="d271a-225">在 Exchange 处理委派相关 EWS 中的错误</span><span class="sxs-lookup"><span data-stu-id="d271a-225">Handling delegation-related errors in EWS in Exchange</span></span>](handling-delegation-related-errors-in-ews-in-exchange.md)
    
## <a name="see-also"></a><span data-ttu-id="d271a-226">另请参阅</span><span class="sxs-lookup"><span data-stu-id="d271a-226">See also</span></span>


- [<span data-ttu-id="d271a-227">开发 Exchange Web 服务客户端</span><span class="sxs-lookup"><span data-stu-id="d271a-227">Develop web service clients for Exchange</span></span>](develop-web-service-clients-for-exchange.md)
    
- [<span data-ttu-id="d271a-228">允许其他人来管理您的邮件和日历</span><span class="sxs-lookup"><span data-stu-id="d271a-228">Allow someone else to manage your mail and calendar</span></span>](http://office.microsoft.com/en-us/outlook-help/allow-someone-else-to-manage-your-mail-and-calendar-HA102749417.aspx)
    
- [<span data-ttu-id="d271a-229">添加 MailboxPermission</span><span class="sxs-lookup"><span data-stu-id="d271a-229">Add- MailboxPermission</span></span>](http://technet.microsoft.com/zh-cn/library/bb124097%28v=exchg.150%29.aspx)
    

