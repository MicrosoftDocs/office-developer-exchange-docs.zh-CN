---
title: Exchange 2013 的备份和还原概念
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: 9a1c4709-9313-4ccf-9f8a-673a51d51f23
description: 查找可帮助您为 Exchange 2013 创建备份和还原应用程序的 Exchange 数据库的相关信息。
ms.openlocfilehash: fd35699839af105dd3fe285776b071c1d03d58dd
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/03/2020
ms.locfileid: "44437982"
---
# <a name="backup-and-restore-concepts-for-exchange-2013"></a><span data-ttu-id="2a8fe-103">Exchange 2013 的备份和还原概念</span><span class="sxs-lookup"><span data-stu-id="2a8fe-103">Backup and restore concepts for Exchange 2013</span></span>

<span data-ttu-id="2a8fe-104">查找可帮助您为 Exchange 2013 创建备份和还原应用程序的 Exchange 数据库的相关信息。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-104">Find information about Exchange databases that will help you create your backup and restore applications for Exchange 2013.</span></span>
  
<span data-ttu-id="2a8fe-105">在为 Exchange Server 2013 创建备份和还原应用程序之前，您应熟悉 Exchange 数据库文件结构。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-105">Before you create backup and restore applications for Exchange Server 2013, you should be familiar with the Exchange database file structure.</span></span> <span data-ttu-id="2a8fe-106">通过使用 Exchange 存储数据库文件，可以备份存储中的数据，并在以后需要时将其还原。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-106">By using the Exchange store database files, you can back up the data in your store and restore it at a later time as needed.</span></span> <span data-ttu-id="2a8fe-107">如果您的磁盘空间有限，管理员可能会实施循环日志记录，这将影响您备份数据库的能力。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-107">If you are limited on disk space, your administrator might implement circular logging, and this will affect your ability to back up the database.</span></span> <span data-ttu-id="2a8fe-108">您还可以利用 Exchange 2013 中的数据库移动功能来备份和还原 Exchange 数据。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-108">You can also take advantage of the database mobility feature in Exchange 2013 to back up and restore Exchange data.</span></span> <span data-ttu-id="2a8fe-109">与备份和还原应用程序结合使用的数据库移动性是用于灾难恢复的冗余的最佳度量。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-109">Database mobility, in combination with your backup and restore application, is a good measure of redundancy for disaster recovery.</span></span>

<span data-ttu-id="2a8fe-110"><a name="bk_exchangedatabases"> </a></span><span class="sxs-lookup"><span data-stu-id="2a8fe-110"><a name="bk_exchangedatabases"> </a></span></span>

## <a name="exchange-store-database-files"></a><span data-ttu-id="2a8fe-111">Exchange 存储数据库文件</span><span class="sxs-lookup"><span data-stu-id="2a8fe-111">Exchange store database files</span></span>

<span data-ttu-id="2a8fe-112">Exchange 2013 包括最高为100个数据库的支持。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-112">Exchange 2013 includes support for up to 100 databases.</span></span> <span data-ttu-id="2a8fe-113">每个 Exchange 2013 数据库都包含下表中列出的文件。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-113">Each Exchange 2013 database contains the files listed in the following table.</span></span> 
  
<span data-ttu-id="2a8fe-114">**表1。Exchange 2013 数据库文件**</span><span class="sxs-lookup"><span data-stu-id="2a8fe-114">**Table 1. Exchange 2013 database files**</span></span>

|<span data-ttu-id="2a8fe-115">文件类型</span><span class="sxs-lookup"><span data-stu-id="2a8fe-115">File type</span></span>|<span data-ttu-id="2a8fe-116">扩展名</span><span class="sxs-lookup"><span data-stu-id="2a8fe-116">Extension</span></span>|<span data-ttu-id="2a8fe-117">Description</span><span class="sxs-lookup"><span data-stu-id="2a8fe-117">Description</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="2a8fe-118">数据库文件</span><span class="sxs-lookup"><span data-stu-id="2a8fe-118">Database file</span></span>  <br/> |<span data-ttu-id="2a8fe-119">\*.edb</span><span class="sxs-lookup"><span data-stu-id="2a8fe-119">\*.edb</span></span>  <br/> |<span data-ttu-id="2a8fe-120">记录已提交到内存中数据库的所有更改。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-120">Records all the changes that have been committed to the in-memory database.</span></span>  <br/> |
|<span data-ttu-id="2a8fe-121">事务日志流</span><span class="sxs-lookup"><span data-stu-id="2a8fe-121">Transaction log stream</span></span>  <br/> |<span data-ttu-id="2a8fe-122">\*.log</span><span class="sxs-lookup"><span data-stu-id="2a8fe-122">\*.log</span></span>  <br/> |<span data-ttu-id="2a8fe-123">记录将提交到数据库的操作，例如创建或修改邮件。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-123">Records operations, such as the creation or modification of a message, that will be committed to the database.</span></span> <span data-ttu-id="2a8fe-124">限制为每个大小的 1 MB。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-124">Limited in size to 1 MB each.</span></span>  <br/> |
|<span data-ttu-id="2a8fe-125">检查点文件</span><span class="sxs-lookup"><span data-stu-id="2a8fe-125">Checkpoint file</span></span>  <br/> |<span data-ttu-id="2a8fe-126">\*.chk</span><span class="sxs-lookup"><span data-stu-id="2a8fe-126">\*.chk</span></span>  <br/> |<span data-ttu-id="2a8fe-127">记录记录的事务已写入磁盘上的数据库文件。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-127">Records which logged transactions have been written to the on-disk database files.</span></span>  <br/> |
   
<span data-ttu-id="2a8fe-128">Exchange 2013 维护每个数据库的一组事务日志文件。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-128">Exchange 2013 maintains a single set of transaction log files for each database.</span></span> <span data-ttu-id="2a8fe-129">事务日志对于备份和恢复操作非常重要。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-129">The transaction logs are important for backup and recovery operations.</span></span> <span data-ttu-id="2a8fe-130">创建使用卷影复制服务（VSS）的备份和还原应用程序时，必须确保正确处理这些日志。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-130">When you create a backup and restore application that uses the Volume Shadow Copy Service (VSS), you must ensure that you handle these logs correctly.</span></span> <span data-ttu-id="2a8fe-131">有关详细信息，请参阅[Exchange 2013 中的备份和还原的事务日志和检查点文件](transaction-logs-and-checkpoint-files-for-backup-and-restore-in-exchange.md)。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-131">For more information, see [Transaction logs and checkpoint files for backup and restore in Exchange 2013](transaction-logs-and-checkpoint-files-for-backup-and-restore-in-exchange.md).</span></span> <span data-ttu-id="2a8fe-132">若要备份数据库及其日志流，必须备份包含数据库和日志的整个卷。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-132">To back up a database and its log stream, you must back up the entire volume that contains the database and logs.</span></span> <span data-ttu-id="2a8fe-133">仅在成功完成包含 Exchange 数据库的卷或文件夹的完整备份之后，才会发生日志截断。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-133">Log truncation will occur only after a successful completion of a full backup of a volume or folders that contain an Exchange database.</span></span>
  
<span data-ttu-id="2a8fe-134">在每个 Exchange 服务器上，一次只能装入一个恢复数据库。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-134">On each Exchange server, you can mount only one recovery database at a time.</span></span> <span data-ttu-id="2a8fe-135">您可以使用 Exchange 命令行管理程序 cmdlet （如**new-mailboxrestorerequest**）访问恢复数据库。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-135">You can access the recovery database by using Exchange Management Shell cmdlets such as **New-MailboxRestoreRequest**.</span></span> <span data-ttu-id="2a8fe-136">有关 Exchange 恢复数据库的详细信息，请参阅 TechNet 上的[恢复数据库](https://technet.microsoft.com/library/dd876954%28v=exchg.150%29.aspx)。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-136">For more information about Exchange recovery databases, see [Recovery Databases](https://technet.microsoft.com/library/dd876954%28v=exchg.150%29.aspx) on TechNet.</span></span> <span data-ttu-id="2a8fe-137">有关 Exchange 命令行管理程序 cmdlet 的详细信息，请参阅 TechNet 上的[exchange 2013 cmdlet](https://technet.microsoft.com/library/bb124413.aspx) 。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-137">For more information about Exchange Management Shell cmdlets, see [Exchange 2013 Cmdlets](https://technet.microsoft.com/library/bb124413.aspx) on TechNet.</span></span> 
  
## <a name="circular-logging"></a><span data-ttu-id="2a8fe-138">循环日志记录</span><span class="sxs-lookup"><span data-stu-id="2a8fe-138">Circular logging</span></span>
<span data-ttu-id="2a8fe-139"><a name="bk_circularlogging"> </a></span><span class="sxs-lookup"><span data-stu-id="2a8fe-139"><a name="bk_circularlogging"> </a></span></span>

<span data-ttu-id="2a8fe-140">如果存储容量是一个问题，则管理员可能会启用循环日志记录。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-140">If storage capacity is an issue, your administrator might enable circular logging.</span></span> <span data-ttu-id="2a8fe-141">启用循环日志记录时，Exchange 会照常写入事务日志，但如果检查点文件是高级的，事务日志的非活动部分将被截断。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-141">When circular logging is enabled, Exchange writes transaction logs as usual, but when a checkpoint file is advanced, the inactive portion of the transaction log is truncated.</span></span> <span data-ttu-id="2a8fe-142">如果您还计划使用 VSS 启用您的自定义备份和还原操作，则管理员不应将 Exchange 2013 数据库配置为使用循环日志记录。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-142">Your administrator should not configure Exchange 2013 databases to use circular logging if you also plan to use VSS to enable your custom backup and restore operations.</span></span> <span data-ttu-id="2a8fe-143">循环日志记录将创建以下限制：</span><span class="sxs-lookup"><span data-stu-id="2a8fe-143">Circular logging creates the following restrictions:</span></span> 
  
- <span data-ttu-id="2a8fe-144">如果在备份操作或恢复操作过程中启用此功能，则无法还原单个数据库。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-144">If enabled during the backup operation or the recovery operation, you cannot restore individual databases.</span></span>
    
- <span data-ttu-id="2a8fe-145">仅可以执行时间点恢复操作。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-145">Only point-in-time recovery operations are possible.</span></span> <span data-ttu-id="2a8fe-146">启用循环日志记录时，您可以在还原数据库时删除同一目录中的事务日志，尽管这些日志可能是不同 Exchange 2013 数据库的一部分。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-146">When circular logging is enabled, you can delete transaction logs in the same directory when a database is restored, although those logs might be part of a different Exchange 2013 database.</span></span> 
    
- <span data-ttu-id="2a8fe-147">您不能执行增量或差异备份操作。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-147">You cannot perform incremental or differential backup operations.</span></span> <span data-ttu-id="2a8fe-148">有关这些类型的备份的详细信息，请参阅[Exchange 2013 的备份操作类型](types-of-backup-operations-for-exchange-2013.md)。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-148">For more information about these types of backups, see [Types of backup operations for Exchange 2013](types-of-backup-operations-for-exchange-2013.md).</span></span>
    
<span data-ttu-id="2a8fe-149">如果启用了循环日志记录，则管理员应尽快禁用它，以确保 VSS 备份不会失败。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-149">If circular logging is enables, your administrator should disable it as soon as possible to ensure that your VSS backups don't fail.</span></span> <span data-ttu-id="2a8fe-150">有关详细信息，请查看博客文章[Exchange 循环日志记录和 VSS 备份](https://blogs.technet.com/b/exchange/archive/2010/08/18/3410672.aspx)。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-150">For more information, check out the blog post [Exchange Circular Logging and VSS Backups](https://blogs.technet.com/b/exchange/archive/2010/08/18/3410672.aspx).</span></span> 
  
## <a name="exchange-database-mobility"></a><span data-ttu-id="2a8fe-151">Exchange 数据库移动性</span><span class="sxs-lookup"><span data-stu-id="2a8fe-151">Exchange database mobility</span></span>
<span data-ttu-id="2a8fe-152"><a name="bk_exchangedatabasemobility"> </a></span><span class="sxs-lookup"><span data-stu-id="2a8fe-152"><a name="bk_exchangedatabasemobility"> </a></span></span>

<span data-ttu-id="2a8fe-153">Exchange 2013 允许数据库移动性提高邮箱的可靠性和可用性。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-153">Exchange 2013 allows for database mobility to improve mailbox reliability and availability.</span></span> <span data-ttu-id="2a8fe-154">利用数据库移动功能，您可以制作 Exchange 存储数据库的副本，断开数据库与服务器的连接，并将其存储在另一台服务器上。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-154">Database mobility enables you to make copies of your Exchange store database, disconnect the database from the server, and store it on another server.</span></span> <span data-ttu-id="2a8fe-155">在 Exchange 2013 数据库可用性组（DAG）中，数据库的多个副本存储在不同的计算机上。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-155">In an Exchange 2013 Database Availability Group (DAG), multiple copies of the database are stored on different computers.</span></span> <span data-ttu-id="2a8fe-156">当由于硬件或其他系统故障而丢失数据库的一个或多个副本时，可使用来自其他副本的信息通过正常的复制操作对数据库进行种子设定。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-156">When one or more copies of the database are lost due to hardware or other system failure, information from the other copies can be used to reseed the database via normal replication operations.</span></span>
  
<span data-ttu-id="2a8fe-157">对于备份操作，如果要备份的 Exchange 2013 数据库是在 DAG 中配置的，则备份应用程序可以通过在其中一个非活动数据库副本上拍摄快照来更好地阻止快照和活动服务器的性能之间的干扰。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-157">For backup operations, if the Exchange 2013 databases that are to be backed up are configured in a DAG, the backup application can better prevent interference between the snapshot and the active server's performance by taking the snapshot on one of the inactive database copies.</span></span> <span data-ttu-id="2a8fe-158">由于数据库副本的大部分同步，因此备份应用程序可以从数据库的不同副本获取快照，稍后再从这些部分重建快照。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-158">Because the database copies are for the most part synchronized, the backup application can take snapshots from different copies of the database, and later reconstruct it from the pieces.</span></span>
  
<span data-ttu-id="2a8fe-159">从备份数据中还原 DAG 数据库的唯一受支持方法是使用相同的备份数据还原数据库的所有副本。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-159">The only supported method of restoring DAG databases from backup data is to restore all copies of the database by using the same backup data.</span></span> <span data-ttu-id="2a8fe-160">由于副本之间的数据库日志文件可能稍有不同，因此使用不同数据还原单个数据库副本可能会导致数据库变得无法装入。</span><span class="sxs-lookup"><span data-stu-id="2a8fe-160">Because the database log files might be slightly different between the copies, restoring individual database copies using different data can cause the database to become unmountable.</span></span>
  
## <a name="in-this-section"></a><span data-ttu-id="2a8fe-161">本节内容</span><span class="sxs-lookup"><span data-stu-id="2a8fe-161">In this section</span></span>
<span data-ttu-id="2a8fe-162"><a name="bk_inthissection"> </a></span><span class="sxs-lookup"><span data-stu-id="2a8fe-162"><a name="bk_inthissection"> </a></span></span>

- [<span data-ttu-id="2a8fe-163">Exchange 2013 中用于备份和还原的事务日志和检查点文件</span><span class="sxs-lookup"><span data-stu-id="2a8fe-163">Transaction logs and checkpoint files for backup and restore in Exchange 2013</span></span>](transaction-logs-and-checkpoint-files-for-backup-and-restore-in-exchange.md)
    
- [<span data-ttu-id="2a8fe-164">Exchange 2013 中的 exchange 编写器</span><span class="sxs-lookup"><span data-stu-id="2a8fe-164">Exchange writer in Exchange 2013</span></span>](exchange-writer-in-exchange-2013.md)
    
## <a name="see-also"></a><span data-ttu-id="2a8fe-165">另请参阅</span><span class="sxs-lookup"><span data-stu-id="2a8fe-165">See also</span></span>

- [<span data-ttu-id="2a8fe-166">Exchange Online 和 Exchange 开发</span><span class="sxs-lookup"><span data-stu-id="2a8fe-166">Exchange Online and Exchange development</span></span>](../exchange-server-development.md) 
- [<span data-ttu-id="2a8fe-167">Exchange 2013 的备份操作类型</span><span class="sxs-lookup"><span data-stu-id="2a8fe-167">Types of backup operations for Exchange 2013</span></span>](types-of-backup-operations-for-exchange-2013.md)
- [<span data-ttu-id="2a8fe-168">还原 Exchange 2013 数据库</span><span class="sxs-lookup"><span data-stu-id="2a8fe-168">Restoring Exchange 2013 databases</span></span>](restoring-exchange-2013-databases.md)
    

