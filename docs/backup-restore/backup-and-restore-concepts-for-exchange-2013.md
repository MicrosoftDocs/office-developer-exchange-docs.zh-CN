---
title: Exchange 2013 的备份和还原概念
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: 9a1c4709-9313-4ccf-9f8a-673a51d51f23
description: 查找有关 Exchange 数据库将帮助您创建备份和还原 Exchange 2013 的应用程序的信息。
ms.openlocfilehash: 5fa62c3d34ffbe8f0bab852c6d41c49220e2883a
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/25/2018
ms.locfileid: "19752693"
---
# <a name="backup-and-restore-concepts-for-exchange-2013"></a><span data-ttu-id="14972-103">Exchange 2013 的备份和还原概念</span><span class="sxs-lookup"><span data-stu-id="14972-103">Backup and restore concepts for Exchange 2013</span></span>

<span data-ttu-id="14972-104">查找有关 Exchange 数据库将帮助您创建备份和还原 Exchange 2013 的应用程序的信息。</span><span class="sxs-lookup"><span data-stu-id="14972-104">Find information about Exchange databases that will help you create your backup and restore applications for Exchange 2013.</span></span>
  
<span data-ttu-id="14972-105">创建备份和还原 Exchange Server 2013 的应用程序之前，您应熟悉的 Exchange 数据库文件结构。</span><span class="sxs-lookup"><span data-stu-id="14972-105">Before you create backup and restore applications for Exchange Server 2013, you should be familiar with the Exchange database file structure.</span></span> <span data-ttu-id="14972-106">通过使用 Exchange 存储数据库文件，可以在存储备份数据，并在以后根据需要对其进行还原。</span><span class="sxs-lookup"><span data-stu-id="14972-106">By using the Exchange store database files, you can back up the data in your store and restore it at a later time as needed.</span></span> <span data-ttu-id="14972-107">如果您受到磁盘空间，管理员可能实现循环日志记录，并这会影响您如何能够备份数据库。</span><span class="sxs-lookup"><span data-stu-id="14972-107">If you are limited on disk space, your administrator might implement circular logging, and this will affect your ability to back up the database.</span></span> <span data-ttu-id="14972-108">您还可以在 Exchange 2013 能够备份和还原 Exchange 数据充分利用数据库移动功能。</span><span class="sxs-lookup"><span data-stu-id="14972-108">You can also take advantage of the database mobility feature in Exchange 2013 to back up and restore Exchange data.</span></span> <span data-ttu-id="14972-109">良好的灾难恢复的冗余措施数据库移动，与备份和还原应用程序结合使用。</span><span class="sxs-lookup"><span data-stu-id="14972-109">Database mobility, in combination with your backup and restore application, is a good measure of redundancy for disaster recovery.</span></span>

<span data-ttu-id="14972-110"><a name="bk_exchangedatabases"> </a></span><span class="sxs-lookup"><span data-stu-id="14972-110"></span></span>

## <a name="exchange-store-database-files"></a><span data-ttu-id="14972-111">Exchange 存储数据库文件</span><span class="sxs-lookup"><span data-stu-id="14972-111">Exchange store database files</span></span>

<span data-ttu-id="14972-112">Exchange 2013 包括支持最多 100 个数据库。</span><span class="sxs-lookup"><span data-stu-id="14972-112">Exchange 2013 includes support for up to 100 databases.</span></span> <span data-ttu-id="14972-113">每个 Exchange 2013 数据库包含下表中列出的文件。</span><span class="sxs-lookup"><span data-stu-id="14972-113">Each Exchange 2013 database contains the files listed in the following table.</span></span> 
  
<span data-ttu-id="14972-114">**表 1。Exchange 2013 数据库文件**</span><span class="sxs-lookup"><span data-stu-id="14972-114">**Table 1. Exchange 2013 database files**</span></span>

|<span data-ttu-id="14972-115">文件类型</span><span class="sxs-lookup"><span data-stu-id="14972-115">File type</span></span>|<span data-ttu-id="14972-116">扩展名</span><span class="sxs-lookup"><span data-stu-id="14972-116">Extension</span></span>|<span data-ttu-id="14972-117">说明</span><span class="sxs-lookup"><span data-stu-id="14972-117">Description</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="14972-118">数据库文件</span><span class="sxs-lookup"><span data-stu-id="14972-118">Database file</span></span>  <br/> |<span data-ttu-id="14972-119">\*.edb</span><span class="sxs-lookup"><span data-stu-id="14972-119">\*.edb</span></span>  <br/> |<span data-ttu-id="14972-120">记录已提交到内存中数据库的所有更改。</span><span class="sxs-lookup"><span data-stu-id="14972-120">Records all the changes that have been committed to the in-memory database.</span></span>  <br/> |
|<span data-ttu-id="14972-121">事务日志流</span><span class="sxs-lookup"><span data-stu-id="14972-121">Transaction log stream</span></span>  <br/> |<span data-ttu-id="14972-122">\*.log</span><span class="sxs-lookup"><span data-stu-id="14972-122">\*.log</span></span>  <br/> |<span data-ttu-id="14972-123">记录操作，例如创建或修改一条消息，将提交到数据库。</span><span class="sxs-lookup"><span data-stu-id="14972-123">Records operations, such as the creation or modification of a message, that will be committed to the database.</span></span> <span data-ttu-id="14972-124">有限的大小为 1 MB。</span><span class="sxs-lookup"><span data-stu-id="14972-124">Limited in size to 1 MB each.</span></span>  <br/> |
|<span data-ttu-id="14972-125">检查点文件</span><span class="sxs-lookup"><span data-stu-id="14972-125">Checkpoint file</span></span>  <br/> |<span data-ttu-id="14972-126">\*.chk</span><span class="sxs-lookup"><span data-stu-id="14972-126">\*.chk</span></span>  <br/> |<span data-ttu-id="14972-127">具有已记录事务记录写入到磁盘上的数据库文件。</span><span class="sxs-lookup"><span data-stu-id="14972-127">Records which logged transactions have been written to the on-disk database files.</span></span>  <br/> |
   
<span data-ttu-id="14972-128">Exchange 2013 维护一组的每个数据库的事务日志文件。</span><span class="sxs-lookup"><span data-stu-id="14972-128">Exchange 2013 maintains a single set of transaction log files for each database.</span></span> <span data-ttu-id="14972-129">事务日志很重要的备份和恢复操作。</span><span class="sxs-lookup"><span data-stu-id="14972-129">The transaction logs are important for backup and recovery operations.</span></span> <span data-ttu-id="14972-130">当您创建的备份和还原应用程序使用卷影复制服务 (VSS) 时，您必须确保正确处理这些日志。</span><span class="sxs-lookup"><span data-stu-id="14972-130">When you create a backup and restore application that uses the Volume Shadow Copy Service (VSS), you must ensure that you handle these logs correctly.</span></span> <span data-ttu-id="14972-131">有关详细信息，请参阅[事务日志和备份和还原 Exchange 2013 中的检查点文件](transaction-logs-and-checkpoint-files-for-backup-and-restore-in-exchange.md)。</span><span class="sxs-lookup"><span data-stu-id="14972-131">For more information, see [Transaction logs and checkpoint files for backup and restore in Exchange 2013](transaction-logs-and-checkpoint-files-for-backup-and-restore-in-exchange.md).</span></span> <span data-ttu-id="14972-132">若要备份数据库和其日志流，您必须备份整个卷包含数据库和日志。</span><span class="sxs-lookup"><span data-stu-id="14972-132">To back up a database and its log stream, you must back up the entire volume that contains the database and logs.</span></span> <span data-ttu-id="14972-133">量或文件夹，其中包含 Exchange 数据库的完整备份成功完成后才会执行日志截断。</span><span class="sxs-lookup"><span data-stu-id="14972-133">Log truncation will occur only after a successful completion of a full backup of a volume or folders that contain an Exchange database.</span></span>
  
<span data-ttu-id="14972-134">在每个 Exchange 服务器上，您可以一次装载只有一个恢复数据库。</span><span class="sxs-lookup"><span data-stu-id="14972-134">On each Exchange server, you can mount only one recovery database at a time.</span></span> <span data-ttu-id="14972-135">您可以使用 Exchange 命令行管理程序 cmdlet，如**New-mailboxrestorerequest**访问恢复数据库。</span><span class="sxs-lookup"><span data-stu-id="14972-135">You can access the recovery database by using Exchange Management Shell cmdlets such as **New-MailboxRestoreRequest**.</span></span> <span data-ttu-id="14972-136">有关 Exchange 恢复数据库的详细信息，请参阅 TechNet 上的[恢复数据库](http://technet.microsoft.com/en-us/library/dd876954%28v=exchg.150%29.aspx)。</span><span class="sxs-lookup"><span data-stu-id="14972-136">For more information about Exchange recovery databases, see [Recovery Databases](http://technet.microsoft.com/en-us/library/dd876954%28v=exchg.150%29.aspx) on TechNet.</span></span> <span data-ttu-id="14972-137">有关 Exchange 命令行管理程序 cmdlet 的详细信息，请参阅 TechNet 上的[Exchange 2013 Cmdlets](http://technet.microsoft.com/en-us/library/bb124413.aspx) 。</span><span class="sxs-lookup"><span data-stu-id="14972-137">For more information about Exchange Management Shell cmdlets, see [Exchange 2013 Cmdlets](http://technet.microsoft.com/en-us/library/bb124413.aspx) on TechNet.</span></span> 
  
## <a name="circular-logging"></a><span data-ttu-id="14972-138">循环日志记录</span><span class="sxs-lookup"><span data-stu-id="14972-138">Circular logging</span></span>
<span data-ttu-id="14972-139"><a name="bk_circularlogging"> </a></span><span class="sxs-lookup"><span data-stu-id="14972-139"></span></span>

<span data-ttu-id="14972-140">如果存储容量问题，您的管理员可能启用循环日志记录。</span><span class="sxs-lookup"><span data-stu-id="14972-140">If storage capacity is an issue, your administrator might enable circular logging.</span></span> <span data-ttu-id="14972-141">Exchange 启用循环日志记录后，将编写事务日志，像往常一样，但时检查点文件高级，被截断事务日志的非活动部分。</span><span class="sxs-lookup"><span data-stu-id="14972-141">When circular logging is enabled, Exchange writes transaction logs as usual, but when a checkpoint file is advanced, the inactive portion of the transaction log is truncated.</span></span> <span data-ttu-id="14972-142">您的管理员应配置 Exchange 2013 数据库能够使用循环日志记录如果还计划使用 VSS 启用自定义备份和还原操作。</span><span class="sxs-lookup"><span data-stu-id="14972-142">Your administrator should not configure Exchange 2013 databases to use circular logging if you also plan to use VSS to enable your custom backup and restore operations.</span></span> <span data-ttu-id="14972-143">循环日志记录将创建以下限制：</span><span class="sxs-lookup"><span data-stu-id="14972-143">Circular logging creates the following restrictions:</span></span> 
  
- <span data-ttu-id="14972-144">如果启用在备份或恢复操作过程，您无法还原的各个数据库。</span><span class="sxs-lookup"><span data-stu-id="14972-144">If enabled during the backup operation or the recovery operation, you cannot restore individual databases.</span></span>
    
- <span data-ttu-id="14972-145">可能是仅时间点恢复操作。</span><span class="sxs-lookup"><span data-stu-id="14972-145">Only point-in-time recovery operations are possible.</span></span> <span data-ttu-id="14972-146">启用循环日志记录后，您可以删除位于同一目录中的事务日志恢复数据库后，尽管这些日志可能是不同的 Exchange 2013 数据库的一部分。</span><span class="sxs-lookup"><span data-stu-id="14972-146">When circular logging is enabled, you can delete transaction logs in the same directory when a database is restored, although those logs might be part of a different Exchange 2013 database.</span></span> 
    
- <span data-ttu-id="14972-147">不能执行增量备份或差异备份操作。</span><span class="sxs-lookup"><span data-stu-id="14972-147">You cannot perform incremental or differential backup operations.</span></span> <span data-ttu-id="14972-148">有关这些类型的备份的详细信息，请参阅[Exchange 2013 的备份操作的类型](types-of-backup-operations-for-exchange-2013.md)。</span><span class="sxs-lookup"><span data-stu-id="14972-148">For more information about these types of backups, see [Types of backup operations for Exchange 2013](types-of-backup-operations-for-exchange-2013.md).</span></span>
    
<span data-ttu-id="14972-149">如果启用循环日志记录，您的管理员应禁用尽快以确保 VSS 备份不会失败。</span><span class="sxs-lookup"><span data-stu-id="14972-149">If circular logging is enables, your administrator should disable it as soon as possible to ensure that your VSS backups don't fail.</span></span> <span data-ttu-id="14972-150">有关详细信息，查看[Exchange 循环日志记录和 VSS 备份](http://blogs.technet.com/b/exchange/archive/2010/08/18/3410672.aspx)的博客张贴内容。</span><span class="sxs-lookup"><span data-stu-id="14972-150">For more information, check out the blog post [Exchange Circular Logging and VSS Backups](http://blogs.technet.com/b/exchange/archive/2010/08/18/3410672.aspx).</span></span> 
  
## <a name="exchange-database-mobility"></a><span data-ttu-id="14972-151">Exchange 数据库移动</span><span class="sxs-lookup"><span data-stu-id="14972-151">Exchange database mobility</span></span>
<span data-ttu-id="14972-152"><a name="bk_exchangedatabasemobility"> </a></span><span class="sxs-lookup"><span data-stu-id="14972-152"></span></span>

<span data-ttu-id="14972-153">Exchange 2013 允许以提高邮箱可靠性和可用性的数据库移动。</span><span class="sxs-lookup"><span data-stu-id="14972-153">Exchange 2013 allows for database mobility to improve mailbox reliability and availability.</span></span> <span data-ttu-id="14972-154">数据库移动，可以创建 Exchange 存储数据库的副本，数据库断开服务器，并将其存储在另一台服务器上。</span><span class="sxs-lookup"><span data-stu-id="14972-154">Database mobility enables you to make copies of your Exchange store database, disconnect the database from the server, and store it on another server.</span></span> <span data-ttu-id="14972-155">在 Exchange 2013 数据库可用性组 (DAG)，不同的计算机上存储数据库的多个副本。</span><span class="sxs-lookup"><span data-stu-id="14972-155">In an Exchange 2013 Database Availability Group (DAG), multiple copies of the database are stored on different computers.</span></span> <span data-ttu-id="14972-156">当一个或多个副本的数据库的硬件或其他系统故障由于丢失，来自其他副本信息可以用于重新设定种子通过普通复制操作的数据库。</span><span class="sxs-lookup"><span data-stu-id="14972-156">When one or more copies of the database are lost due to hardware or other system failure, information from the other copies can be used to reseed the database via normal replication operations.</span></span>
  
<span data-ttu-id="14972-157">为备份操作，如果在 DAG 中配置 Exchange 2013 的数据库要备份的备份应用程序可以更好地阻止快照和活动服务器的性能之间的干扰处于非活动状态之一上按照快照数据库副本。</span><span class="sxs-lookup"><span data-stu-id="14972-157">For backup operations, if the Exchange 2013 databases that are to be backed up are configured in a DAG, the backup application can better prevent interference between the snapshot and the active server's performance by taking the snapshot on one of the inactive database copies.</span></span> <span data-ttu-id="14972-158">因为大多数情况下同步的数据库副本，备份应用程序可以执行从不同的数据库副本快照和更高版本重建它从片段。</span><span class="sxs-lookup"><span data-stu-id="14972-158">Because the database copies are for the most part synchronized, the backup application can take snapshots from different copies of the database, and later reconstruct it from the pieces.</span></span>
  
<span data-ttu-id="14972-159">DAG 数据库还原备份数据的唯一受支持的方法是数据库的使用相同的备份数据还原所有副本。</span><span class="sxs-lookup"><span data-stu-id="14972-159">The only supported method of restoring DAG databases from backup data is to restore all copies of the database by using the same backup data.</span></span> <span data-ttu-id="14972-160">由于数据库日志文件可能会稍有不同的副本副本之间，还原单独的数据库副本使用不同的数据可能会变得不可安装的数据库。</span><span class="sxs-lookup"><span data-stu-id="14972-160">Because the database log files might be slightly different between the copies, restoring individual database copies using different data can cause the database to become unmountable.</span></span>
  
## <a name="in-this-section"></a><span data-ttu-id="14972-161">本节内容</span><span class="sxs-lookup"><span data-stu-id="14972-161">In this section</span></span>
<span data-ttu-id="14972-162"><a name="bk_inthissection"> </a></span><span class="sxs-lookup"><span data-stu-id="14972-162"></span></span>

- [<span data-ttu-id="14972-163">事务日志和备份和还原 Exchange 2013 中的检查点文件</span><span class="sxs-lookup"><span data-stu-id="14972-163">Transaction logs and checkpoint files for backup and restore in Exchange 2013</span></span>](transaction-logs-and-checkpoint-files-for-backup-and-restore-in-exchange.md)
    
- [<span data-ttu-id="14972-164">Exchange 2013 中的 Exchange 编写器</span><span class="sxs-lookup"><span data-stu-id="14972-164">Exchange writer in Exchange 2013</span></span>](exchange-writer-in-exchange-2013.md)
    
## <a name="see-also"></a><span data-ttu-id="14972-165">另请参阅</span><span class="sxs-lookup"><span data-stu-id="14972-165">See also</span></span>

- [<span data-ttu-id="14972-166">Exchange Online 和 Exchange 开发</span><span class="sxs-lookup"><span data-stu-id="14972-166">Exchange Online and Exchange development</span></span>](../exchange-server-development.md) 
- [<span data-ttu-id="14972-167">Exchange 2013 的备份操作的类型</span><span class="sxs-lookup"><span data-stu-id="14972-167">Types of backup operations for Exchange 2013</span></span>](types-of-backup-operations-for-exchange-2013.md)
- [<span data-ttu-id="14972-168">还原 Exchange 2013 数据库</span><span class="sxs-lookup"><span data-stu-id="14972-168">Restoring Exchange 2013 databases</span></span>](restoring-exchange-2013-databases.md)
    

